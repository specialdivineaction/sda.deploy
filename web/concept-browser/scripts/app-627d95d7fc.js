!function(){"use strict";angular.module("trcGraph",["ngResource"])}(),function(){"use strict";function e(){function e(e){function n(e){return r.get({type:e})}var r=e(t.url+"/:type"),o={};return o.get=n,o}e.$inject=["$resource"];var t={};return t.url="/api/graph",t.$get=e,t}angular.module("trcGraph").provider("graphRepo",e)}(),function(){"use strict";angular.module("sdaConceptBrowser",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ngMaterial","trcBiblio","trcBio","trcGraph"])}(),function(){"use strict";function e(e,n,r,o,i,a,c,d,l,u,s,f,m,g){function h(){b(),v();var e="people",t=d.type||e;$.graphLoading=!0,E(t).catch(function(){return o.showSimple('Unable to load the "'+t+'"graph type. Falling back to "'+e+'".'),E(e)}).then(function(e){$.graphLoading=!1,$.graph=e.graph},function(){$.graphLoading=!1,o.showSimple("Unable to load graph data.")}),n.$watch("main.activeNode",function(e){e?($.sidebarLoading=!0,M(e).then(function(){$.sidebarLoading=!1},function(){$.sidebarLoading=!1,o.showSimple("Unable to load node data")})):$.person=null}),n.$watch("searchQuery",function(e){$.highlightedNodes=e?l("filter")($.graph.nodes,{label:e}):[]})}function p(e){var t=$.relnTypeFilter.indexOf(e);t<0?$.relnTypeFilter.push(e):$.relnTypeFilter.splice(t,1)}function b(){$.selectModes.push({label:"Neighbors",strategy:function(e){if(!e)return[];var t=e.outEdges.filter(k).map(function(e){return e.target}),n=e.inEdges.filter(k).map(function(e){return e.source});return[e].concat(t,n)}}),$.selectModes.push({label:"Trace",strategy:function(e){if(!e)return[];for(var t=[e],n=[];t.length>0;){var r=t.pop();n.push(r),r.outEdges.forEach(function(e){n.indexOf(e.target)<0&&t.push(e.target)})}return n}}),$.selectModes.push({label:"Inbound",strategy:function(e){return e?[e].concat(e.inEdges.filter(k).map(function(e){return e.source})):[]}}),$.selectModes.push({label:"Outbound",strategy:function(e){return e?[e].concat(e.outEdges.filter(k).map(function(e){return e.target})):[]}}),$.selectMode=$.selectModes[0]}function v(){$.sizeMetrics.push({label:"PageRank",strategy:function(e){return e.metadata.pagerank}}),$.sizeMetrics.push({label:"Uniform",strategy:function(){return 1}}),$.sizeMetrics.push({label:"HITS",disabled:!0,strategy:function(){return 1}}),$.sizeMetric=$.sizeMetrics[0]}function y(){$.showSearchForm=!$.showSearchForm,$.showSearchForm?u(function(){angular.element('.search-form > input[type="search"]').focus()}):n.searchQuery=""}function x(){n.searchQuery="",u(function(){$.showSearchForm=!1})}function w(e){var t={targetEvent:e,fullscreen:a("sm")||a("xs"),templateUrl:"app/main/help.html",controller:"HelpDialogController",clickOutsideToClose:!0};i.show(t)}function k(e){return 0===$.relnTypeFilter.length||$.relnTypeFilter.indexOf(e.relation)>=0}function M(e){function n(e){var t={id:e.id,directed:e.directed};return e.directed?(t.out={label:e.title,nodes:[]},t.in={label:e.reverseTitle,nodes:[]}):t.none={label:e.title,nodes:[]},t}function o(e){return c.hasOwnProperty(e.id)||(c[e.id]=n(e)),c[e.id]}$.person=f.get(e.id);var i=m.searchByAuthor(e.id),a=i.$promise.then(function(){if(!i.items)throw new Error("unable to load items");return $.works=i.items,$.works}),c={};e.outEdges.map(function(e){var n=t[e.relation];if(n){var r=o(n);r[n.directed?"out":"none"].nodes.push(e.target)}}),e.inEdges.map(function(e){var n=t[e.relation];if(n){var r=o(n);r[n.directed?"in":"none"].nodes.push(e.source)}}),$.related=[];for(var d in c)c.hasOwnProperty(d)&&$.related.push(c[d]);return r.all([$.person.$promise,a])}function E(e){var t=g.get(e);return t.$promise.then(function(){var e={};return t.graph.nodes.forEach(function(t){t.inEdges=[],t.outEdges=[],e[t.id]=t}),t.graph.edges.forEach(function(t){var n=e[t.source],r=e[t.target];t.source=r,r.outEdges.push(t),t.target=n,n.inEdges.push(t)}),t})}var $=this;$.toggleSearchForm=y,$.clearSearchForm=x,$.showSearchForm=!1,$.searchQuery="",$.showHelp=w,$.graph=null,$.activeNode=null,$.person=null,$.works=null,$.related=null,$.sidebarLoading=!1,$.graphLoading=!1,$.relnTypes=t,$.relnTypeFilter=[],$.toggleRelnTypeFilter=p,$.selectMode=null,$.selectModes=[],$.sizeMetric=null,$.sizeMetrics=[],$.highlightedNodes=[],h()}e.$inject=["$http","$scope","$q","$mdToast","$mdDialog","$mdMedia","$location","$stateParams","$filter","$timeout","$document","peopleRepo","worksRepo","graphRepo"];var t={"uk.ac.ox.bodleian.sda.relationships.influence":{id:"uk.ac.ox.bodleian.sda.relationships.influence",title:"Influenced",reverseTitle:"Influenced By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.provoked":{id:"uk.ac.ox.bodleian.sda.relationships.provoked",title:"Provoked",reverseTitle:"Provoked By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.patternmatch":{id:"uk.ac.ox.bodleian.sda.relationships.patternmatch",title:"Possible Pattern Match",directed:!1}};angular.module("sdaConceptBrowser").controller("MainController",e)}(),function(){"use strict";function e(e,t){function n(){t.hide()}e.close=n}e.$inject=["$scope","$mdDialog"],angular.module("sdaConceptBrowser").controller("HelpDialogController",e)}(),function(){"use strict";function e(e,t){function n(n,r){var o=n.width,i=!1,a=n.height,c=!1,d=n.layout,l=r.get(0);t(function(){o||(o=r.width(),i=!0),a||(a=r.height(),c=!0);var t=ConceptBrowser(l,d).size([o,a]).edgeFilter(function(e){return 0===n.relnTypes.length||n.relnTypes.indexOf(e.relation)>=0});n.sizeMetric&&t.nodeCentralityMetric(n.sizeMetric),n.selectMode&&t.selectMode(n.selectMode),n.graph&&(t.data(n.graph.nodes,n.graph.edges),t.refresh()),angular.element(e).on("resize",function(){if(i||c){var e=o,n=a;i&&(o=r.width()),c&&(a=r.height()),e===o&&n===a||(t.size([o,a]),t.refresh())}});var u=!1;t.on("activate",function(e){u||n.$apply(function(){n.activeNode=e.node})}),n.$watchGroup(["width","height","graph","activeNode","sizeMetric","selectMode"],function(e,n){var r=!1;if(e[0]&&e[0]!==n[0]&&(o=e[0],t.size([o,a]),e[2]&&(r=!0)),e[1]&&e[1]!==n[1]&&(a=e[1],t.size([o,a]),e[2]&&(r=!0)),e[2]&&e[2]!==n[2]){var i=angular.copy(e[2]);t.data(i.nodes,i.edges),r=!0}e[3]!==n[3]&&(u=!0,t.activate(e[3]),u=!1),e[4]&&e[4]!==n[4]&&(t.nodeCentralityMetric(e[4]),r=!0),e[5]&&e[5]!==n[5]&&t.selectMode(e[5]),r&&t.refresh()}),n.$watchCollection("highlightedNodes",function(e){e&&t.highlight(e)}),n.$watchCollection("relnTypes",function(e){e&&t.updateGraphSelections()})})}var r={restrict:"E",scope:{graph:"=ngModel",width:"=",height:"=",padding:"=",layout:"@",activeNode:"=",sizeMetric:"=",selectMode:"=",highlightedNodes:"=",relnTypes:"="},link:n};return r}e.$inject=["$window","$timeout"],angular.module("sdaConceptBrowser").directive("conceptBrowser",e)}(),function(){"use strict";function e(e){e.debug("runBlock end")}e.$inject=["$log"],angular.module("sdaConceptBrowser").run(e)}(),function(){"use strict";function e(e,t){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("sdaConceptBrowser").config(e)}(),function(){"use strict";angular.module("sdaConceptBrowser").constant("d3",d3)}(),function(){"use strict";function e(e,t,n,r,o){e.debugEnabled(!0),n.url="/api/catalog/people",r.url="/api/catalog/works",o.url="/api/catalog/graph",t.definePalette("darkBrown",{50:"#595c59",100:"#4c4f4c",200:"#404240",300:"#333533",400:"#272827",500:"#1a1b1a",600:"#0d0e0d",700:"#010101",800:"#000000",900:"#000000",A100:"#e0f0e0",A200:"#565956",A400:"#7e837e",A700:"#000000",contrastDefaultColor:"light",contrastDarkColors:["A100"]}),t.definePalette("copper",{50:"#d4b190",100:"#cca47e",200:"#c5976b",300:"#be8a59",400:"#b67e47",500:"#a47140",600:"#926439",700:"#7f5832",800:"#6d4b2b",900:"#5b3e23",A100:"#dcc3ab",A200:"#a47140",A400:"#48321c",A700:"#272927",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"]}),t.theme("default").primaryPalette("darkBrown").accentPalette("copper")}e.$inject=["$logProvider","$mdThemingProvider","peopleRepoProvider","worksRepoProvider","graphRepoProvider"],angular.module("sdaConceptBrowser").config(e)}(),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.EventDispatcher=t()}(this,function(){"use strict";function e(){function e(e,t){o[e]&&o[e].forEach(function(e){try{e(t)}catch(e){console.error(e)}}),i.forEach(function(n){try{n(e,t)}catch(e){console.error(e)}})}function t(e){return i.push(e),function(){var t=i.indexOf(e);t>=0&&i.splice(t,1)}}function n(e,t){return o[e]||(o[e]=[]),o[e].push(t),function(){var n=o[e].indexOf(t);n>=0&&o[e].splice(n,1)}}function r(e,t){var r=n(e,function(e){try{t(e)}catch(e){console.error(e)}finally{r()}});return r}var o={},i=[],a={};return a.all=t,a.on=n,a.once=r,a.trigger=e,a}return e}),function(e,t){"function"==typeof define&&define.amd?define(["d3"],t):"object"==typeof module&&module.exports?module.exports=t(require("d3")):t(d3)}(this,function(e){"use strict";function t(e){e.fixed|=2}function n(e){e.fixed&=-7}function r(e){e.fixed|=4,e.px=e.x,e.py=e.y}function o(e){e.fixed&=-5}function i(e,t,n){var r=0,o=0;if(e.charge=0,!e.leaf)for(var a,c=e.nodes,d=c.length,l=-1;++l<d;)a=c[l],a&&(i(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,o+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var u=t*n[e.point.index];e.charge+=e.pointCharge=u,r+=u*e.point.x,o+=u*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}function a(e){return"function"==typeof e}function c(e){return"number"==typeof e}var d=20,l=1,u=1/0;e.layout.force.cylindrical=function(){function s(e,t){return 2*Math.abs(e)>t&&(e<0?e+=t:e-=t),e}function f(e){return function(t,n,r,o){if(t.point!==e){var i=w[0],a=s(t.cx-e.x,i),c=t.cy-e.y,d=o-n,l=a*a+c*c,u=0;if(d*d/C<l)return l<O&&(u=t.charge/l,e.px-=a*u,e.py-=c*u),!0;t.point&&l&&l<O&&(u=t.pointCharge/l,e.px-=a*u,e.py-=c*u)}return!t.charge}}function m(t){t.px=e.event.x,t.py=e.event.y,y.resume()}var g,h,p,b,v,y={},x=e.dispatch("start","tick","end"),w=[1,1],k=.9,M=d,E=l,$=-30,O=u,N=.1,C=.64,z=[],T=[];return y.tick=function(){if((h*=.99)<.005)return x.end({type:"end",alpha:h=0}),!0;var t,n,r,o,a,c,d,l,u,m=z.length,g=T.length;for(n=0;n<g;++n)r=T[n],o=r.source,a=r.target,l=s(a.x-o.x,w[0]),u=a.y-o.y,c=l*l+u*u,0!==c&&(c=h*b[n]*((c=Math.sqrt(c))-p[n])/c,l*=c,u*=c,a.x-=l*(d=o.weight/(a.weight+o.weight)),a.y-=u*d,o.x+=l*(d=1-d),o.y+=u*d);if(d=h*N,0!==d&&(l=w[0]/2,u=w[1]/2,n=-1,d))for(;++n<m;)r=z[n],r.y+=(u-r.y)*d;if($)for(i(t=e.geom.quadtree(z),h,v),n=-1;++n<m;)(r=z[n]).fixed||t.visit(f(r));for(n=-1;++n<m;)r=z[n],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*k,r.y-=(r.py-(r.py=r.y))*k);n=-1;for(var y=w[0];++n<m;){r=z[n];var M=r.px-r.x;r.x%=y,r.x<0&&(r.x+=y),r.px=r.x+M}x.tick({type:"tick",alpha:h})},y.nodes=function(e){return arguments.length?(z=e,y):z},y.links=function(e){return arguments.length?(T=e,y):T},y.size=function(e){return arguments.length?(w=e,y):w},y.linkDistance=function(e){return arguments.length?(M=a(e)?e:+e,y):M},y.linkStrength=function(e){return arguments.length?(E=a(e)?e:+e,y):E},y.friction=function(e){return arguments.length?(k=+e,y):k},y.charge=function(e){return arguments.length?($=a(e)?e:+e,y):$},y.chargeDistance=function(e){return arguments.length?(O=e*e,y):Math.sqrt(O)},y.gravity=function(e){return arguments.length?(N=+e,y):N},y.theta=function(e){return arguments.length?(C=e*e,y):Math.sqrt(C)},y.alpha=function(t){return arguments.length?(t=+t,h?h=t>0?t:0:t>0&&(x.start({type:"start",alpha:h=t}),e.timer(y.tick)),y):h},y.start=function(){function e(e,r){if(!n){for(n=new Array(o),l=0;l<o;++l)n[l]=[];for(l=0;l<i;++l){var a=T[l];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var c,d=n[t],l=-1,u=d.length;++l<u;)if(!isNaN(c=d[l][e]))return c;return Math.random()*r}var t,n,r,o=z.length,i=T.length,d=w[0],l=w[1];for(t=0;t<o;++t)(r=z[t]).index=t,r.weight=0;for(t=0;t<i;++t)r=T[t],c(r.source)&&(r.source=z[r.source]),c(r.target)&&(r.target=z[r.target]),++r.source.weight,++r.target.weight;for(t=0;t<o;++t)r=z[t],isNaN(r.x)&&(r.x=e("x",d)),isNaN(r.y)&&(r.y=e("y",l)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(p=[],a(M))for(t=0;t<i;++t)p[t]=+M.call(this,T[t],t);else for(t=0;t<i;++t)p[t]=M;if(b=[],a(E))for(t=0;t<i;++t)b[t]=+E.call(this,T[t],t);else for(t=0;t<i;++t)b[t]=E;if(v=[],a($))for(t=0;t<o;++t)v[t]=+$.call(this,z[t],t);else for(t=0;t<o;++t)v[t]=$;return y.resume()},y.resume=function(){return y.alpha(.1)},y.stop=function(){return y.alpha(0)},y.drag=function(){return g||(g=e.behavior.drag().origin(function(e){return e}).on("dragstart.force",t).on("drag.force",m).on("dragend.force",n)),arguments.length?void this.on("mouseover.force",r).on("mouseout.force",o).call(g):g},y.edgePath=function(){var e=w[0],t=function(e){return e[0][0]},n=function(e){return e[0][1]},r=function(e){return e[1][0]},o=function(e){return e[1][1]},i=function(i){i.attr("d",function(i){var a=t(i),c=n(i),d=r(i),l=o(i);return 2*Math.abs(a-d)<e?"M "+a+" "+c+" L "+d+" "+l:a<d?"M "+a+" "+c+" L "+(d-e)+" "+l+" M "+d+" "+l+" L "+(a+e)+" "+c:"M "+a+" "+c+" L "+(d+e)+" "+l+" M "+d+" "+l+" L "+(a-e)+" "+c})};return i.x1=function(e){return t=e,i},i.y1=function(e){return n=e,i},i.x2=function(e){return r=e,i},i.y2=function(e){return o=e,i},i},e.rebind(y,x,"on")}}),function(e,t){"function"==typeof define&&define.amd?define(["d3","event-dispatcher","d3-force-cylindrical"],t):"object"==typeof module&&module.exports?(require("d3-force-cylindrical"),module.exports=t(require("d3"),require("event-dispatcher"))):e.ConceptBrowser=t(e.d3,e.EventDispatcher)}(this,function(e,t){"use strict";function n(n,l,u){function s(e){return q=e[0],U=e[1],ie&&(H.attr("width",q).attr("height",U),K.range([0,q]),Y.size([q,U])),le}function f(t){if(ce=t,ie){var n=e.extent(J,ce);X.domain(n[0]===n[1]?[n[0]-1,n[1]+1]:n)}return le}function m(e){return ae=e,le}function g(e,t){return J=e,V=t,J.forEach(function(e){e.x=(e.x||Math.random())*q,e.y=(e.y||Math.random())*U}),le}function h(e){e instanceof Array||(e=[e]);var t=e.every(function(e){return J.indexOf(e)>=0});if(!t)throw new Error("some node(s) to be highlighted are not members of the graph");return $(),E(e),le}function p(e){if(e&&J.indexOf(e)<0)throw new Error("node to be activated is not a member of the graph");return z(),e&&(C(e),F(),T(e)),le}function b(e){return de=e,le}function v(){return y(),Y.nodes(J).links(V).start(),k(),M(),le}function y(){if(!q||!U)throw new Error("No width/height set. Use size([width, height]) to set size before initializing");if(!J||!V)throw new Error("No nodes/edges set. Use data(nodes, edges) to set them before initializing");if(!ie){ie=!0,H=e.select(n).append("svg").attr("width",q).attr("height",U);var t=V.reduce(function(e,t){return e.indexOf(t.relation)<0&&e.push(t.relation),e},[]);D(H,t,["","activated","selected","focused"]);var d=H.append("g").attr("class","concept-browser");I=d.append("g").attr("class","edges"),G=d.append("g").attr("class","nodes"),Q=d.append("rect").attr("class","progress").attr("x",0).attr("y",0).attr("height",2),K=e.scale.linear().domain([Math.log(.1),Math.log(.005)]).range([0,q]);var u=e.extent(J,ce);X=e.scale.linear().domain(u[0]===u[1]?[u[0]-1,u[1]+1]:u).range([0,1]),W=function(e){return o+(i-o)*X(e)},Y=a[l||"planar"]().size([q,U]).on("tick",w),x(Y),Y.edgePath&&(re=Y.edgePath().x1(function(e){return e.source.x}).y1(function(e){return e.source.y}).x2(function(e){return e.target.x}).y2(function(e){return e.target.y})),e.tip&&(oe=e.tip().attr("class",c).direction(R).offset(_).html(function(e){return e.label}),j.on("focus",function(e){B(e.node)}),j.on("blur",function(e){P(e.node)}));var s=r(S,100,!0,!0);j.on("highlight",s),j.on("unhighlight",s),j.on("focus",s),j.on("blur",s),j.on("select",s),j.on("deselect",s),j.on("activate",s),j.on("deactivate",s)}}function x(e){e.gravity(.1).linkDistance(50).linkStrength(function(e){var t=ce(e.source);return X(t)}).charge(function(e){var t=[-50,-300],n=[0,1],r=ce(e);return t[0]+(t[1]-t[0])/(n[1]-n[0])*(X(r)-n[0])}).friction(.9)}function w(e){if(L(),e.alpha>.0051){if(Q.attr("width",K(Math.log(e.alpha))),Math.random()<.9)return}else Q.attr("width",0);G.selectAll(".node").transition().duration(500).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),I.selectAll(".edge").transition().duration(500).call(re)}function k(){if(!J||0===J.length)throw new Error("no nodes provided");var t=G.selectAll(".node").data(J,function(e){return e.id}),n=t.enter().append("g").attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).on("mouseover",O).on("mouseout",N).on("dblclick",C).on("click",function(t){e.event.ctrlKey?te.indexOf(t)<0?T(t):A(t):(F(),T(t))});n.append("circle"),t.select("circle").attr("r",function(e){var t=ce(e);return W(t)}),t.exit().remove(),oe&&G.call(oe)}function M(){if(!V||0===V.length)throw new Error("no edges provided");var e=I.selectAll(".edge").data(V,function(e){return e.source.id+","+e.target.id});e.enter().append("path").attr("class",function(e){return"edge "+e.relation}).attr("marker-end",function(e){return"url(#arrowhead-"+e.relation+")"}).call(re),e.exit().remove()}function E(e){e instanceof Array||(e=[e]),e.forEach(function(e){Z.indexOf(e)<0&&Z.push(e),j.trigger("highlight",{node:e,selection:te})})}function $(){Z.forEach(function(e){j.trigger("unhighlight",{node:e,selection:te})}),Z=[]}function O(e){N(),ee=e,j.trigger("focus",{node:ee,selection:te})}function N(e){if(e=e||ee){if(ee!==e)throw new Error("tried to blur a node that was not focused");ee=null,j.trigger("blur",{node:e,selection:te})}}function C(e){ne!==e&&(z(),ne=e,j.trigger("activate",{node:ne,selection:te}))}function z(e){if(e=e||ne){if(ne!==e)throw new Error("tried to deactivate a node that was not activated");ne=null,j.trigger("deactivate",{node:e,selection:te})}}function T(e){if(!e)throw new Error("no node provided");if(!(te.indexOf(e)<0))throw new Error("tried to select a node that is already selected");te.push(e),j.trigger("select",{node:e,selection:te})}function A(e){if(!e)throw new Error("no node provided to deselect");var t=te.indexOf(e);if(t<0)throw new Error("tried to deselect a node that was not selected");te.splice(t,1),j.trigger("deselect",{node:e,selection:te})}function F(){te.forEach(function(e){j.trigger("deselect",{node:e,selection:[]})}),te=[]}function B(e){oe&&oe.attr("class",c).show(e)}function P(e){oe&&oe.attr("class",c).hide(e)}function S(){var e=[ne],t=te.slice(),n=ae(ee);te.forEach(function(e){ae(e).forEach(function(e){n.indexOf(e)<0&&n.push(e)})}),ae(ne).forEach(function(e){n.indexOf(e)<0&&n.push(e)});var r=Z.slice();G.selectAll(".node").classed("activated",function(t){return e.indexOf(t)>=0}).classed("selected",function(e){return t.indexOf(e)>=0}).classed("focused",function(e){return n.indexOf(e)>=0}).classed("highlighted",function(e){return r.indexOf(e)>=0}),I.selectAll(".edge").classed("activated",function(t){return e.indexOf(t.source)>=0&&e.indexOf(t.target)>=0}).classed("selected",function(e){return t.indexOf(e.source)>=0&&t.indexOf(e.target)>=0}).classed("focused",function(e){return n.indexOf(e.source)>=0&&n.indexOf(e.target)>=0}).classed("hidden",function(e){return!de(e)}).attr("marker-end",function(r){var o="";return e.indexOf(r.source)>=0&&e.indexOf(r.target)>=0?o="-activated":t.indexOf(r.source)>=0&&t.indexOf(r.target)>=0?o="-selected":n.indexOf(r.source)>=0&&n.indexOf(r.target)>=0&&(o="-focused"),"url(#arrowhead-"+r.relation+o+")"})}function L(){J.forEach(function(e){e.x=Math.max(Math.min(e.x,q),0),e.y=Math.max(Math.min(e.y,U),0)})}function R(e){var t="";return e.y>U-d.bottom?t+="n":e.y<d.top&&(t+="s"),e.x>q-d.right?t+="w":e.x<d.left&&(t+="e"),""===t&&(t="n"),t}function _(e){var t=ce(e),n=W(t),r=[0,0];return e.y>U-d.bottom?r[0]-=n:e.y<d.top&&(r[0]+=n),e.x>q-d.left_right?r[1]-=n:e.x<d.left_right&&(r[1]+=n),0===r[1]&&0===r[0]&&(r[0]-=n),r}function D(e,t,n){var r=[];t.forEach(function(e){n.forEach(function(t){r.push("arrowhead-"+e+(t?"-"+t:""))})}),e.append("defs").selectAll("marker").data(r).enter().append("marker").attr("id",function(e){return e}).attr("viewBox","0 -4 10 8").attr("refX",25).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0,-4 L 10,0 L 0,4")}l=l||"planar",u=u||{};var j=t();u.debug&&j.all(function(e,t){console.log(e,t.node?t.node.id:t)});var q,U,H,G,I,Q,K,W,X,Y,J=[],V=[],Z=[],ee=null,te=[],ne=null,re=function(e){e.attr("d",function(e){var t=e.source.x,n=e.source.y,r=e.target.x,o=e.target.y;return"M "+t+" "+n+" L "+r+" "+o})},oe=null,ie=!1,ae=function(e){if(!e)return[];var t=e.outEdges.forEach(function(e){return e.target}),n=e.inEdges.forEach(function(e){return e.source});return[e].concat(t,n)},ce=function(){return 1},de=function(){return!0},le={};return le.size=s,le.nodeCentralityMetric=f,le.selectMode=m,le.data=g,le.highlight=h,le.activate=p,le.edgeFilter=b,le.updateGraphSelections=S,le.refresh=v,le.on=j.on,le}function r(e,t,n,r){var o;return"undefined"==typeof n&&(n=!0),"undefined"==typeof r&&(r=!1),function(){function i(){o=null,r&&e.apply(a,c)}var a=this,c=arguments,d=n&&!o;clearTimeout(o),o=setTimeout(i,t),d&&e.apply(a,c)}}var o=5,i=13,a={planar:e.layout.force,cylindrical:e.layout.force.cylindrical},c="d3-tip",d={left:200,right:200,top:100,bottom:100};return e.tip||console.warn("d3.tip is not available; tooltips will not display properly."),n}),angular.module("sdaConceptBrowser").run(["$templateCache",function(e){e.put("app/main/help.html",'<md-dialog><md-toolbar><div class=md-toolbar-tools><h2>Help</h2><span flex></span><md-button class=md-icon-button ng-click=close()><md-icon>close</md-icon></md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content layout=column layout-align="center center"><iframe width=1280 height=720 src=https://www.youtube.com/embed/0PzUCCnlN18 frameborder=0 allowfullscreen></iframe></div></md-dialog-content></md-dialog>'),e.put("app/main/main.html",'<md-toolbar class=layout-navbar><div class=md-toolbar-tools><a class=logo href=/ layout=column layout-align="center center"><img src=/assets/images/sda-logo-light.png alt=SDA flex=nogrow></a><h1>Concept Browser</h1><span flex></span><md-menu><md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) title="Ranking Model"><md-icon>adjust</md-icon></md-button><md-menu-content><md-menu-item ng-repeat="metric in main.sizeMetrics"><md-button ng-click="main.sizeMetric = metric" ng-disabled=metric.disabled><md-icon md-menu-align-target>radio_button_{{main.sizeMetric === metric ? \'\' : \'un\'}}checked</md-icon>{{metric.label}}</md-button></md-menu-item></md-menu-content></md-menu><md-menu><md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) title="Selection Mode"><md-icon>device_hub</md-icon></md-button><md-menu-content><md-menu-item ng-repeat="mode in main.selectModes"><md-button ng-click="main.selectMode = mode" ng-disabled=metric.disabled><md-icon md-menu-align-target>radio_button_{{main.selectMode === mode ? \'\' : \'un\'}}checked</md-icon>{{mode.label}}</md-button></md-menu-item></md-menu-content></md-menu><md-menu><md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) title="Relationship Types"><md-icon>filter_list</md-icon></md-button><md-menu-content><md-menu-item><md-button ng-click="main.relnTypeFilter = []"><md-icon md-menu-align-target>check_box{{main.relnTypeFilter.length &gt; 0 ? \'_outline_blank\' : \'\'}}</md-icon>All Relationships</md-button></md-menu-item><md-divider></md-divider><md-menu-item ng-repeat="type in main.relnTypes"><md-button ng-click=main.toggleRelnTypeFilter(type.id) md-prevent-menu-close><md-icon md-menu-align-target>check_box{{main.relnTypeFilter.indexOf(type.id) &lt; 0 ? \'_outline_blank\' : \'\'}}</md-icon>{{type.title}}</md-button></md-menu-item></md-menu-content></md-menu><span flex></span><md-button class=md-icon-button ng-click=main.toggleSearchForm($event)><md-icon>search</md-icon></md-button><form name=search class=search-form layout=row ng-style="{ width: main.showSearchForm ? \'20rem\' : \'0\' }"><input type=search name=query ng-model=searchQuery ng-change=main.highlightNodes() flex> <button class=clear ng-click=main.clearSearchForm()><md-icon>clear</md-icon></button></form><md-button class=md-icon-button ng-click=main.showHelp($event)><md-icon>help_outline</md-icon></md-button></div></md-toolbar><main layout=row layout-align=center flex><div layout=column flex><concept-browser flex ng-if=main.graph ng-model=main.graph active-node=main.activeNode size-metric=main.sizeMetric.strategy select-mode=main.selectMode.strategy highlighted-nodes=main.highlightedNodes reln-types=main.relnTypeFilter></concept-browser><div ng-if="!main.graph && main.graphLoading" flex layout=column layout-align="center center" layout-padding><md-progress-circular md-mode=indeterminate></md-progress-circular><div class="text-center md-headline md-secondary">Loading graph data&hellip;<br>This may take a while.</div></div></div><md-sidenav md-component-id=right class=md-sidenav-right md-is-open=main.activeNode md-disable-backdrop md-whiteframe=4 layout=column><md-toolbar><div class=md-toolbar-tools><h2>Node Information</h2><span flex></span><md-button class=md-icon-button ng-click="main.activeNode = null"><md-icon>close</md-icon></md-button></div></md-toolbar><div flex layout=column layout-align="center center" ng-if=main.sidebarLoading><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class=node-info flex layout=column ng-if=!main.sidebarLoading><h3 class=name><span class=given>{{main.person.name.givenName}}</span> <span class=family>{{main.person.name.familyName}}</span></h3><md-tabs flex><md-tab ng-if=main.person.summary><md-tab-label><md-icon>person</md-icon></md-tab-label><md-tab-body><div class=summary ng-if=main.person.summary ng-bind-html=main.person.summary></div></md-tab-body></md-tab><md-tab ng-if="main.works &amp;&amp; main.works.length &gt; 0"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><div class=books><h4>Books ({{main.works.length}})</h4><md-list><md-list-item ng-repeat="work in main.works" ng-href=../#/library/books/{{work.id}}>{{work.label}}</md-list-item></md-list></div></md-tab-body></md-tab><md-tab ng-if="main.related &amp;&amp; main.related.length &gt; 0"><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body><md-list class=relationships><div ng-repeat="group in main.related"><div ng-if=group.directed><div ng-if="group.out.nodes.length &gt; 0"><md-subheader class=md-no-sticky>{{group.out.label}}</md-subheader><md-list-item ng-repeat="node in group.out.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div><div ng-if="group.in.nodes.length &gt; 0"><md-subheader class=md-no-sticky>{{group.in.label}}</md-subheader><md-list-item ng-repeat="node in group.in.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div></div><div ng-if=!group.directed><div ng-if="group.none.nodes.length &gt; 0"><md-subheader class=md-no-sticky>{{group.none.label}}</md-subheader><md-list-item ng-repeat="node in group.none.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div></div></div></md-list></md-tab-body></md-tab></md-tabs></div></md-sidenav></main>')}]);
//# sourceMappingURL=../maps/scripts/app-627d95d7fc.js.map
