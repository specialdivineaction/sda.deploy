!function(){"use strict";angular.module("sdaReader",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ngMaterial","trcArticles","trcRefs"])}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/tree-categorization/tree-categorization.html",scope:{scopeId:"@",scheme:"@"},controller:t,controllerAs:"vm"};return e}function t(e,t){var a=this;a.categories=t.get(e.scopeId,e.scheme)}t.$inject=["$scope","categorizationRepo"],angular.module("sdaReader").directive("treeCategorization",e)}(),function(){"use strict";function e(){function e(e,a,n){function r(e){return new i(e)}function i(e){function t(t){return l.get({scopeId:e,key:t})}function a(e,t,a,n){}function n(e){}function r(e,t){}function i(e){}function o(t,a,n){var r={scopeId:e,schemeId:t.schemeId,nodeId:t.id},i={label:a,description:n},o=c.save(r,i);return o.$promise.then(function(e){t.childIds.push(e.id),t.children.push(e)}),o}function u(t,a,n){var r=s.delete({scopeId:e,schemeId:t.schemeId,nodeId:t.id,remove_refs:!!a});return n&&r.$promise.then(function(){var e=n.children.indexOf(t);e>=0&&n.children.splice(e,1)}),r.$promise}function m(){}function p(){}function f(t,a){var n={scopeId:e,schemeId:t.schemeId,nodeId:t.id},r=d.update(n,a);return r.$promise.then(function(e){t.entryRef=e}),r}function h(){var t={scopeId:e,schemeId:node.schemeId,nodeId:node.id},a=d.delete(t);return a.$promise.then(function(){node.entryRef=null}),a}this.get=t,this.create=a,this.remove=n,this.nodes={get:r,getChildren:i,create:o,move:m,remove:u,update:p,link:f,unlink:h}}var o={getScopedRepo:r},l=a(t.url+"/:scopeId/:key",{key:"@key"}),s=a(t.url+"/:scopeId/:schemeId/nodes/:nodeId",{schemeId:"@schemeId",nodeId:"@nodeId"}),c=a(t.url+"/:scopeId/:schemeId/nodes/:nodeId/children",{schemeId:"@schemeId",nodeId:"@nodeId"}),d=a(t.url+"/:scopeId/:schemeId/nodes/:nodeId/entryRef",{schemeId:"@schemeId",nodeId:"@nodeId"},{update:{method:"PUT"}});return o}e.$inject=["$q","$resource","$http"];var t={};return t.url="/api/categorizations",t.$get=e,t}angular.module("sdaReader").provider("categorizationService",e)}(),function(){"use strict";function e(){function e(e){function a(e,t){return n.get({scopeId:e,key:t})}var n=e(t.url+"/:scopeId/:key",{key:"@key"}),r={};return r.get=a,r}e.$inject=["$resource"];var t={};return t.url="/api/categorizations",t.$get=e,t}angular.module("sdaReader").provider("categorizationRepo",e)}(),function(){"use strict";function e(e){function t(t,a,n){t.$watch(n.ngModel,function(t){a.html(t||""),e.Hub.Queue(["Typeset",e.Hub,a.get(0)])})}var a={restrict:"EA",link:t};return a}e.$inject=["MathJax"],angular.module("sdaReader").directive("mathjax",e)}(),function(){"use strict";function e(){function e(e){for(var t={parent:null,children:[],level:0},a=angular.element(e).find("h1,h2,h3,h4,h5,h6"),n=t,r=0;r<a.length;r++){for(var i=a[r],o=parseInt(i.tagName.substr(1));o<=n.level&&n.parent;)n=n.parent;var l=i.innerHTML.trim().replace(/<[^>]+>/g,""),s="x"+r+"-"+l.toLowerCase().replace(/[^\w]+/g,"-"),c={parent:n,level:o,el:i,text:l,id:s,children:[]};n.children.push(c),n=c}return t}var t={};return t.parse=e,t}angular.module("sdaReader").factory("tocGenerator",e)}(),function(){"use strict";function e(e,t,a){function n(t,a){function n(e,a){t.$emit("click:footnote",{id:e.id,note:e,$event:a})}function l(e,a){t.$emit("click:citation",{id:e.id,citation:e,$event:a})}t.$watchGroup(["body","footnotes","citations"],function(s,c){var d=s[0],u=c[0],m=s[1],p=s[2];if(d&&(d!==u||!u)){a.html(d||""),e.Hub.Queue(["Typeset",e.Hub,a.get(0)]);var f=o(a);t.setToc&&t.setToc({toc:f})}m&&r(a,m,n),p&&i(a,p,l)})}function r(e,a,n){e.find("sup.footnote[data-footnote]").each(function(e,r){var i=angular.element(r),o=i.data("footnote"),l=a[o];i.on("click",t.partial(n,l)).text(e+1)})}function i(e,a,n){e.find("cite[id]").each(function(e,r){var i=angular.element(r),o=i.attr("id"),l=a[o];l&&i.on("click",t.partial(n,l)).html(l)})}function o(e){function t(e){for(var a=0;a<e.length;a++){var n=e[a],r=a<e.length?e[a+1]:null;angular.element(n.el).nextUntil(r?r.el:null).andSelf().wrapAll('<section id="'+n.id+'"/>'),t(n.children)}}var n=a.parse(e);return t(n.children),n}var l={restrict:"E",scope:{body:"=",footnotes:"=",citations:"=",setToc:"&generateToc"},link:n};return l}e.$inject=["MathJax","_","tocGenerator"],angular.module("sdaReader").directive("articleParser",e)}(),function(){"use strict";function e(e,t,a){function n(){}function r(t){e(t).toggle()}function i(e){return!1}function o(){d.queryResult.last&&$http.get(d.queryResult.query.last.uri).then(function(e){d.queryResult=e.data})}function l(){d.queryResult.next&&$http.get(d.queryResult.query.next.uri).then(function(e){d.queryResult=e.data})}function s(){d.queryResult.previous&&$http.get(d.queryResult.query.previous.uri).then(function(e){d.queryResult=e.data})}function c(){d.queryResult.first&&$http.get(d.queryResult.query.first.uri).then(function(e){d.queryResult=e.data})}var d=this;d.queryResult=null,d.toggleSidenav=r,d.search=i,d.displayFirstPage=c,d.displayPrevPage=s,d.displayNextPage=l,d.displayLastPage=o,n()}e.$inject=["$mdSidenav","$mdToast","articlesRepo"],angular.module("sdaReader").controller("ReaderController",e)}(),function(){"use strict";function e(e){var t=this;t.article=e}e.$inject=["article"],angular.module("sdaReader").controller("PreviewController",e)}(),function(){"use strict";function e(e,r,i,o,l,s,c,d,u,m,p){function f(){var e=o.$promise.then(function(){return p.render("chicago",o)});e.then(function(e){$.citations=e.citations,$.bibliography=e.bibliography}),d.$on("click:footnote",function(e,t){d.$apply(function(){b(t.note,t.$event)})}),d.$on("click:citation",function(e,t){d.$apply(function(){R(t.citation,t.$event)})}),$.orderedFootnotes=h($.article),g()}function h(e){var t=[];return angular.element(e.body).find("sup.footnote[data-footnote]").each(function(a,n){var r=angular.element(n).data("footnote"),i=e.footnotes[r];i&&(t.indexOf(i)>=0?s.error("duplicate reference to footnote "+r):t.push(i))}),t}function g(){r.scrollTo&&u(function(){var e=m.findWhere($.article.footnotes,{backlinkId:r.scrollTo});if(e)return void b(e);var t=m.findWhere($.citations,{backlinkId:r.scrollTo});return t?void R(t):void v(r.scrollTo,!1)})}function v(e,t,a){a&&(a.preventDefault(),a.stopPropagation());var n=angular.element("#article-content"),r=angular.element("#"+e);try{t?n.duScrollToElementAnimated(r):n.duScrollToElement(r)}catch(t){s.warn("unable to scroll to element by id",e)}}function y(e,t){t&&(t.preventDefault(),t.stopPropagation());var a=angular.element("#article-content");e?a.duScrollTopAnimated(0):a.duScrollTop(0)}function b(e,t){angular.forEach($.article.footnotes,function(e){e.active=!1}),e.active=!0,$.activeTab=a,v(e.backlinkId,!0,t)}function R(e,t){$.activeTab=n,v(e.id,!0,t)}var $=this;$.article=i,$.activeTab=t,$.links=[],$.orderedFootnotes=[],$.articleType=null,$.toc=[],$.citations=[],$.bibliography=[],$.titleCase=m.startCase,$.scrollTo=v,$.scrollToTop=y,$.activateNote=b,$.goBack=function(){e.go("sda.reader.main.preview",{id:$.article.id})},f()}e.$inject=["$state","$stateParams","article","references","articlesRepo","$log","$window","$scope","$timeout","_","refsRenderer"],angular.module("sdaReader").controller("ArticleController",e);var t=0,a=2,n=3}(),function(){"use strict";function e(e,t){e.debug("runBlock end"),t.$on("duScrollspy:becameActive",function(e,t){t.parents("li").addClass("active")}),t.$on("duScrollspy:becameInactive",function(e,t){t.parents("li").removeClass("active")})}e.$inject=["$log","$rootScope"],angular.module("sdaReader").run(e)}(),function(){"use strict";function e(e,t){e.state("reader",{url:"/",templateUrl:"app/reader/reader.html",controller:"ReaderController",controllerAs:"vm"}).state("reader.preview",{url:"preview/:id",templateUrl:"app/preview/preview.html",controller:"PreviewController",controllerAs:"vm",resolve:{article:["$stateParams","articlesRepo",function(e,t){var a=t.get(e.id);return a.$promise}]}}).state("article",{url:"/article/:id",templateUrl:"app/article/article.html",controller:"ArticleController",controllerAs:"vm",resolve:{article:["$stateParams","articlesRepo",function(e,t){var a=t.get(e.id);return a.$promise}],references:["$stateParams","articlesRepo","refsRepoFactory",function(e,t,a){var n=t.getReferencesEndpoint(e.id),r=a.getRepo(n);return r.get()}]}}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("sdaReader").config(e)}(),function(){"use strict";angular.module("sdaReader").constant("MathJax",MathJax)}(),function(){"use strict";function e(e,t,a,n){e.debugEnabled(!0),a.url="/api/catalog/categorizations",n.url="/api/catalog/entries/articles",t.definePalette("darkBrown",{50:"#595c59",100:"#4c4f4c",200:"#404240",300:"#333533",400:"#272827",500:"#1a1b1a",600:"#0d0e0d",700:"#010101",800:"#000000",900:"#000000",A100:"#e0f0e0",A200:"#565956",A400:"#7e837e",A700:"#000000",contrastDefaultColor:"light",contrastDarkColors:["A100"]}),t.definePalette("copper",{50:"#d4b190",100:"#cca47e",200:"#c5976b",300:"#be8a59",400:"#b67e47",500:"#a47140",600:"#926439",700:"#7f5832",800:"#6d4b2b",900:"#5b3e23",A100:"#dcc3ab",A200:"#a47140",A400:"#48321c",A700:"#272927",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"]}),t.theme("default").primaryPalette("darkBrown").accentPalette("copper")}e.$inject=["$logProvider","$mdThemingProvider","categorizationRepoProvider","articlesRepoProvider"],angular.module("sdaReader").config(e)}(),function(){"use strict";function e(e){function n(t,a){function n(e){return e.get("/assets/csl/locales/locales-"+t+".xml").then(function(e){return e.data})}n.$inject=["$http"],e.addLocale(a,n)}function r(t,a){function n(e){return e.get("/assets/csl/styles/"+t+".csl").then(function(e){return e.data})}n.$inject=["$http"],e.addStyle(a,n)}angular.forEach(t,n),angular.forEach(a,r)}e.$inject=["citeprocProvider"],angular.module("sdaReader").config(e);var t={"en-US":"en-US"},a={mla:"modern-language-association",chicago:"chicago-author-date"}}(),angular.module("sdaReader").run(["$templateCache",function(e){e.put("app/article/article.html",'<md-toolbar class=layout-navbar><div class=md-toolbar-tools><md-button class="md-accent md-icon-button" ng-click="vm.toggleSidenav(\'left\')" hide-gt-sm><md-icon>menu</md-icon></md-button><a class=logo href=/ ><img src=/assets/images/sda-logo-light.png alt=SDA></a><h1><a ui-sref=reader>SDA Reader</a></h1></div></md-toolbar><main layout=row layout-align=center flex><md-sidenav md-component-id=left class=md-sidenav-left md-is-locked-open="$mdMedia(\'gt-sm\')" layout=column><md-tabs md-selected=vm.activeTab flex><md-tab label=Contents><div class=toc><ol dx-start-with=vm.toc du-scrollspy-context><li ng-repeat="node in $dxPrior.children" du-scrollspy={{node.id}} du-scroll-container=article-content><a ui-sref="article({id: vm.node.id, scrollTo: node.id})" ng-click="vm.scrollTo(node.id, true, $event)">{{node.text}}</a><ol dx-connect=node></li></ol></div></md-tab><md-tab label=Links>TODO</md-tab><md-tab label=Footnotes><div class=notes><ol du-scrollspy-context><li ng-repeat="note in vm.orderedFootnotes track by note.id" ng-class="{active: note.active}" du-scrollspy={{note.backlinkId}} du-scroll-container=article-content><a ui-sref="article({id: vm.article.id, scrollTo: note.backlinkId})" ng-click="vm.activateNote(note, $event)" ng-model=note.content mathjax></a></li></ol></div></md-tab><md-tab label=Bibliography><div class=refs><ol class=bibliography><li ng-repeat="item in vm.bibliography.items" ng-bind-html=item></li></ol></div></md-tab></md-tabs></md-sidenav><article id=article-content layout=column flex layout-padding><md-content><h1 class=md-display-1>{{vm.article.title}}</h1><p class=author-info ng-if="vm.article.authors && vm.article.authors.length > 0">by <span class=author ng-repeat="author in vm.article.authors"><a href=mailto:{{author.contact.email}} ng-if=author.contact.email>{{author.name}}</a> <span ng-if=!author.contact.email>{{author.name}}</span></span></p><article-parser body=vm.article.body generate-toc="vm.toc = toc" footnotes=vm.article.footnotes citations=vm.citations></article-parser></md-content></article></main>'),e.put("app/preview/preview.html",'<div layout=column layout-padding flex><h1 class=md-display-1>{{vm.article.title}}</h1><p class=author-info ng-if="vm.article.authors && vm.article.authors.length > 0">by <span class=author ng-repeat="author in vm.article.authors"><a ng-if=author.contact.email href=mailto:{{author.contact.email}}>{{author.name}}</a> <span ng-if=!author.contact.email>{{author.name}}</span></span></p><section class=abstract ng-if=vm.article.abstract><h2>Summary</h2><div ng-bind-html=vm.article.abstract></div></section><div layout=row layout-align=end><md-button class="md-accent md-raised" ui-sref="article({id: vm.article.id})">Read Full Article</md-button></div></div>'),e.put("app/reader/reader.html",'<md-toolbar class=layout-navbar layout=row layout-align=center><div class="md-toolbar-tools container"><md-button class="md-accent md-icon-button" ng-click="vm.toggleSidenav(\'left\')" hide-gt-sm><md-icon>menu</md-icon></md-button><a class=logo href=/ layout=column layout-align="center center"><img src=/assets/images/sda-logo-light.png alt=SDA flex=nogrow></a><h1><a ui-sref=reader>SDA Reader</a></h1></div></md-toolbar><div class=page-banner layout=row layout-align=center><div class=container flex><h1>SDA Reader</h1></div></div><main layout=row layout-align=center flex><div class=container layout=row flex><md-sidenav md-component-id=left class=md-sidenav-left md-is-locked-open="$mdMedia(\'gt-sm\')" layout=column><md-tabs flex><md-tab label=Themes><div layout=column><div layout=row flex=none><md-input-container flex><label>Search articles</label><md-icon>search</md-icon><input type=search ng-model=query ng-model-options="{debounce: 500}" ng-change=vm.search(query)></md-input-container></div><div class=collections flex><tree-categorization scope-id=sda scheme=overviews></tree-categorization></div></div></md-tab><md-tab label=Articles>Coming soon...</md-tab><md-tab label=Reviews>Coming soon...</md-tab><md-tab label=Biographies>Coming soon...</md-tab></md-tabs></md-sidenav><div layout=column flex ui-view><div ng-if=vm.loading flex layout=row layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if="!vm.loading && vm.queryResult"><h1>Search Results <small ng-if=vm.queryResult.query.q>"{{vm.queryResult.query.q}}"</small></h1><p ng-if=vm.queryResult.query>Showing {{vm.queryResult.query.totalResults == 0 ? 0 : vm.queryResult.query.offset+1}}&ndash;{{vm.queryResult.query.offset + vm.queryResult.articles.length}} of {{vm.queryResult.query.totalResults}}</p><nav class=pagination ng-if="vm.queryResult.query.numPages > 1"><a href="" ng-click=vm.displayFirstPage() ng-if=vm.queryResult.query.first><i class="fa fa-angle-double-left"></i> <span class=sr-only>First</span> </a><a href="" ng-click=vm.displayPrevPage() ng-if=vm.queryResult.query.previous><i class="fa fa-angle-left"></i> <span class=sr-only>Previous</span> </a><span>{{vm.queryResult.query.pg}}</span> <a href="" ng-click=vm.displayNextPage() ng-if=vm.queryResult.query.next><span class=sr-only>Next</span> <i class="fa fa-angle-right"></i> </a><a href="" ng-click=vm.displayLastPage() ng-if=vm.queryResult.query.last><span class=sr-only>Last</span> <i class="fa fa-angle-double-right"></i></a></nav><ol ng-if=vm.queryResult.articles><li class=result ng-repeat="result in vm.queryResult.articles"><h3><a ui-sref="sda.reader.article({id: result.id})">{{result.title}}</a></h3><span class=author ng-repeat="author in result.authors">{{author.name}}, {{author.affiliation}}</span><p ng-bind-html=result.absHL></p><p ng-bind-html=result.contentHL></p></li></ol><div ng-if=!vm.queryResult.articles>No results</div><nav class=pagination ng-if="vm.queryResult.query.numPages > 1"><a href="" ng-click=vm.displayFirstPage() ng-if=vm.queryResult.query.first><i class="fa fa-angle-double-left"></i> <span class=sr-only>First</span> </a><a href="" ng-click=vm.displayPrevPage() ng-if=vm.queryResult.query.previous><i class="fa fa-angle-left"></i> <span class=sr-only>Previous</span> </a><span>{{vm.queryResult.query.pg}}</span> <a href="" ng-click=vm.displayNextPage() ng-if=vm.queryResult.query.next><span class=sr-only>Next</span> <i class="fa fa-angle-right"></i> </a><a href="" ng-click=vm.displayLastPage() ng-if=vm.queryResult.query.last><span class=sr-only>Last</span> <i class="fa fa-angle-double-right"></i></a></nav></div><md-content layout=row layout-padding flex ng-if=!vm.queryResult><section flex=66><h1 class=md-display-1>SDA Reader</h1><p>The SDA Reader contains articles that provide an encyclopedic survey of contemporary research issues in the field and provide critical reflection on select works and people documented in the historical collection. Following the genre of print-based introductory readers widely used within philosophy, theology and Humanities disciplines, the SDA reader provides a starting point those who want an introduction to specific topics and directions for further research.</p><p>The SDA Reader contains four main categories of content.</p><ul class=list-style-type:none;><li><p><em>Thematic Overviews</em> provide a systematic survey of key concepts in the field of SDA. Each overview article introduces a key topic and provides references to both the primary source material and the research literature for those who wish to explore the issue in more depth.</p></li><li><p><em>Research Articles</em> provide scholarly treatment of specific topics. These are of a length, quality, and scope associated with peer-reviewed journal articles and exceptional conference presentations.</p></li><li><p><em>Book Reviews</em> offer a critical review of a book within the digital library. Reviews go beyond the summary information that accompanies each work to offer a critical assesment of the book\'s scholarly merit and impact as well as its relevance to contemporary research.</p></li><li><p><em>Biographies</em> describe the professional and personal life of influential people documented in the digital library. These research articles serve to contextualize the books written by these individuals and assess their overall impact on the development of thought on this topic.</p></li></ul></section><aside flex=33><h2>Perspectives on SDA</h2><ul style=list-style-type:none><li><a href="">Philosophers</a></li><li><a href="">Theologians</a></li><li><a href="">Scientists</a></li><li><a href="">Historians</a></li><li><a href="">Literary Scholars</a></li><li><a href="">Scripture Scholars</a></li><li><a href="">Artists</a></li><li><a href="">Atheists</a></li><li><a href="">Students</a></li><li><a href="">Anyone</a></li></ul><h2>Concept Map</h2><div class=cmap-container><a href=""><img src=//placehold.it/200x200></a></div></aside></md-content></div></div></main>'),e.put("app/components/tree-categorization/tree-categorization-item.html",'<span ng-if="node.entryRef == null">{{ node.label }}</span> <a ui-sref="reader.preview({id: node.entryRef.id})" ng-if="node.entryRef != null">{{ node.label }}</a><ol ng-if="node.children.length > 0"><li ng-repeat="node in node.children" ng-include="\'app/components/tree-categorization/tree-categorization-item.html\'" ng-init="parent = $parent.$parent.node"></li></ol>'),e.put("app/components/tree-categorization/tree-categorization.html",'<ol><li ng-repeat="node in vm.categories.root.children" ng-include="\'app/components/tree-categorization/tree-categorization-item.html\'" ng-init="parent = vm.categories.root"></li></ol>')}]);