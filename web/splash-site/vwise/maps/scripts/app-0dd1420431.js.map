{"version":3,"sources":["scripts/app.js"],"names":["angular","module","workspaceRepositoryProvider","vwise","workspaceRepositoryFactory","panelContentMediatorRegistry","$http","$q","NgWorkspaceRepository","provider","url","$inject","declare","$get","mediatorRegistry","WorkspaceRepository","call","this","workspaces","Cache","panels","prototype","Object","create","createWorkspace","title","id","UUID","uuid4","workspace","Workspace","when","saveWorkspace","TypeError","getWorkspace","reject","Error","createPanel","mediator","content","repo","panel","Panel","p","savePanel","getPanel","workspaceId","panelId","workPanelDirective","worksRepo","linkFunc","scope","getTitle","work","titles","editions","forEach","edition","type","workId","directive","restrict","templateUrl","link","volumePanelDirective","volume","getEdition","editionId","editionPanelDirective","volumes","personPanelDirective","_","name","person","label","at","NAME_KEYS","map","n","trim","filter","identity","join","worksContentMediatorFactory","Mediator","PanelContentMediator","loadWork","get","$promise","matches","obj","initPanelData","unmarshall","dto","marshall","panelData","getTemplate","factory","volumesContentMediatorFactory","loadVolume","volumeId","getVolume","then","peopleContentMediatorFactory","peopleRepo","loadPerson","passthruContentMediatorFactory","panelContentMediatorRegistryFactory","PanelContentMediatorRegistry","noteContentMediatorFactory","hasOwnProperty","editionsContentMediatorFactory","loadEdition","internetArchiveContentMediatorFactory","hathitrustContentMediatorFactory","googleBooksContentMediatorFactory","vwisePanel","$compile","$scope","$el","attrs","$eval","panelScope","$new","vprops","$watch","color","match","r","parseInt","g","b","foreground","calculateForeground","template","contentMediator","contentArea","find","html","contents","Math","pow","lum","iaReader","$sce","properties","src","trustAsResourceUrl","replace","hathitrustReader","params","htid","ui","seq","queryString","value","key","READER_URL","WorkspaceController","workspaceRepository","$log","$timeout","$mdSidenav","hotkeys","activate","vm","items","push","text","bindTo","add","combo","description","callback","sidebarFocused","searchQuery","element","focus","toggle","createNotePanel","search","query","tagAll","arr","loading","peopleResults","worksResults","all","property","panelDragged","evt","xPosition","position","left","yPosition","max","top","savePanelPosition","debug","setPosition","activatePanel","resizePanel","width","helper","height","$apply","savePanelSize","setSize","stopPropagation","closePanel","remove","thingDropped","itemScope","draggable","item","offsetX","context","contentMediators","findContentMediators","length","contentP","panelP","set","x","y","note","workspaceClicked","ctrlKey","clientX","clientY","activeItems","debounce","controller","runBlock","peopleContentMediator","worksContentMediator","editionsContentMediator","volumesContentMediator","googleBooksContentMediator","hathitrustContentMediator","internetArchiveContentMediator","noteContentMediator","passthruContentMediator","register","run","constant","config","googleBooksApiProvider","configure","preventLoad","worksRepoProvider","worksRepoFactory","$resource","findAll","restResource","q","getWork","isUndefined","adaptWork","editionResource","adaptEdition","volumeResource","adaptVolume","createWork","authors","createEdition","createVolume","save","arguments","saveWork","apply","saveEdition","saveVolume","$update","$save","deleteWork","dataItem","adaptCommon","entity","toLowerCase","author","role","otherAuthors","copies","getTitleByTypePreference","types","isArray","reduce","found","update","method","getAll","relationshipsRepoProvider","relationshipsRepoFactory","getTypes","options","typesCache","force","typeResource","tcPromise","identifier","defineProperty","getType","createRelationship","reln","relnResource","adaptRelationship","createProvenance","provenance","adaptProvenance","createAnchor","anchor","adaptAnchor","findById","isString","uri","queryOpts","typeId","direction","start","off","saveRelationship","deleteRelationship","response","relatedEntities","targetEntities","creatorUris","entryUris","normalizeRelationships","relationships","currentUri","normalizedRelationships","relationship","isReverse","some","targetField","entities","flattened","concat","resolveEntityUri","reverse","relnsByTypeDir","fwd","rev","typeGroups","dirs","isDirected","reverseTitle","group","ENTITY_URI","exec","makeVolumeEntity","makeEditionEntity","makeWorkEntity","refParams","subtitle","editionName","volumeNumber","peopleRepoProvider","peopleRepoFactory","createPerson","adaptPerson","createMeta","meta","adaptMeta","createName","adaptName","createEvent","adaptEvent","createDateDescription","dateDescription","savePerson","personId","deletePerson","altNames","birth","death","links","date","trcPersonEditorDirective","PersonEditorController","addName","newName","removeName","ix","splice","addEvent","newEvent","removeEvent","controllerAs","trcNameEditorDirective","NameEditorController","roles","trcEventEditorDirective","event","extend","API","loadGoogleBooks","googleBooksScriptLoader","load","transport","v","language","$window","$document","getScriptUrl","includeScript","omitOptions","omit","k","scriptId","scriptElem","getElementById","parentNode","removeChild","round","random","appendTo","isGoogleBooksLoaded","isDefined","google","books","deferred","defer","resolve","promise","randomizedFunctionName","usedConfiguration","manualLoad","undefined","googleBookReader","googleBooksApi","googleBooksApiManualLoader","el","viewer","DefaultViewer","$on","resize","service","routerConfig","$stateProvider","$urlRouterProvider","state","otherwise","moment","$logProvider","$mdThemingProvider","debugEnabled","definePalette","50","100","200","300","400","500","600","700","800","900","A100","A200","A400","A700","contrastDefaultColor","contrastDarkColors","theme","primaryPalette","accentPalette","$templateCache","put"],"mappings":"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","file":"scripts/app-0dd1420431.js","sourcesContent":["(function () {\n  'use strict';\n\n  angular\n    .module('vwise', [\n      'google.books',\n      'cfp.hotkeys',\n      'trcWorks',\n      'trcBio'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .provider('workspaceRepository', workspaceRepositoryProvider);\n\n  /** @ngInject */\n  function workspaceRepositoryProvider(vwise) {\n    var NgWorkspaceRepository = declare(vwise);\n\n    var provider = {\n      url: '/api/vwise',\n      $get: workspaceRepositoryFactory\n    };\n\n    return provider;\n\n    /** @ngInject */\n    function workspaceRepositoryFactory(panelContentMediatorRegistry, $http, $q) {\n      return new NgWorkspaceRepository(panelContentMediatorRegistry, provider.url, $http, $q);\n    }\n  }\n\n  /**\n   * Declares and returns the NgWorkspaceRepository class.\n   * Required protoypical inheritance of vwise.WorkspaceRepository makes this class definition verbose but necessary.\n   * Ideally (and eventually) this should be done as an ES6 class in a separate file and loaded via an import statement.\n   * @param  {vwise} vwise\n   * @return {Class.<NgWorkspaceRepository>}\n   */\n  function declare(vwise) {\n    /**\n     * Angularized Workspace Repository; makes use of $http, and $q services (must be injected at construction)\n     * @class\n     * @extends {vwise.WorkspaceRepository}\n     */\n    function NgWorkspaceRepository(mediatorRegistry, url, $http, $q) {\n      vwise.WorkspaceRepository.call(this, mediatorRegistry);\n\n      // injected services and configuration options\n      this.$http = $http;\n      this.$q = $q;\n      this.url = url;\n\n      /**\n       * A cache for storing loaded workspace instances\n       * @type {vwis.Cache.<Promise.<Workspace>}\n       */\n      this.workspaces = new vwise.Cache;\n\n      /**\n      * A cache for storing loaded panel instances\n      * @type {vwis.Cache.<Promise.<Panel>}\n      */\n      this.panels = new vwise.Cache;\n    }\n\n    NgWorkspaceRepository.prototype = Object.create(vwise.WorkspaceRepository.prototype);\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.createWorkspace = function createWorkspace(title) {\n      var id = vwise.UUID.uuid4();\n      var workspace = new vwise.Workspace(id, this);\n\n      if (title) {\n        workspace.title = title;\n      }\n\n      this.workspaces[workspace.id] = workspace;\n      return this.$q.when(workspace);\n    };\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.saveWorkspace = function saveWorkspace(workspace) {\n      if (!(workspace instanceof vwise.Workspace)) {\n        throw new TypeError('expected instance of Workspace');\n      }\n\n      this.workspaces[workspace.id] = workspace;\n      return this.$q.when(workspace);\n    };\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.getWorkspace = function getWorkspace(id) {\n      return this.workspaces[id] ? this.$q.when(this.workspaces[id]) : this.$q.reject(new Error('workspace not found'));\n    };\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.createPanel = function createPanel(mediator, workspace, content) {\n      var id = vwise.UUID.uuid4();\n      var repo = this;\n      var panel = new vwise.Panel(id, mediator, workspace, content, function (p) {\n        repo.savePanel(p);\n      });\n\n      this.panels[panel.id] = panel;\n      return this.$q.when(panel);\n    };\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.savePanel = function savePanel(panel) {\n      if (!(panel instanceof vwise.Panel)) {\n        throw new TypeError('expected instance of Panel');\n      }\n\n      this.panels[panel.id] = panel;\n      return this.$q.when(panel);\n    };\n\n    /**\n     * @inheritdoc\n     */\n    NgWorkspaceRepository.prototype.getPanel = function getPanel(workspaceId, panelId) {\n      return this.panels[panelId] ? this.$q.when(this.panels[panelId]) : this.$q.reject(new Error('panel not found'));\n    };\n\n    return NgWorkspaceRepository;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .directive('workPanel', workPanelDirective);\n\n  /** @ngInject */\n  function workPanelDirective(worksRepo) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/vwise/components/work-panel/work-panel.html',\n      scope: {\n        work: '='\n      },\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope) {\n      scope.title = worksRepo.getTitle(scope.work.titles);\n\n      scope.work.editions.forEach(function (edition) {\n        edition.type = 'edition';\n        edition.workId = scope.work.id;\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .directive('volumePanel', volumePanelDirective);\n\n  /** @ngInject */\n  function volumePanelDirective(worksRepo) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/vwise/components/work-panel/volume-panel.html',\n      scope: {\n        volume: '=',\n        workId: '@',\n        editionId: '@'\n      },\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope) {\n      scope.title = worksRepo.getTitle(scope.volume.titles);\n\n      scope.edition = worksRepo.getEdition(scope.workId, scope.editionId);\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .directive('editionPanel', editionPanelDirective);\n\n  /** @ngInject */\n  function editionPanelDirective(worksRepo) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/vwise/components/work-panel/edition-panel.html',\n      scope: {\n        edition: '=',\n        workId: '@'\n      },\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope) {\n      scope.title = worksRepo.getTitle(scope.edition.titles);\n\n      scope.edition.volumes.forEach(function (volume) {\n        volume.type = 'volume';\n        volume.workId = scope.workId;\n        volume.editionId = scope.edition.id;\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .directive('personPanel', personPanelDirective);\n\n  var NAME_KEYS = ['title', 'givenName', 'middleName', 'familyName', 'suffix'];\n\n  /** @ngInject */\n  function personPanelDirective(_) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/vwise/components/person-panel/person-panel.html',\n      scope: {\n        person: '='\n      },\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope) {\n      var name = scope.person.name;\n\n      scope.name = name.label || _.at(name, NAME_KEYS)\n        .map(function (n) { return n.trim(); })\n        .filter(_.identity)\n        .join(' ');\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('worksContentMediator', worksContentMediatorFactory);\n\n  /** @ngInject */\n  function worksContentMediatorFactory(vwise, worksRepo) {\n\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'works', 'Works Content Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'work' && obj.id;\n    };\n\n    Mediator.prototype.initPanelData = function initPanelData(obj) {\n      return loadWork(obj.id);\n    };\n\n    Mediator.prototype.unmarshall = function unmarshall(dto) {\n      return loadWork(dto.id);\n    };\n\n    Mediator.prototype.marshall = function marshall(panelData) {\n      var dto = {\n        type: 'work',\n        id: panelData.id\n      };\n\n      return dto;\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<work-panel work=\"content\" flex layout=\"column\"></work-panel>'\n    };\n\n    return new Mediator();\n\n\n    function loadWork(id) {\n      var work = worksRepo.get(id);\n      return work.$promise;\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('volumesContentMediator', volumesContentMediatorFactory);\n\n  /** @ngInject */\n  function volumesContentMediatorFactory(vwise, worksRepo) {\n\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'volumes', 'Volumes Content Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'volume' && obj.id && obj.workId && obj.editionId;\n    };\n\n    Mediator.prototype.initPanelData = function initPanelData(obj) {\n      return loadVolume(obj.workId, obj.editionId, obj.id);\n    };\n\n    Mediator.prototype.unmarshall = function unmarshall(dto) {\n      return loadVolume(dto.workId, dto.editionId, dto.id);\n    };\n\n    Mediator.prototype.marshall = function marshall(panelData) {\n      var dto = {\n        type: 'volume',\n        id: panelData.id,\n        workId: panelData.workId,\n        editionId: panelData.editionId\n      };\n\n      return dto;\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<volume-panel volume=\"content\" edition-id=\"{{content.editionId}}\" work-id=\"{{content.workId}}\" flex layout=\"column\"></volume-panel>'\n    };\n\n    return new Mediator();\n\n\n    function loadVolume(workId, editionId, volumeId) {\n      var volume = worksRepo.getVolume(workId, editionId, volumeId);\n      return volume.$promise.then(function () {\n        volume.workId = workId;\n        volume.editionId = editionId;\n        return volume;\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('peopleContentMediator', peopleContentMediatorFactory);\n\n  /** @ngInject */\n  function peopleContentMediatorFactory(vwise, peopleRepo) {\n\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'people', 'People Content Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'person' && obj.id;\n    };\n\n    Mediator.prototype.initPanelData = function initPanelData(obj) {\n      return loadPerson(obj.id);\n    };\n\n    Mediator.prototype.unmarshall = function unmarshall(dto) {\n      return loadPerson(dto.id);\n    };\n\n    Mediator.prototype.marshall = function marshall(panelData) {\n      var dto = {\n        type: 'person',\n        id: panelData.id\n      };\n\n      return dto;\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<person-panel person=\"content\" flex layout=\"column\"></person-panel>'\n    };\n\n    return new Mediator();\n\n\n    function loadPerson(id) {\n      var person = peopleRepo.get(id);\n      return person.$promise;\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('passthruContentMediator', passthruContentMediatorFactory);\n\n  /** @ngInject */\n  function passthruContentMediatorFactory(vwise) {\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'passthru', 'Pass-Through Debug Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches() {\n      return true;\n    };\n\n    return new Mediator();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('panelContentMediatorRegistry', panelContentMediatorRegistryFactory);\n\n  /** @ngInject */\n  function panelContentMediatorRegistryFactory(vwise) {\n    return new vwise.PanelContentMediatorRegistry();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('noteContentMediator', noteContentMediatorFactory);\n\n  /** @ngInject */\n  function noteContentMediatorFactory(vwise) {\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'notes', 'Note Content Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.hasOwnProperty('note');\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<div ng-model=\"content.note\" contenteditable flex></div>'\n    };\n\n    return new Mediator();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('editionsContentMediator', editionsContentMediatorFactory);\n\n  /** @ngInject */\n  function editionsContentMediatorFactory(vwise, worksRepo) {\n\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'editions', 'Editions Content Mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'edition' && obj.id && obj.workId;\n    };\n\n    Mediator.prototype.initPanelData = function initPanelData(obj) {\n      return loadEdition(obj.workId, obj.id);\n    };\n\n    Mediator.prototype.unmarshall = function unmarshall(dto) {\n      return loadEdition(dto.workId, dto.id);\n    };\n\n    Mediator.prototype.marshall = function marshall(panelData) {\n      var dto = {\n        type: 'edition',\n        id: panelData.id,\n        workId: panelData.workId\n      };\n\n      return dto;\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<edition-panel edition=\"content\" work-id=\"{{content.workId}}\" flex layout=\"column\"></edition-panel>'\n    };\n\n    return new Mediator();\n\n\n    function loadEdition(workId, editionId) {\n      var edition = worksRepo.getEdition(workId, editionId);\n      return edition.$promise.then(function () {\n        edition.workId = workId;\n        return edition;\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('internetArchiveContentMediator', internetArchiveContentMediatorFactory);\n\n  /** @ngInject */\n  function internetArchiveContentMediatorFactory(vwise) {\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'ia-reader', 'Internet Archive Digital Copy mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'internetarchive';\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<ia-reader properties=\"content.properties\" flex></ia-reader>'\n    };\n\n    return new Mediator();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('hathitrustContentMediator', hathitrustContentMediatorFactory);\n\n  /** @ngInject */\n  function hathitrustContentMediatorFactory(vwise) {\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'ht-reader', 'HathiTrust Digital Copy mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'hathitrust';\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<hathitrust-reader properties=\"content.properties\" flex></hathitrust-reader>'\n    };\n\n    return new Mediator();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .factory('googleBooksContentMediator', googleBooksContentMediatorFactory);\n\n  /** @ngInject */\n  function googleBooksContentMediatorFactory(vwise) {\n    function Mediator() {\n      vwise.PanelContentMediator.call(this, 'gb-reader', 'Google Books Digital Copy mediator');\n    }\n\n    Mediator.prototype = Object.create(vwise.PanelContentMediator.prototype);\n\n    Mediator.prototype.matches = function matches(obj) {\n      return obj.type && obj.type === 'googlebooks';\n    };\n\n    Mediator.prototype.getTemplate = function getTemplate() {\n      return '<google-book-reader properties=\"content.properties\" flex></google-book-reader>'\n    };\n\n    return new Mediator();\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .directive('vwisePanel', vwisePanel);\n\n  /** @ngInject */\n  function vwisePanel ($compile) {\n    var directive = {\n      restrict: 'A',\n      templateUrl: 'app/vwise/components/panel/panel.html',\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc($scope, $el, attrs) {\n      var panel = $scope.$eval(attrs.vwisePanel);\n      if (!panel) {\n        throw new Error('no panel provided');\n      }\n\n      var panelScope = $scope.$new(true);\n      panelScope.content = panel.content;\n      panelScope.vprops = panel.vprops;\n\n      panelScope.$watch('vprops.background', function (color) {\n        var match = color.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);\n\n        if (!match) {\n          return;\n        }\n\n        // Foreground calculation from http://stackoverflow.com/a/3943023\n\n        // calculate luminance coefficient\n        // see https://en.wikipedia.org/wiki/Luma_(video)#Rec._601_luma_versus_Rec._709_luma_coefficients\n        var r = parseInt(match[1], 16) / 255;\n        var g = parseInt(match[2], 16) / 255;\n        var b = parseInt(match[3], 16) / 255;\n\n        panel.vprops.foreground = calculateForeground(r, g, b);\n      });\n\n      var template = panel.contentMediator.getTemplate();\n\n      var contentArea = $el.find('.content');\n      contentArea.html(template);\n      $compile(contentArea.contents())(panelScope);\n    }\n  }\n\n  function calculateForeground(r, g, b) {\n    r = (r <= 0.03928) ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);\n    g = (g <= 0.03928) ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);\n    b = (b <= 0.03928) ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);\n\n    var lum = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\n    // set contrast color based on W3C recommendations\n    // see https://www.w3.org/TR/WCAG20/\n\n    // panel.vprops.foreground = (lum > 0.179) ? '#000000' : '#ffffff';\n    // adjusted so that #808080 is the transition point between FG colors\n    return (lum > 0.215) ? 'rgba(0,0,0,0.87)' : 'rgba(255,255,255,0.87)';\n  }\n\n})();\n\n(function () {\n   'use strict';\n\n   angular\n      .module('vwise')\n      .directive('iaReader', iaReader);\n\n   /** @ngInject */\n   function iaReader($sce) {\n      var directive = {\n         restrict: 'E',\n         template: '<iframe ng-src=\"{{src}}\">',\n         replace: true,\n         link: linkFunc,\n         scope: {\n            properties: '='\n         }\n      };\n\n      return directive;\n\n      function linkFunc(scope) {\n        scope.$watch('properties', function(properties) {\n           // TODO add page link\n            //  <iframe class=\"reader flex\" src=\"https://archive.org/stream/essayinanswertom00adamiala?ui=embed#page/n5/mode/2up\" frameborder=\"0\"></iframe>\n           scope.src = $sce.trustAsResourceUrl('https://archive.org/stream/' + properties.id + '?ui=embed#mode/2up');\n        });\n      }\n   }\n\n})();\n\n(function () {\n   'use strict';\n\n   var READER_URL = 'https://babel.hathitrust.org/cgi/pt';\n\n   angular\n      .module('vwise')\n      .directive('hathitrustReader', hathitrustReader);\n\n   /** @ngInject */\n   function hathitrustReader($sce, _) {\n      var directive = {\n         restrict: 'E',\n         template: '<iframe ng-src=\"{{src}}\">',\n         replace: true,\n         link: linkFunc,\n         scope: {\n            properties: '='\n         }\n      };\n\n      return directive;\n\n      function linkFunc(scope) {\n         scope.$watch('properties', function (properties) {\n            var params = {\n               id: properties.htid,\n               ui: 'embed'\n            };\n\n            if (properties.seq) {\n               params.seq = properties.seq;\n            }\n\n            var queryString = _.map(params, function (value, key) {\n               return key + '=' + value;\n            }).join(';');\n\n            var url = READER_URL + '?' + queryString;\n\n            scope.src = $sce.trustAsResourceUrl(url);\n         });\n      }\n   }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .controller('WorkspaceController', WorkspaceController);\n\n  /** @ngInject */\n  function WorkspaceController(vwise, panelContentMediatorRegistry, workspaceRepository, $log, $scope, $timeout, $mdSidenav, hotkeys, _, $q, peopleRepo, worksRepo) {\n    var vm = this;\n\n    vm.workspace = new vwise.Workspace('test', workspaceRepository);\n\n    vm.items = [];\n    vm.activeItems = [];\n    vm.searchQuery = '';\n    vm.sidebarFocused = true;\n\n    vm.panelDragged = panelDragged;\n    vm.savePanelPosition = savePanelPosition;\n    vm.thingDropped = thingDropped;\n    vm.workspaceClicked = workspaceClicked;\n    vm.resizePanel = resizePanel;\n    vm.savePanelSize = savePanelSize;\n    vm.activatePanel = activatePanel;\n    vm.closePanel = closePanel;\n\n    vm.search = _.debounce(search, 300);\n\n    activate();\n\n    function activate() {\n      [1,2,3,4].forEach(function (n) {\n        vm.items.push({\n          id: 'panel' + n,\n          label: 'Item ' + n,\n          text: 'This is the text content for item #' + n\n        });\n      });\n\n      hotkeys.bindTo($scope)\n        .add({\n          combo: 'ctrl+\\\\',\n          description: 'Toggle Sidebar',\n          callback: function () {\n            vm.sidebarFocused = !vm.sidebarFocused;\n          }\n        })\n        .add({\n          combo: '/',\n          description: 'Search',\n          callback: function () {\n            vm.searchQuery = '';\n            if (vm.sidebarFocused) {\n              $timeout(function () {\n                // prevent key event from typing in field\n                angular.element('#searchQuery').focus();\n              });\n            } else {\n              $mdSidenav('left').toggle();\n            }\n          }\n        })\n        .add({\n          combo: 'n',\n          description: 'Create a new note panel',\n          callback: function () {\n            createNotePanel(100, 100);\n          }\n        });\n    }\n\n    function search(query) {\n      vm.loading = true;\n\n      // TODO delegate to registered external search/content providers\n\n      vm.peopleResults = peopleRepo.search(query);\n      vm.worksResults = worksRepo.search(query);\n\n      function tagAll(key, value) {\n        return function (arr) {\n          arr.forEach(function (obj) {\n            obj[key] = value;\n          });\n          return arr;\n        };\n      }\n\n      $q.all([\n        vm.peopleResults.$promise.then(_.property('items')).then(tagAll('type', 'person')),\n        vm.worksResults.$promise.then(_.property('items')).then(tagAll('type', 'work'))\n      ])\n        .then(function () {\n          vm.loading = false;\n        });\n    }\n\n    /**\n     * Drag callback for when a panel is moved\n     * @param {Event}  evt   DOM event\n     * @param {Object} ui    jQuery UI draggable callback data\n     * @param {Panel}  panel VWISE Panel instance being moved\n     */\n    function panelDragged(evt, ui, panel) {\n      panel.vprops.xPosition = ui.position.left;\n      panel.vprops.yPosition = Math.max(0, ui.position.top);\n    }\n\n    /**\n     * Drag callback for when a panel has been dropped after moving\n     * @param {Event} evt   DOM event\n     * @param {Object} ui    jQuery UI draggable callback data\n     * @param {Panel} panel VWISE Panel instance being moved\n     */\n    function savePanelPosition(evt, ui, panel) {\n      // TODO: jQuery UI supports 'containment' option...\n      var top = Math.max(0, ui.position.top);\n\n      $log.debug('saving panel position at', [ui.position.left, top]);\n\n      panel.setPosition(ui.position.left, top);\n      activatePanel(panel);\n    }\n\n    /**\n     * Drag callback for when a panel's resize handle is moved\n     * @param {Event}  evt   DOM event\n     * @param {Object} ui    jQuery UI draggable callback data\n     * @param {Panel}  panel VWISE Panel instance being resized\n     */\n    function resizePanel(evt, ui, panel) {\n      var width = ui.position.left + ui.helper.width();\n      var height = ui.position.top + ui.helper.height();\n\n      $scope.$apply(function () {\n        panel.vprops.width = Math.max(0, width);\n        panel.vprops.height = Math.max(0, height);\n      });\n    }\n\n    /**\n     * Drag callback for when a panel's resize handle has been dropped\n     * @param {Event}  evt   DOM event\n     * @param {Object} ui    jQuery UI draggable callback data\n     * @param {Panel}  panel VWISE Panel instance being resized\n     */\n    function savePanelSize(evt, ui, panel) {\n      var width = ui.position.left + ui.helper.width();\n      var height = ui.position.top + ui.helper.height();\n\n      $log.debug('saving panel size at', [width, height]);\n\n      $scope.$apply(function () {\n        panel.setSize(Math.max(0, width), Math.max(0, height));\n      })\n    }\n\n    /**\n     * Raises a panel to the top of the workspace stack\n     * @param {Panel} panel\n     * @param {Event} evt\n     */\n    function activatePanel(panel, evt) {\n      panel.activate();\n\n      if (evt && evt.stopPropagation) {\n        evt.stopPropagation();\n      }\n    }\n\n    /**\n     * Removes a panel from the workspace\n     * @param {Panel} panel\n     */\n    function closePanel(panel) {\n      panel.remove();\n    }\n\n    /**\n     * Drop callback for when something is droppen on the workspace content ariea\n     * @param  {Event}  evt DOM Event\n     * @param  {Object} ui  jQuery UI draggable callback data\n     */\n    function thingDropped(evt, ui) {\n      // get scope of object that was dropped\n      var itemScope = ui.draggable.scope();\n\n      // here's the data object of the panel we want to create\n      // scope variable is bound by ng-repeat on md-list in md-sidenav (see workspace.html)\n      var item = itemScope.item;\n\n      // if no item is available (e.g. if a panel was dropped)\n      if (!item) {\n        return;\n      }\n\n      var offsetX = angular.element('.md-sidenav-left').width();\n\n      var context = {\n        xPosition: ui.position.left - offsetX,\n        yPosition: ui.position.top\n      };\n\n      // who is capable of handling the dropped item\n      var contentMediators = panelContentMediatorRegistry.findContentMediators(item, context);\n      $log.debug('found ' + contentMediators.length + ' matching content mediator(s).');\n      var mediator = contentMediators.length > 0 ? contentMediators[0] : null;\n\n      if (!mediator) {\n        return;\n      }\n\n      var contentP = mediator.initPanelData(item, context);\n      var panelP = contentP.then(function (content) {\n        return vm.workspace.createPanel(mediator, content);\n      });\n\n      // set initial panel attributes\n      panelP.then(function (panel) {\n        $log.debug('created new panel');\n        panel.setPosition(context.xPosition, context.yPosition);\n        panel.setSize(600, 400);\n        panel.set('background', '#ffffff');\n      });\n    }\n\n    /**\n     * Creates a new note panel at the desired position\n     * @param {integer} x\n     * @param {integer} y\n     */\n    function createNotePanel(x, y) {\n      var note = {\n        note: ''\n      };\n\n      var context = {\n        xPosition: x,\n        yPosition: y\n      };\n\n      var contentMediators = panelContentMediatorRegistry.findContentMediators(note, context);\n      var mediator = contentMediators.length > 0 ? contentMediators[0] : null;\n      vm.workspace.createPanel(mediator, note).then(function (panel) {\n        panel.setPosition(context.xPosition, context.yPosition);\n      });\n    }\n\n    function workspaceClicked(evt) {\n      var offsetX = angular.element('.md-sidenav-left').width();\n\n      if (evt.ctrlKey) {\n        createNotePanel(evt.clientX - offsetX, evt.clientY);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock(panelContentMediatorRegistry, peopleContentMediator, worksContentMediator, editionsContentMediator, volumesContentMediator, googleBooksContentMediator, hathitrustContentMediator, internetArchiveContentMediator, noteContentMediator, passthruContentMediator) {\n    panelContentMediatorRegistry.register(peopleContentMediator);\n    panelContentMediatorRegistry.register(worksContentMediator);\n    panelContentMediatorRegistry.register(editionsContentMediator);\n    panelContentMediatorRegistry.register(volumesContentMediator);\n    panelContentMediatorRegistry.register(googleBooksContentMediator);\n    panelContentMediatorRegistry.register(hathitrustContentMediator);\n    panelContentMediatorRegistry.register(internetArchiveContentMediator);\n    panelContentMediatorRegistry.register(noteContentMediator);\n    panelContentMediatorRegistry.register(passthruContentMediator);\n  }\n\n})();\n\n/*global vwise:false*/\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .constant('vwise', vwise);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('vwise')\n    .config(config);\n\n  /** @ngInject */\n  function config(googleBooksApiProvider) {\n    googleBooksApiProvider.configure({ preventLoad: true });\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcWorks', [\n      'ngResource'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcWorks')\n    .provider('worksRepo', worksRepoProvider);\n\n  /**\n   * This functionality is already being implemented as a standalone trc-biblio module. The code is\n   * used here as an interim until the Bower build/dependency workflow has been finalized.\n   *\n   * @return {angular.provider}\n   */\n  function worksRepoProvider() {\n    var provider = {};\n    provider.url = '/api/works';\n    provider.$get = worksRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function worksRepoFactory($resource, _) {\n      var restResource = $resource(provider.url + '/:workId', { workId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var editionResource = $resource(provider.url + '/:workId/editions/:editionId', { editionId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var volumeResource = $resource(provider.url + '/:workId/editions/:editionId/volumes/:volumeId', { volumeId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var repo = {};\n      repo.getAll = findAll;\n      repo.search = search;\n      repo.get = getWork;\n      repo.getWork = getWork;\n      repo.getEdition = getEdition;\n      repo.getVolume = getVolume;\n      repo.create = createWork;\n      repo.createWork = createWork;\n      repo.createEdition = createEdition;\n      repo.createVolume = createVolume;\n      repo.save = save;\n      repo.saveWork = saveWork;\n      repo.saveEdition = saveEdition;\n      repo.saveVolume = saveVolume;\n      repo.delete = deleteWork;\n      repo.getTitle = getTitleByTypePreference;\n      return repo;\n\n      /**\n       * Retrieves a listing of all works\n       *\n       * @return {WorkProxy[]}\n       */\n      function findAll() {\n        return search('');\n      }\n\n      /**\n       * Search for works by query\n       *\n       * @return {SearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query, max: 50 });\n      }\n\n      /**\n       * Retrieves a work object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Work.$promise.\n       *\n       * @param {string} workId\n       * @return {Work}\n       */\n      function getWork(workId) {\n        if (angular.isUndefined(workId)) {\n          throw new TypeError('Invalid ID provided to getWork');\n        }\n\n        var work = restResource.get({ workId: workId });\n\n        work.$promise.then(adaptWork);\n\n        return work;\n      }\n\n      /**\n       * Retrieves an edition object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Edition.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @return {Edition}\n       */\n      function getEdition(workId, editionId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId)) {\n          throw new TypeError('Invalid IDs provided to getEdition');\n        }\n\n        var edition = editionResource.get({ workId: workId, editionId: editionId });\n\n        edition.$promise.then(adaptEdition);\n\n        return edition;\n      }\n\n      /**\n       * Retrieves a volume object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Volume.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @param {string} volumeId\n       * @return {Volume}\n       */\n      function getVolume(workId, editionId, volumeId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId) || angular.isUndefined(volumeId)) {\n          throw new TypeError('Invalid IDs provided to getVolume');\n        }\n\n        var volume = volumeResource.get({ workId: workId, editionId: editionId, volumeId: volumeId });\n\n        volume.$promise.then(adaptVolume);\n\n        return volume;\n      }\n\n      /**\n       * Creates a new work instance\n       *\n       * @return {Work}\n       */\n      function createWork() {\n        var work = new restResource();\n        adaptWork(work);\n        work.titles.push({});\n        work.authors.push({});\n        return work;\n      }\n\n      /**\n       * Creates a new edition instance\n       *\n       * @return {Edition}\n       */\n      function createEdition() {\n        var edition = new editionResource();\n        return adaptEdition(edition);\n      }\n\n      /**\n       * Creates a new volume instance\n       *\n       * @return {Volume}\n       */\n      function createVolume() {\n        var volume = new volumeResource();\n        return adaptVolume(volume);\n      }\n\n      /**\n       * Dispatch method for saving works, editions, and volumes\n       *\n       * @deprecated use saveWork, saveEdition, or saveVolume directly\n       * @return {Promise}\n       */\n      function save() {\n        switch (arguments.length) {\n          case 1: return saveWork.apply(null, arguments);\n          case 2: return saveEdition.apply(null, arguments);\n          case 3: return saveVolume.apply(null, arguments);\n        }\n        throw new TypeError('Unexpected arguments to worksRepo#save');\n      }\n\n      /**\n       * Saves a work instance back to the server\n       *\n       * @param {Work} work\n       * @return {Promise.<Work>}\n       */\n      function saveWork(work) {\n        if (!(work instanceof restResource)) {\n          throw new Error('work was not created by this repo');\n        }\n\n        // ngResource automatically updates the model to reflect any server changes (e.g. setting IDs for the work/edtions/volumes/copies).\n        return work.id\n          ? work.$update()\n          : work.$save();\n      }\n\n      /**\n       * Saves an edition instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {Edition} edition\n       * @return {Promise.<Edition>}\n       */\n      function saveEdition(workId, edition) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!(edition instanceof editionResource)) {\n          throw new Error('edition was not created by this repo');\n        }\n\n        return edition.id\n          ? edition.$update({ workId: workId })\n          : edition.$save({ workId: workId });\n      }\n\n      /**\n       * Saves a volume instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {string} editionId\n       * @param  {Volume} volume\n       * @return {Promise.<Volume>}\n       */\n      function saveVolume(workId, editionId, volume) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!editionId) {\n          throw new Error('no edition id provided');\n        }\n\n        if (!(volume instanceof volumeResource)) {\n          throw new Error('volume was not created by this repo');\n        }\n\n        return volume.id\n          ? volume.$update({ workId: workId, editionId: editionId })\n          : volume.$save({ workId: workId, editionId: editionId });\n      }\n\n      /**\n       * Deletes a work instance from the server\n       *\n       * @param  {string} id\n       */\n      function deleteWork(workId) {\n        var dataItem = restResource.delete({ id: workId });\n        return dataItem.$promise;\n      }\n\n      /**\n       * Ensure that aggregate fields common to all work/edition/volume entities exist and are formatted correctly\n       *\n       * @param  {Work|Edition|Volume} entity\n       * @return {Work|Edition|Volume}\n       */\n      function adaptCommon(entity) {\n        if (!entity.titles) {\n          entity.titles = [];\n        } else {\n          entity.titles.forEach(function (title) {\n            title.type = title.type.toLowerCase();\n          });\n        }\n\n        if (!entity.authors) {\n          entity.authors = [];\n        } else {\n          entity.authors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.otherAuthors) {\n          entity.otherAuthors = [];\n        } else {\n          entity.otherAuthors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.copies) {\n          entity.copies = [];\n        }\n\n        return entity;\n      }\n\n      /**\n       * Ensure that work aggregate fields exist and are formatted correctly\n       *\n       * @param  {Work} work\n       * @return {Work}\n       */\n      function adaptWork(work) {\n        adaptCommon(work);\n\n        if (!work.editions) {\n          work.editions = [];\n        } else {\n          work.editions.forEach(adaptEdition);\n        }\n\n        return work;\n      }\n\n      /**\n       * Ensure that edition aggregate fields exist and are formatted correctly\n       *\n       * @param  {Edition} edition\n       * @return {Edition}\n       */\n      function adaptEdition(edition) {\n        adaptCommon(edition);\n\n        if (!edition.volumes) {\n          edition.volumes = [];\n        } else {\n          edition.volumes.forEach(adaptVolume);\n        }\n\n        return edition;\n      }\n\n      /**\n       * Ensure that volume aggregate fields exist and are formatted correctly\n       *\n       * @param  {Volume} volume\n       * @return {Volume}\n       */\n      function adaptVolume(volume) {\n        adaptCommon(volume);\n\n        return volume;\n      }\n\n      /**\n       * Retrieves the first available title of the given type or falsey if no title can be found.\n       * If multiple types are given, returns the title corresponding to the first type for which a title is found.\n       *\n       * @param  {Title[]}         titles\n       * @param  {string|string[]} types\n       * @return {Title}\n       */\n      function getTitleByTypePreference(titles, types) {\n        if (angular.isUndefined(types)) {\n          types = ['short', 'canonical', 'bibliographic'];\n        } else if (!angular.isArray(types)) {\n          types = [types];\n        }\n\n        return types.reduce(function (found, type) {\n          return found || _.find(titles, { type: type });\n        }, null);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcReln', [\n      'ngResource'\n    ]);\n\n})();\n\n// NOTE: this entire API model *WILL* eventually change\n\n/**\n * @typedef Relationship\n * @type {object}\n * @property {string}     id                  - A unique identifier for this relationship\n * @property {string}     typeId              - The ID of the RelationshipType of this relationship\n * @property {string}     description         - A detailed description of this relationship\n * @property {string}     descriptionMimeType - MIME type string of the description\n * @property {Provenance} provenance          - Metadata about the relationship record\n * @property {Anchor[]}   relatedEntities     - A set of \"source\" anchors\n * @property {Anchor[]}   targetEntities      - A set of \"target\" anchors\n */\n\n/**\n * @typedef RelationshipType\n * @type {object}\n * @property {string}  identifier   - A unique identifier for this type\n * @property {string}  title        - A label to display for this type\n * @property {string}  reverseTitle - If this type is directed, the label to display for reverse relationships\n * @property {string}  description  - A more detailed description of this type\n * @property {boolean} isDirected   - Whether this type is directed (true) or undirected (false)\n */\n\n/**\n * @typedef Provenance\n * @type {object}\n * @property {string[]} creatorUris  - URIs to people/authors of this relationship\n * @property {string}   dateCreated  - an ISO 8601 date representation of when the record was created\n * @property {string}   dateModified - an ISO 8601 date representation of when the record was last modified\n */\n\n/**\n * @typedef Anchor\n * @type {object}\n * @property {string[]} entryUris[] - URIs to work/edition/volume\n */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcReln')\n    .provider('relationshipsRepo', relationshipsRepoProvider);\n\n  function relationshipsRepoProvider() {\n    var provider = {};\n    provider.url = '/api/relationships';\n    provider.$get = relationshipsRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function relationshipsRepoFactory($q, $resource) {\n      var typeResource = $resource(provider.url + '/types/:id', { id: '@identifier' });\n      var relnResource = $resource(provider.url + '/:id', { id: '@id' }, {\n        update: { method: 'PUT' }\n      });\n\n      var typesCache = null;\n\n      var repo = {};\n      repo.getTypes = getTypes;\n      repo.getType = getType;\n      repo.createRelationship = createRelationship;\n      repo.createProvenance = createProvenance;\n      repo.createAnchor = createAnchor;\n      repo.get = findById;\n      repo.search = search;\n      repo.save = saveRelationship;\n      repo.delete = deleteRelationship;\n      repo.normalizeRelationships = normalizeRelationships;\n      return repo;\n\n      /**\n       * Fetches relationship types from the server, caching them in the process.\n       * The returned array will be populated when the request resolves.\n       * The underlying promise is available on the $promise property.\n       *\n       * @param  {object} options\n       * @param  {boolean} options.force Discard cache (if set) and refetch\n       * @return {object.<string,RelationshipType>}\n       */\n      function getTypes(options) {\n        options = options || {};\n\n        if (!typesCache || options.force) {\n          var types = typeResource.query();\n\n          typesCache = {};\n\n          var tcPromise = types.$promise.then(function () {\n            types.forEach(function (type) {\n              typesCache[type.identifier] = type;\n            });\n            return typesCache;\n          });\n\n          // add $promise as a non-enumerable property\n          Object.defineProperty(typesCache, '$promise', {\n            value: tcPromise\n          });\n        }\n\n        return typesCache;\n      }\n\n      /**\n       * Fetches a type by ID\n       *\n       * @param  {string} id\n       * @return {Promise.<RelationshipType>}\n       */\n      function getType(id) {\n        var types = getTypes();\n\n        return types.$promise.then(function (types) {\n          return types[id];\n        });\n      }\n\n      /**\n       * Creates a new empty relationship instance\n       *\n       * @return {Relationship}\n       */\n      function createRelationship() {\n        var reln = new relnResource();\n        return adaptRelationship(reln);\n      }\n\n      /**\n       * Creates a new empty provenance model\n       *\n       * @return {Provenance}\n       */\n      function createProvenance() {\n        var provenance = {};\n        return adaptProvenance(provenance);\n      }\n\n      /**\n       * Creates a new empty anchor model\n       *\n       * @return {Anchor}\n       */\n      function createAnchor() {\n        var anchor = {};\n        return adaptAnchor(anchor);\n      }\n\n      /**\n       * Retrieves a relationship from the server by ID.\n       * The returned model will be populated once the request succeeds.\n       * The underlying promise can be accessed via the $promise property.\n       *\n       * @param  {string} id\n       * @return {Relationship}\n       */\n      function findById(id) {\n        return relnResource.get({ id: id });\n      }\n\n      /**\n       * Find all relationships matching the given criteria.\n       * @param  {object|string} options\n       * @property {string} options.uri (default if options is a string)\n       * @property {string} options.typeId\n       * @property {string} options.direction \"from\" (out-relationships), \"to\" (in-relationships), or \"any\"\n       * @property {integer} options.start\n       * @property {integer} options.max\n       * @return {Relationship[]}\n       */\n      function search(options) {\n        if (!options) {\n          throw new Error('no options provided')\n        }\n\n        if (angular.isString(options)) {\n          // treat single string as an entity URL\n          options = { uri: options };\n        }\n\n        var queryOpts = {};\n\n        if (options.uri) {\n          queryOpts.entity = options.uri;\n        }\n\n        if (options.typeId) {\n          queryOpts.type = options.typeId;\n        }\n\n        if (options.direction) {\n          queryOpts.direction = options.direction;\n        }\n\n        if (options.start) {\n          queryOpts.off = options.start;\n        }\n\n        if (options.max) {\n          queryOpts.max = options.max;\n        }\n\n        return relnResource.query(queryOpts);\n      }\n\n      /**\n       * Saves a relationship back to the server.\n       *\n       * @param  {Relationship} reln\n       * @return {Promise} resolves on successful save\n       */\n      function saveRelationship(reln) {\n        if (!(reln instanceof relnResource)) {\n          throw new Error('Relationship was not created by this repo');\n        }\n\n        return reln.id\n          ? reln.$update()\n          : reln.$save();\n      }\n\n      /**\n       * Deletes a relationship from the server via the REST API.\n       *\n       * @param  {string} id\n       * @return {Promise} resolves on success\n       */\n      function deleteRelationship(id) {\n        var response = relnResource.delete({ id: id });\n        return response.$promise\n      }\n\n      /**\n       * Ensures aggregate fields on a relationship are set appropriately\n       *\n       * @param  {Relationship} reln\n       * @return {Relationship}\n       */\n      function adaptRelationship(reln) {\n        if (!reln.provenance) {\n          reln.provenance = createProvenance();\n        }\n\n        if (!reln.relatedEntities) {\n          reln.relatedEntities = [];\n        }\n\n        if (!reln.targetEntities) {\n          reln.targetEntities = [];\n        }\n\n        return reln;\n      }\n\n      /**\n       * Ensures aggregate fields on a provenance model are set appropriately\n       *\n       * @param  {Provenance} provenance\n       * @return {Provenance}\n       */\n      function adaptProvenance(provenance) {\n        if (!provenance.creatorUris) {\n          provenance.creatorUris = [];\n        }\n\n        return provenance;\n      }\n\n      /**\n       * Ensures aggregate fields on an anchor model are set appropriately\n       *\n       * @param  {Anchor} anchor\n       * @return {Anchor}\n       */\n      function adaptAnchor(anchor) {\n        if (!anchor.entryUris) {\n          anchor.entryUris = [];\n        }\n\n        return anchor;\n      }\n\n      /**\n       * Normalizes relationships into type groups that are more suitable for display in the UI\n       *\n       * @param  {Relationship[]} relationships\n       * @return {TypeGroup[]}\n       */\n      function normalizeRelationships(relationships, currentUri, worksRepo) {\n        var normalizedRelationships = relationships.map(function (relationship) {\n          var typeId = relationship.typeId;\n\n          var isReverse = relationship.targetEntities.some(function (anchor) {\n            return anchor.entryUris.some(function (uri) {\n              return uri === currentUri;\n            });\n          });\n\n          var targetField = isReverse ? 'relatedEntities' : 'targetEntities';\n\n          var entities = relationship[targetField]\n          .map(function (anchor) {\n            return anchor.entryUris;\n          })\n          .reduce(function (flattened, arr) {\n            return flattened.concat(arr);\n          }, [])\n          .map(function (uri) {\n            return resolveEntityUri(uri, worksRepo);\n          });\n\n          return {\n            id: relationship.id,\n            typeId: typeId,\n            reverse: isReverse,\n            description: relationship.description,\n            entities: entities\n          };\n        });\n\n        var relnsByTypeDir = {};\n\n        normalizedRelationships.forEach(function (relationship) {\n          var typeId = relationship.typeId;\n\n          if (!relnsByTypeDir.hasOwnProperty(typeId)) {\n            relnsByTypeDir[typeId] = {\n              fwd: [],\n              rev: []\n            };\n          }\n\n          relnsByTypeDir[typeId][relationship.reverse ? 'rev' : 'fwd'].push(relationship);\n        });\n\n        var typeGroups = [];\n\n        angular.forEach(relnsByTypeDir, function (dirs, typeId) {\n          getType(typeId).then(function (type) {\n            if (type.isDirected) {\n              // add forward group\n              if (dirs.fwd.length > 0) {\n                typeGroups.push({\n                  label: type.title,\n                  relationships: dirs.fwd\n                });\n              }\n\n              // add reverse group\n              if (dirs.rev.length > 0) {\n                typeGroups.push({\n                  label: type.reverseTitle,\n                  relationships: dirs.rev\n                });\n              }\n            } else {\n              // combine forward/reverse and add as a single group\n              var group = dirs.fwd.concat(dirs.rev);\n              if (group.length > 0) {\n                typeGroups.push({\n                  label: type.title,\n                  relationships: group\n                });\n              }\n            }\n          });\n        });\n\n        return typeGroups;\n      }\n\n      function resolveEntityUri(uri, worksRepo) {\n        var ENTITY_URI = /^works\\/([^\\/]+)(?:\\/editions\\/([^\\/]+)(?:\\/volumes\\/([^\\/]+))?)?$/i;\n        var match = ENTITY_URI.exec(uri);\n\n        if (!match) {\n          return null;\n        }\n\n        if (match[1] && match[2] && match[3]) {\n          return makeVolumeEntity(match[1], match[2], match[3], worksRepo);\n        } else if (match[1] && match[2]) {\n          return makeEditionEntity(match[1], match[2], worksRepo);\n        } else if (match[1]) {\n          return makeWorkEntity(match[1], worksRepo);\n        }\n\n        return null;\n      }\n    }\n\n    function makeVolumeEntity(workId, editionId, volumeId, worksRepo) {\n      var edition = worksRepo.getEdition(workId, editionId);\n      var volume = worksRepo.getVolume(workId, editionId, volumeId);\n\n      var entity = {\n        type: 'volume',\n        refParams: {\n          workId: workId,\n          editionId: editionId,\n          volumeId: volumeId\n        },\n        entity: volume\n      };\n\n      volume.$promise.then(function () {\n        var title = worksRepo.getTitle(volume.titles, ['short', 'canonical', 'bibliographic']);\n        if (title) {\n          entity.label = title.title + (title.subtitle ? ': ' + title.subtitle : '');\n        }\n\n        edition.$promise.then(function () {\n          entity.label += ' ' + edition.editionName + ' Volume ' + volume.volumeNumber;\n        }, function () {\n          entity.label += ' [Unknown edition] ' + volume.volumeNumber;\n        });\n      });\n\n      return entity;\n    }\n\n    function makeEditionEntity(workId, editionId, worksRepo) {\n      var edition = worksRepo.getEdition(workId, editionId);\n\n      var entity = {\n        type: 'edition',\n        refParams: {\n          workId: workId,\n          editionId: editionId\n        },\n        entity: edition\n      };\n\n      edition.$promise.then(function () {\n        var title = worksRepo.getTitle(edition.titles, ['short', 'canonical', 'bibliographic']);\n        if (title) {\n          entity.label = title.title + (title.subtitle ? ': ' + title.subtitle : '') + ' ' + edition.editionName;\n        }\n      });\n\n      return entity;\n    }\n\n    function makeWorkEntity(workId, worksRepo) {\n      var work = worksRepo.getWork(workId);\n\n      var entity = {\n        type: 'work',\n        refParams: {\n          workId: workId\n        },\n        entity: work\n      };\n\n      work.$promise.then(function () {\n        var title = worksRepo.getTitle(work.titles, ['short', 'canonical', 'bibliographic']);\n        if (title) {\n          entity.label = title.title + (title.subtitle ? ': ' + title.subtitle : '');\n        }\n      });\n\n      return entity;\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio', [\n      'ngResource'\n    ]);\n\n})();\n\n/**\n * Data model representing a person returned by the TRC REST API\n * @typedef Person\n * @type {object}\n * @property {string}           id       - a unique identifier for this person; assigned upon creation\n * @property {EntryMeta}        meta     - metadata about the record and its history in the system\n * @property {PersonName}       name     - primary name used to identify this person\n * @property {PersonName[]}     altNames - other names by which this person is known\n * @property {?HistoricalEvent} birth    - the date and location this person was born; may be null if unknown\n * @property {?HistoricalEvent} death    - the date and location this person was born; may be null if unknown or still alive\n * @property {string}           summary  - an HTML summary of the person and his or her significance\n */\n\n/**\n * Simplified, lightweight representation of a person for use in search results\n * @typedef Person\n * @type {object}\n * @property {string}     id             - a unique identifier for the person\n * @property {EntryMeta}  meta           - metadata about the record and its history in the system\n * @property {PersonName} name           - structured name representation\n * @property {string}     label          - formatted name to display\n * @property {string}     summaryExcerpt - a leading excerpt from the full summary\n */\n\n/**\n * Metadata about a TRC entry\n * @typedef EntryMeta\n * @type {object}\n * @property {string}                      slug         - a short, unique identifier intended to be more human-readable than the id\n * @property {integer}                     version      - a monotonically increasing version number incremented on each change\n * @property {object.<string, SimpleLink>} links        - links to related resources; keyed by link role\n * @property {string}                      lastModified - ISO 8601 timestamp of the last modification date\n */\n\n/**\n * Container for linking to related entities\n * @typedef SimpleLink\n * @type {object}\n * @property {string} uri  - a URI representing the linked item\n * @property {string} type - MIME type of the related linked item\n */\n\n/**\n * Structured form of a person's name\n * @typedef PersonName\n * @type {object}\n * @property {string} role        - clarifies the use of this name\n * @property {string} label       - a simple representation of this name for display purposes\n * @property {?string} title      - title of address\n * @property {?string} givenName  - given or first name\n * @property {?string} middleName - middle name\n * @property {?string} familyName - family or last name\n * @property {?string} suffix     - a suffix (e.g. 'Jr' or 'III')\n */\n\n/**\n * Event with a date/time, location, and descriptive information\n * @typedef HistoricalEvent\n * @type {object}\n * @property {string}          id          - a unique identifier for this event\n * @property {string}          title       - a brief title of the event for display purposes\n * @property {string}          description - a detailed summary of the event\n * @property {string}          location    - the location in which the event took place\n * @property {DateDescription} date        - the date the event took place\n */\n\n/**\n * Container for encapsulating human-readable and machine-readable forms of a date.\n * @typedef DateDescription\n * @type {object}\n * @property {string} calendar    - machine-readable ISO 8601 timestamp\n * @property {string} description - human-readable description of this date\n */\n\n/**\n * Container for search results\n * @typedef PersonSearchResultSet\n * @type {object}\n * @property {SimplePerson[]} items  - search results\n * @property {string}         qs     - query string that gives the current set of search results\n * @property {?string}        qsNext - query string that gives next set of search results or null if this is the last set\n * @property {?string}        qsPrev - query string that gives preceding set of search results or null if this is the first set\n */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .provider('peopleRepo', peopleRepoProvider);\n\n\n  function peopleRepoProvider() {\n    var provider = {};\n    provider.url = '/api/people';\n    provider.$get = peopleRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function peopleRepoFactory($q, $resource) {\n      var restResource = $resource(provider.url + '/:id', null, {\n        'update': { method: 'PUT' }\n      });\n\n      var repo = {};\n      repo.create = createPerson;\n      repo.createName = createName;\n      repo.createEvent = createEvent;\n      repo.get = findById;\n      repo.search = search;\n      repo.save = savePerson;\n      repo.delete = deletePerson;\n      return repo;\n\n      /**\n       * Creates a new empty person instance.\n       *\n       * @return {Person}\n       */\n      function createPerson() {\n        var person = new restResource();\n        return adaptPerson(person);\n      }\n\n      /**\n       * Creates a new empty entry metadata instance\n       *\n       * @return {EntryMeta}\n       */\n      function createMeta() {\n        var meta = {};\n        return adaptMeta(meta);\n      }\n\n      /**\n       * Creates a new empty name instance\n       *\n       * @return {PersonName}\n       */\n      function createName() {\n        var name = {};\n        return adaptName(name);\n      }\n\n      /**\n       * Creates a new historical event instance\n       *\n       * @return {HistoricalEvent}\n       */\n      function createEvent() {\n        var evt = {};\n        return adaptEvent(evt);\n      }\n\n      /**\n       * Creates a date/description instance\n       *\n       * @return {DateDescription}\n       */\n      function createDateDescription() {\n        var dateDescription = {};\n        return dateDescription;\n      }\n\n      /**\n       * Retrieves a person object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promise is available on Person.$promise.\n       *\n       * @param  {string} id\n       * @return {Person}\n       */\n      function findById(id) {\n        return restResource.get({ id: id });\n      }\n\n      /**\n       * Retrieves a serch result set of people who match the given query.\n       *\n       * @param {string} query\n       * @return {PersonSearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query });\n      }\n\n      /**\n       * Saves a person model to the REST API.\n       *\n       * If no ID is provided on the person model, the API will create save the model as a new\n       * person. Otherwise, the API will attempt to update the existing person model with that ID.\n       *\n       * @param {Person} person\n       * @return {Promise.<Person>} - resolves to the saved person on success\n       */\n      function savePerson(person) {\n        var response;\n        if (person.id) {\n          response = restResource.update({ id: person.id }, person);\n        } else {\n          response = restResource.save(null, person);\n        }\n\n        return response.$promise.then(function (personId) {\n          person.id = personId.id;\n          return person;\n        });\n      }\n\n      /**\n       * Deletes a person on the server via the REST API.\n       *\n       * @param {Person|string} idOrPerson\n       * @return {Promise} - resolves on success\n       */\n      function deletePerson(id) {\n        var response = restResource.delete({ id: id });\n        return response.$promise;\n      }\n\n      /**\n       * Populates a person with aggregate fields\n       *\n       * @param  {Person} person\n       * @return {Person}\n       */\n      function adaptPerson(person) {\n        if (!person.meta) {\n          person.meta = createMeta();\n        } else {\n          adaptMeta(person.meta);\n        }\n\n        if (!person.name) {\n          person.name = createName();\n        } else {\n          adaptName(person.name);\n        }\n\n        if (!person.altNames) {\n          person.altNames = [];\n        } else {\n          person.altNames.forEach(adaptName);\n        }\n\n        if (!person.birth) {\n          person.birth = createEvent();\n        } else {\n          adaptEvent(person.birth);\n        }\n\n        if (!person.death) {\n          person.death = createEvent();\n        } else {\n          adaptEvent(person.death);\n        }\n\n        return person\n      }\n\n      /**\n       * Ensure that entry metadata aggregate fields exist and are formatted correctly.\n       *\n       * @param  {EntryMeta} meta\n       * @return {EntryMeta}\n       */\n      function adaptMeta(meta) {\n        if (!meta.links) {\n          meta.links = {};\n        }\n\n        return meta;\n      }\n\n      /**\n       * Ensure that name aggregate fields exist and are formatted correctly\n       * @param  {PersonName} name\n       * @return {PersonName}\n       */\n      function adaptName(name) {\n        // no aggregate fields yet...\n        return name;\n      }\n\n      /**\n       * Ensure that event aggregate fields exist and are formatted correctly.\n       *\n       * @param  {HistoricalEvent} evt\n       * @return {HistoricalEvent}\n       */\n      function adaptEvent(evt) {\n        if (!evt.date) {\n          evt.date = createDateDescription();\n        }\n\n        return evt;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcPersonEditor', trcPersonEditorDirective);\n\n  /** @ngInject */\n  function trcPersonEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/person-editor.html',\n      scope: {\n        person: '=ngModel'\n      },\n      controller: PersonEditorController,\n      controllerAs: 'personEditor'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function PersonEditorController($scope, peopleRepo) {\n      var vm = this;\n\n      vm.addName = addName;\n      vm.removeName = removeName;\n      vm.addEvent = addEvent;\n      vm.removeEvent = removeEvent;\n\n      /**\n       * Adds a name to the current person model.\n       */\n      function addName() {\n        var newName = peopleRepo.createName();\n        $scope.person.altNames.push(newName);\n      }\n\n      /**\n       * Removes the name at the specified index from the current person model.\n       *\n       * @param {integer} ix\n       */\n      function removeName(ix) {\n        $scope.person.altNames.splice(ix, 1);\n      }\n\n      /**\n       * Adds an event to the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function addEvent(key) {\n        var newEvent = peopleRepo.createEvent();\n        $scope.person[key] = newEvent;\n      }\n\n      /**\n       * Removes the event from the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function removeEvent(key) {\n        $scope.person[key] = null;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcNameEditor', trcNameEditorDirective);\n\n  /** @ngInject */\n  function trcNameEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/name-editor.html',\n      scope: {\n        name: '=ngModel'\n      },\n      controller: NameEditorController,\n      controllerAs: 'nameEditor'\n    };\n\n    return directive;\n\n    function NameEditorController() {\n      var vm = this;\n\n      vm.roles = [\n        { value: 'canonical', label: 'Canonical Name' },\n        { value: 'pseudonym', label: 'Pseudonym' },\n        { value: 'maiden', label: 'Maiden Name' },\n        { value: 'designation', label: 'Honorary Designation' },\n        { value: 'nickname', label: 'Nickname' },\n        { value: 'phonetic', label: 'Phonetic Name' }\n      ];\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcEventEditor', trcEventEditorDirective);\n\n  /** @ngInject */\n  function trcEventEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/event-editor.html',\n      scope: {\n        event: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n   'use strict';\n\n   angular\n      .module('google.books', []);\n\n})();\n\n/**\n * Inspired by https://github.com/angular-ui/angular-google-maps/blob/f7c17e4336344afe9c31ca8b8a1e200e268f4979/src/coffee/providers/map-loader.coffee\n */\n(function () {\n   'use strict';\n\n   angular\n      .module('google.books')\n      .provider('googleBooksApi', googleBooksApiProvider);\n\n   function googleBooksApiProvider() {\n      var API = {};\n\n      API.options = {\n         transport: 'https',\n         v: 0,\n         language: 'en',\n         preventLoad: false\n      };\n\n      API.configure = configure;\n      API.$get = loadGoogleBooks;\n\n      return API;\n\n      function configure(options) {\n         angular.extend(API.options, options);\n      }\n\n      /** @ngInject */\n      function loadGoogleBooks(googleBooksScriptLoader) {\n         return googleBooksScriptLoader.load(API.options);\n      }\n   }\n\n})();\n\n/**\n * Inspired by https://github.com/angular-ui/angular-google-maps/blob/f7c17e4336344afe9c31ca8b8a1e200e268f4979/src/coffee/providers/map-loader.coffee\n */\n(function () {\n   'use strict';\n\n   angular\n      .module('google.books')\n      .factory('googleBooksScriptLoader', googleBooksScriptLoader);\n\n   /** @ngInject */\n   function googleBooksScriptLoader($window, $document, $q, _) {\n      var scriptId = undefined;\n      var usedConfiguration = undefined;\n\n      return {\n         load: load,\n         manualLoad: manualLoad\n      };\n\n      /**\n       * Get script URL for loading Google Books API\n       *\n       * @param {object} options\n       * @return {string}\n       */\n      function getScriptUrl(options) {\n         if (options.transport === 'auto') {\n            return '//www.google.com/books/api.js?';\n         } else {\n            return options.transport + '://www.google.com/books/api.js?';\n         }\n      }\n\n      function includeScript(options) {\n         var omitOptions = ['transport', 'preventLoad', 'randomizedFunctionName'];\n\n         var query = _.map(_.omit(options, omitOptions), function (v, k) { return k + '=' + v });\n\n         if (scriptId) {\n            var scriptElem = $document.getElementById(scriptId)\n            scriptElem.parentNode.removeChild(scriptElem);\n         } else {\n            scriptId = 'gbooks_load_' + Math.round(Math.random() * 1000);\n         }\n\n         query = query.join('&');\n         angular.element('<script>', {\n            id: scriptId,\n            type: 'text/javascript',\n            src: getScriptUrl(options) + query\n         }).appendTo(angular.element('body'));\n      }\n\n      function isGoogleBooksLoaded() {\n         return angular.isDefined($window.google) && angular.isDefined($window.google.books);\n      }\n\n      function load(options) {\n         var deferred = $q.defer();\n\n         if (isGoogleBooksLoaded()) {\n            deferred.resolve($window.google.books);\n            return deferred.promise;\n         }\n\n         var randomizedFunctionName = 'onGoogleBooksReady' + Math.round(Math.random() * 1000);\n         options.callback = randomizedFunctionName;\n\n         $window[randomizedFunctionName] = function () {\n            $window[randomizedFunctionName] = null;\n            deferred.resolve($window.google.books);\n         }\n\n         if (!options.preventLoad) {\n            includeScript(options);\n         }\n\n         usedConfiguration = options;\n         usedConfiguration.randomizedFunctionName = randomizedFunctionName;\n\n         return deferred.promise;\n      }\n\n      function manualLoad() {\n         var config = usedConfiguration;\n\n         if (!isGoogleBooksLoaded()) {\n            includeScript(config);\n         } else if ($window[config.randomizedFunctionName]) {\n            $window[config.randomizedFunctionName]();\n         }\n      }\n   }\n\n})();\n\n/**\n * Inspired by https://github.com/angular-ui/angular-google-maps/blob/f7c17e4336344afe9c31ca8b8a1e200e268f4979/src/coffee/providers/map-loader.coffee\n */\n(function () {\n   'use strict';\n\n   angular\n      .module('google.books')\n      .directive('googleBookReader', googleBookReader);\n\n   /** @ngInject */\n   function googleBookReader(googleBooksApi, googleBooksApiManualLoader) {\n      var directive = {\n         restrict: 'E',\n         link: linkFunc,\n         scope: {\n            properties: '='\n         }\n      };\n\n      return directive;\n\n      function linkFunc(scope, el) {\n         googleBooksApiManualLoader.load();\n         googleBooksApi.then(function (books) {\n            var viewer = new books.DefaultViewer(el.get(0));\n\n            scope.$watch('properties', function (properties) {\n               viewer.load(properties.id);\n            });\n\n            scope.$on('resize', function () {\n               viewer.resize();\n            });\n         });\n      }\n   }\n\n})();\n\n/**\n * Inspired by https://github.com/angular-ui/angular-google-maps/blob/f7c17e4336344afe9c31ca8b8a1e200e268f4979/src/coffee/providers/map-loader.coffee\n */\n(function () {\n   'use strict';\n\n   angular\n      .module('google.books')\n      .service('googleBooksApiManualLoader', googleBooksApiManualLoader);\n\n   /** @ngInject */\n   function googleBooksApiManualLoader(googleBooksScriptLoader) {\n      var API = {};\n\n      API.load = load;\n\n      return API;\n\n      function load() {\n         googleBooksScriptLoader.manualLoad();\n      }\n   }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb', [\n      'ngAnimate',\n      'ngCookies',\n      'ngSanitize',\n      'ngMessages',\n      'ngAria',\n      'ngResource',\n      'ui.router',\n      'ngMaterial',\n      'trcBio',\n      'trcReln',\n      'trcWorks',\n      'vwise'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log) {\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('vwise', {\n        url: '/',\n        templateUrl: 'app/vwise/workspace.html',\n        controller: 'WorkspaceController',\n        controllerAs: 'vm'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global _:false, moment:false */\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .constant('_', _)\n    .constant('moment', moment);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, /* toastrConfig, */ $mdThemingProvider, worksRepoProvider, peopleRepoProvider, relationshipsRepoProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    $mdThemingProvider.definePalette('darkBrown', {\n      '50': '#595c59',\n      '100': '#4c4f4c',\n      '200': '#404240',\n      '300': '#333533',\n      '400': '#272827',\n      '500': '#1a1b1a',\n      '600': '#0d0e0d',\n      '700': '#010101',\n      '800': '#000000',\n      '900': '#000000',\n      'A100': '#e0f0e0',\n      'A200': '#565956',\n      'A400': '#7e837e',\n      'A700': '#000000',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['A100']\n    });\n\n    $mdThemingProvider.definePalette('copper', {\n      '50': '#d4b190',\n      '100': '#cca47e',\n      '200': '#c5976b',\n      '300': '#be8a59',\n      '400': '#b67e47',\n      '500': '#a47140',\n      '600': '#926439',\n      '700': '#7f5832',\n      '800': '#6d4b2b',\n      '900': '#5b3e23',\n      'A100': '#dcc3ab',\n      'A200': '#a47140',\n      'A400': '#48321c',\n      'A700': '#272927',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['50', '100', '200', 'A100']\n    });\n\n    $mdThemingProvider.theme('default')\n      .primaryPalette('darkBrown')\n      .accentPalette('copper');\n\n\n    worksRepoProvider.url = '/api/catalog/works';\n    peopleRepoProvider.url = '/api/catalog/people';\n    relationshipsRepoProvider.url = '/api/catalog/relationships';\n  }\n\n})();\n\nangular.module(\"sdaAdminWeb\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/trc-bio/event-editor.html\",\"<div class=form-group><label class=control-label for=event-title>Title</label><input type=text id=event-title name=event-title class=\\\"form-control event-title\\\" ng-model=event.title></div><div class=form-group><label class=control-label for=event-description>Description</label><textarea id=event-description name=event-description class=\\\"form-control event-description\\\" ng-model=event.description></textarea></div><div class=form-group><label class=control-label for=event-location>Location</label><input type=text id=event-location name=event-location class=\\\"form-control event-location\\\" ng-model=event.location></div><div class=form-group><label class=control-label for=event-date>Date</label><input type=text id=event-date name=event-date class=\\\"form-control event-date\\\" ng-model=event.date.description><!-- TODO add datepicker --></div>\");\n$templateCache.put(\"app/trc-bio/name-editor.html\",\"<div class=form-group class=name-role><label class=control-label for=name-role>Role</label><select id=name-role name=name-role class=\\\"form-control name-role\\\" ng-model=name.role><option ng-repeat=\\\"role in nameEditor.roles\\\" value={{role.value}}>{{role.label}}</option></select></div><div class=form-group class=name-structure><label class=control-label>Structured Name</label><input type=text class=name-title placeholder=title ng-model=name.title> <input type=text class=name-given placeholder=given ng-model=name.givenName> <input type=text class=name-middle placeholder=middle ng-model=name.middleName> <input type=text class=name-family placeholder=family ng-model=name.familyName> <input type=text class=name-suffix placeholder=suffix ng-model=name.suffix></div><div class=form-group class=name-label><label for=label>Display Label</label><input type=text placeholder=label ng-model=name.label></div>\");\n$templateCache.put(\"app/trc-bio/person-editor.html\",\"<div class=form-group><label for=person-name>Primary Name</label><trc-name-editor id=person-name ng-model=person.name></trc-name-editor></div><div class=form-group><label for=person-altnames>Alternate Names</label><div ng-repeat=\\\"name in person.altNames\\\"><trc-name-editor id=person-altnames ng-model=name></trc-name-editor><button ng-click=personEditor.removeName($index)>&minus;</button></div><button ng-click=personEditor.addName()>+</button></div><div class=form-group><label for=person-birth>Birth</label><div ng-if=person.birth><trc-event-editor id=person-birth ng-model=person.birth></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'birth\\')\\\">&minus;</button></div><div ng-if=!person.birth><button ng-click=\\\"personEditor.addEvent(\\'birth\\')\\\">+</button></div></div><div class=form-group><label for=person-death>Death</label><div ng-if=person.death><trc-event-editor id=person-death ng-model=person.death></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'death\\')\\\">&minus;</button></div><div ng-if=!person.death><button ng-click=\\\"personEditor.addEvent(\\'death\\')\\\">+</button></div></div><div class=form-group><label class=control-label for=person-summary>Summary</label><textarea id=person-summary name=person-summary class=\\\"form-control person-summary\\\" ng-model=person.summary></textarea></div>\");\n$templateCache.put(\"app/vwise/workspace.html\",\"<div layout=row flex><md-sidenav md-component-id=left class=md-sidenav-left layout=column md-is-locked-open=vm.sidebarFocused><form layout=row flex=none><md-input-container flex><label for=searchQuery>Search</label><md-icon>search</md-icon><input type=search name=searchQuery id=searchQuery ng-model=vm.searchQuery ng-change=vm.search(vm.searchQuery) required md-sidenav-focus></md-input-container></form><md-content flex><div ng-if=vm.loading layout=row layout-align=center><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if=\\\"!vm.loading &amp;&amp; vm.peopleResults &amp;&amp; vm.peopleResults.items.length > 0\\\"><md-subheader>People</md-subheader><md-list><md-list-item ng-repeat=\\\"item in vm.peopleResults.items\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text><span>{{item.label}}</span></div></md-list-item></md-list></div><div ng-if=\\\"!vm.loading &amp;&amp; vm.worksResults &amp;&amp; vm.worksResults.items.length > 0\\\"><md-subheader>Works</md-subheader><md-list><md-list-item ng-repeat=\\\"item in vm.worksResults.items\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text><span>{{item.label}}</span></div></md-list-item></md-list></div></md-content></md-sidenav><div flex jqyoui-droppable=\\\"{stack: true, onDrop:\\'vm.thingDropped()\\'}\\\" data-drop=true class=workspace ng-click=vm.workspaceClicked($event)><div ng-repeat=\\\"panel in vm.workspace.panelStack track by panel.id\\\" class=panel ng-style={left:panel.vprops.xPosition,top:panel.vprops.yPosition,width:panel.vprops.width,height:panel.vprops.height,background:panel.vprops.background,color:panel.vprops.foreground} jqyoui-draggable=\\\"{onDrag:\\'vm.panelDragged(panel)\\',onStop:\\'vm.savePanelPosition(panel)\\'}\\\" ng-click=\\\"vm.activatePanel(panel, $event)\\\" data-jqyoui-options=\\\"{handle:\\'.drag-handle\\'}\\\" data-drag=true vwise-panel=panel layout=column></div></div></div>\");\n$templateCache.put(\"app/vwise/components/panel/panel.html\",\"<div class=drag-handle ng-style=\\\"{background: panel.vprops.background}\\\" layout=row><span flex></span> <input type=color ng-model=panel.vprops.background> <button class=close ng-click=vm.closePanel(panel)>&times;</button></div><div class=content flex layout=column></div><div class=resize-handle jqyoui-draggable=\\\"{onDrag:\\'vm.resizePanel(panel)\\',onStop:\\'vm.savePanelSize(panel)\\'}\\\" data-drag=true></div>\");\n$templateCache.put(\"app/vwise/components/person-panel/person-panel.html\",\"<div class=panel-person flex layout=column><h1><span class=name>{{name}}</span></h1><md-tabs flex><md-tab ng-if=person.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=person.summary></div></md-tab-body></md-tab></md-tabs></div>\");\n$templateCache.put(\"app/vwise/components/work-panel/edition-panel.html\",\"<div class=panel-edition flex layout=column><h1><span class=authors><span class=author ng-repeat=\\\"author in edition.authors\\\">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span> <span class=edition-name>{{edition.editionName}}.</span></h1><md-tabs flex><md-tab ng-if=edition.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=edition.summary></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body>Coming soon...</md-tab-body></md-tab><md-tab ng-if=\\\"edition.volumes.length > 0\\\"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat=\\\"item in edition.volumes\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text>Volume {{item.volumeNumber}} ({{item.publicationInfo.date.description}})</div></md-list-item></md-list></md-tab-body></md-tab><md-tab ng-if=\\\"edition.copies.length > 0\\\"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat=\\\"item in edition.copies\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>\");\n$templateCache.put(\"app/vwise/components/work-panel/volume-panel.html\",\"<div class=panel-volume flex layout=column><h1><span class=authors><span class=author ng-repeat=\\\"author in volume.authors\\\">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span> <span class=edition-name>{{edition.editionName}}.</span> <span class=volume-name>Volume {{volume.volumeNumber}}.</span></h1><md-tabs flex><md-tab ng-if=volume.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=volume.summary></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body>Coming soon...</md-tab-body></md-tab><md-tab ng-if=\\\"volume.copies.length > 0\\\"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat=\\\"item in volume.copies\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>\");\n$templateCache.put(\"app/vwise/components/work-panel/work-panel.html\",\"<div class=panel-work flex layout=column><h1><span class=authors><span class=author ng-repeat=\\\"author in work.authors\\\">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span></h1><md-tabs flex><md-tab ng-if=work.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=work.summary></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body>Coming soon...</md-tab-body></md-tab><md-tab ng-if=\\\"work.editions.length > 0\\\"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat=\\\"item in work.editions\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text>{{item.editionName}} ({{item.publicationInfo.date.description}})</div></md-list-item></md-list></md-tab-body></md-tab><md-tab ng-if=\\\"work.copies.length > 0\\\"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat=\\\"item in work.copies\\\" jqyoui-draggable={animate:false} data-jqyoui-options=\\\"{revert:\\'invalid\\',helper:\\'clone\\',appendTo:\\'body\\'}\\\" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>\");}]);"],"sourceRoot":"/source/"}