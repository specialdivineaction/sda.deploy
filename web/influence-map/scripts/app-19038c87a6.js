!function(){"use strict";angular.module("sdaConceptBrowser",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ngMaterial","trcBiblio","trcBio","trcGraph","sda"])}(),function(){"use strict";function e(e){function t(t){return angular.isArray(t)&&(t=t[0]),t?e.compact([t.title,t.subtitle]).join(": "):""}return t}e.$inject=["_"],angular.module("sdaConceptBrowser").filter("workTitle",e)}(),function(){"use strict";function e(e,t){var n=this;e.$watch("$ctrl.title",function(e){angular.isArray(e)&&(n.title=t.getTitle(e))})}e.$inject=["$scope","worksRepo"],angular.module("sdaConceptBrowser").component("workTitle",{templateUrl:"app/components/work-title/work-title.html",bindings:{title:"<"},controller:e})}(),function(){"use strict";angular.module("sdaConceptBrowser").component("workInfo",{templateUrl:"app/components/work-info/work-info.html",bindings:{work:"<",related:"<",activate:"&"}})}(),function(){"use strict";angular.module("sdaConceptBrowser").component("workAuthors",{templateUrl:"app/components/work-authors/work-authors.html",bindings:{authors:"<"}})}(),function(){"use strict";function e(){function e(e,t,o){t===n&&e.slideUp(250,"easeInOutCubic",o)}function t(e,t,o){t===n&&e.hide().slideDown(250,"easeInOutCubic",o)}var n="ng-hide";return{beforeAddClass:e,removeClass:t}}angular.module("sdaConceptBrowser").animation(".slide",e),jQuery.easing.easeInOutCubic=function(e,t,n,o,r){return(t/=r/2)<1?o/2*t*t*t+n:o/2*((t-=2)*t*t+2)+n}}(),function(){"use strict";angular.module("sdaConceptBrowser").component("relatedNodes",{templateUrl:"app/components/related-nodes/related-nodes.html",bindings:{related:"<",activate:"&"}})}(),function(){"use strict";function e(e,t){var n=this;e.$watch("$ctrl.person",function(e){if(e){var o=t.searchByAuthor(e.id);o.$promise.then(function(){n.works=o.items})}})}e.$inject=["$scope","worksRepo"],angular.module("sdaConceptBrowser").component("personInfo",{templateUrl:"app/components/person-info/person-info.html",bindings:{person:"<",related:"<",activate:"&"},controller:e})}(),function(){"use strict";function e(e,t){function n(n,o){var r=n.width,i=!1,a=n.height,c=!1,l=n.layout,d=o.get(0);t(function(){r||(r=o.width(),i=!0),a||(a=o.height(),c=!0);var t=ConceptBrowser(d,l).size([r,a]).edgeFilter(function(e){return 0===n.relnTypes.length||n.relnTypes.indexOf(e.relation)>=0});n.sizeMetric&&t.nodeCentralityMetric(n.sizeMetric),n.selectMode&&t.selectMode(n.selectMode),n.graph&&(t.data(n.graph.nodes,n.graph.edges),t.refresh()),angular.element(e).on("resize",function(){if(i||c){var e=r,n=a;i&&(r=o.width()),c&&(a=o.height()),e===r&&n===a||(t.size([r,a]),t.refresh())}});var s=!1;t.on("activate",function(e){s||n.$apply(function(){n.activeNode=e.node})}),n.$watchGroup(["width","height","graph","activeNode","sizeMetric","selectMode"],function(e,n){var o=!1;if(e[0]&&e[0]!==n[0]&&(r=e[0],t.size([r,a]),e[2]&&(o=!0)),e[1]&&e[1]!==n[1]&&(a=e[1],t.size([r,a]),e[2]&&(o=!0)),e[2]&&e[2]!==n[2]){var i=angular.copy(e[2]);t.data(i.nodes,i.edges),o=!0}e[3]!==n[3]&&(s=!0,t.activate(e[3]),s=!1),e[4]&&e[4]!==n[4]&&(t.nodeCentralityMetric(e[4]),o=!0),e[5]&&e[5]!==n[5]&&t.selectMode(e[5]),o&&t.refresh()}),n.$watchCollection("highlightedNodes",function(e){e&&t.highlight(e)}),n.$watchCollection("relnTypes",function(e){e&&t.updateGraphSelections()})})}var o={restrict:"E",scope:{graph:"=ngModel",width:"=",height:"=",padding:"=",layout:"@",activeNode:"=",sizeMetric:"=",selectMode:"=",highlightedNodes:"=",relnTypes:"="},link:n};return o}e.$inject=["$window","$timeout"],angular.module("sdaConceptBrowser").directive("conceptBrowser",e)}(),function(){"use strict";function e(e){var n=this;e.$watch("$ctrl.content",function(e){n.longEnough=!e||e.length>t})}e.$inject=["$scope"],angular.module("sdaConceptBrowser").component("collapsibleSummary",{templateUrl:"app/components/collapsible-summary/collapsible-summary.html",bindings:{content:"<"},controller:e});var t=500}(),function(){"use strict";angular.module("trcGraph",["ngResource"])}(),function(){"use strict";function e(){function e(e){function n(e){return o.get({type:e})}var o=e(t.url+"/:type"),r={};return r.get=n,r}e.$inject=["$resource"];var t={};return t.url="/api/graph",t.$get=e,t}angular.module("trcGraph").provider("graphRepo",e)}(),function(){"use strict";function e(e,n,o,r,i,a,c,l,d,s){function u(e){return 0===b.relnTypeFilter.length||b.relnTypeFilter.indexOf(e.relation)>=0}function m(){var t="people";b.graphType=o.type||t,b.graphLoading=!0;var i=y(b.graphType);t!==b.graphType&&(i=i.catch(function(){return n.showSimple('Unable to load the "'+b.graphType+'"graph type. Falling back to "'+t+'".'),y(t)})),i.then(function(e){b.graphLoading=!1,b.graph=e.graph},function(){b.graphLoading=!1,n.showSimple("Unable to load graph data.")}),e.$watch("vm.activeNode",function(e){e?(b.sidebarLoading=!0,h(e).then(function(){b.sidebarLoading=!1},function(){b.sidebarLoading=!1,n.showSimple("Unable to load node data")})):b.nodeData=null}),e.$watch("searchQuery",function(e){b.highlightedNodes=e?r("filter")(b.graph.nodes,{label:e}):[]})}function p(e){var t=b.relnTypeFilter.indexOf(e);t<0?b.relnTypeFilter.push(e):b.relnTypeFilter.splice(t,1)}function f(){b.showSearchForm=!b.showSearchForm,b.showSearchForm?i(function(){angular.element('.search-form > input[type="search"]').focus()}):e.searchQuery=""}function g(){e.searchQuery="",i(function(){b.showSearchForm=!1})}function h(e){return b.nodeData=function(){switch(e.metadata.type){case"trc.entries.biographical":return l.get(e.metadata.id);case"trc.entries.bibliographic":return d.getWork(e.metadata.id);default:return null}}(),b.related=v(e),b.nodeData.$promise}function v(e){function n(e,n,o){return function(i){var a=t[i.relation];if(a){var c=r(e,a),l=i[n];c[a.directed?o:"none"].nodes[l.id]=l}}}function o(e){var t={id:e.id,directed:e.directed};return e.directed?(t.out={label:e.title,nodes:{}},t.in={label:e.reverseTitle,nodes:{}}):t.none={label:e.title,nodes:{}},t}function r(e,t){return e.hasOwnProperty(t.id)||(e[t.id]=o(t)),e[t.id]}var i={};return e.outEdges.forEach(n(i,"target","out")),e.inEdges.forEach(n(i,"source","in")),a.values(i).map(function(e){return e.in&&e.in.nodes&&(e.in.nodes=a.values(e.in.nodes)),e.out&&e.out.nodes&&(e.out.nodes=a.values(e.out.nodes)),e.none&&e.none.nodes&&(e.none.nodes=a.values(e.none.nodes)),e})}function y(e){var t=s.get(e);return t.$promise.then(function(){var e={};return t.graph.nodes.forEach(function(t){t.inEdges=[],t.outEdges=[],e[t.id]=t}),t.graph.edges.forEach(function(t){var n=e[t.source],o=e[t.target];t.source=o,o.outEdges.push(t),t.target=n,n.inEdges.push(t)}),t})}var b=this;b.toggleSearchForm=f,b.clearSearchForm=g,b.showSearchForm=!1,b.searchQuery="",b.graphType="",b.showHelp=c.show,b.graph=null,b.activeNode=null,b.nodeData=null,b.works=null,b.related=null,b.sidebarLoading=!1,b.graphLoading=!1,b.relnTypes=t,b.relnTypeFilter=[],b.toggleRelnTypeFilter=p,b.selectModes=[{label:"Neighbors",strategy:function(e){if(!e)return[];var t=e.outEdges.filter(u).map(function(e){return e.target}),n=e.inEdges.filter(u).map(function(e){return e.source});return[e].concat(t,n)}},{label:"Trace",strategy:function(e){if(!e)return[];for(var t=[e],n=[];t.length>0;){var o=t.pop();n.push(o),o.outEdges.forEach(function(e){n.indexOf(e.target)<0&&t.push(e.target)})}return n}},{label:"Inbound",strategy:function(e){return e?[e].concat(e.inEdges.filter(u).map(function(e){return e.source})):[]}},{label:"Outbound",strategy:function(e){return e?[e].concat(e.outEdges.filter(u).map(function(e){return e.target})):[]}}],b.selectMode=b.selectModes[0],b.sizeMetrics=[{label:"PageRank",strategy:function(e){return e.metadata.pagerank}},{label:"Uniform",strategy:function(){return 1}},{label:"HITS",disabled:!0,strategy:function(){return 1}}],b.sizeMetric=b.sizeMetrics[0],b.highlightedNodes=[],m()}e.$inject=["$scope","$mdToast","$stateParams","$filter","$timeout","_","helpDialog","peopleRepo","worksRepo","graphRepo"];var t={"uk.ac.ox.bodleian.sda.relationships.influence":{id:"uk.ac.ox.bodleian.sda.relationships.influence",title:"Influenced",reverseTitle:"Influenced By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.provoked":{id:"uk.ac.ox.bodleian.sda.relationships.provoked",title:"Provoked",reverseTitle:"Provoked By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.patternmatch":{id:"uk.ac.ox.bodleian.sda.relationships.patternmatch",title:"Possible Pattern Match",directed:!1}};angular.module("sdaConceptBrowser").controller("MainController",e)}(),function(){"use strict";function e(e,n){function o(o){var r={targetEvent:o,fullscreen:n("sm")||n("xs"),templateUrl:"app/help/help.html",controller:t,clickOutsideToClose:!0};e.show(r)}return{show:o}}function t(e,t){function n(){t.hide()}e.close=n}e.$inject=["$mdDialog","$mdMedia"],t.$inject=["$scope","$mdDialog"],angular.module("sdaConceptBrowser").factory("helpDialog",e)}(),function(){"use strict";function e(e,t,n,o){e.debug("runBlock end"),t.$on("$stateChangeSuccess",function(){o("send","pageview",{page:n.url()})})}e.$inject=["$log","$rootScope","$location","analytics"],angular.module("sdaConceptBrowser").run(e)}(),function(){"use strict";function e(e,t){e.state("home",{url:"/:type",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm"}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("sdaConceptBrowser").config(e)}(),function(){"use strict";angular.module("sdaConceptBrowser").constant("d3",d3).constant("_",_).constant("ga",ga)}(),function(){"use strict";function e(e,t,n,o,r,i,a){e.debugEnabled(!0),n.url="/api/catalog/people",o.url="/api/catalog/works",r.url="/api/catalog/graph",i.url="/assets/data/navigation.json",a.id="UA-87254463-1",t.definePalette("darkBrown",{50:"#595c59",100:"#4c4f4c",200:"#404240",300:"#333533",400:"#272827",500:"#1a1b1a",600:"#0d0e0d",700:"#010101",800:"#000000",900:"#000000",A100:"#e0f0e0",A200:"#565956",A400:"#7e837e",A700:"#000000",contrastDefaultColor:"light",contrastDarkColors:["A100"]}),t.definePalette("copper",{50:"#d4b190",100:"#cca47e",200:"#c5976b",300:"#be8a59",400:"#b67e47",500:"#a47140",600:"#926439",700:"#7f5832",800:"#6d4b2b",900:"#5b3e23",A100:"#dcc3ab",A200:"#a47140",A400:"#48321c",A700:"#272927",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"]}),t.theme("default").primaryPalette("darkBrown").accentPalette("copper")}e.$inject=["$logProvider","$mdThemingProvider","peopleRepoProvider","worksRepoProvider","graphRepoProvider","sdaSitenavProvider","analyticsProvider"],angular.module("sdaConceptBrowser").config(e)}(),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.EventDispatcher=t()}(this,function(){"use strict";function e(){function e(e,t){r[e]&&r[e].forEach(function(e){try{e(t)}catch(e){console.error(e)}}),i.forEach(function(n){try{n(e,t)}catch(e){console.error(e)}})}function t(e){return i.push(e),function(){var t=i.indexOf(e);t>=0&&i.splice(t,1)}}function n(e,t){return r[e]||(r[e]=[]),r[e].push(t),function(){var n=r[e].indexOf(t);n>=0&&r[e].splice(n,1)}}function o(e,t){var o=n(e,function(e){try{t(e)}catch(e){console.error(e)}finally{o()}});return o}var r={},i=[],a={};return a.all=t,a.on=n,a.once=o,a.trigger=e,a}return e}),function(e,t){"function"==typeof define&&define.amd?define(["d3"],t):"object"==typeof module&&module.exports?module.exports=t(require("d3")):t(d3)}(this,function(e){"use strict";function t(e){e.fixed|=2}function n(e){e.fixed&=-7}function o(e){e.fixed|=4,e.px=e.x,e.py=e.y}function r(e){e.fixed&=-5}function i(e,t,n){var o=0,r=0;if(e.charge=0,!e.leaf)for(var a,c=e.nodes,l=c.length,d=-1;++d<l;)a=c[d],a&&(i(a,t,n),e.charge+=a.charge,o+=a.charge*a.cx,r+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var s=t*n[e.point.index];e.charge+=e.pointCharge=s,o+=s*e.point.x,r+=s*e.point.y}e.cx=o/e.charge,e.cy=r/e.charge}function a(e){return"function"==typeof e}function c(e){return"number"==typeof e}var l=20,d=1,s=1/0;e.layout.force.cylindrical=function(){function u(e,t){return 2*Math.abs(e)>t&&(e<0?e+=t:e-=t),e}function m(e){return function(t,n,o,r){if(t.point!==e){var i=x[0],a=u(t.cx-e.x,i),c=t.cy-e.y,l=r-n,d=a*a+c*c,s=0;if(l*l/O<d)return d<C&&(s=t.charge/d,e.px-=a*s,e.py-=c*s),!0;t.point&&d&&d<C&&(s=t.pointCharge/d,e.px-=a*s,e.py-=c*s)}return!t.charge}}function p(t){t.px=e.event.x,t.py=e.event.y,b.resume()}var f,g,h,v,y,b={},w=e.dispatch("start","tick","end"),x=[1,1],k=.9,$=l,M=d,E=-30,C=s,T=.1,O=.64,N=[],S=[];return b.tick=function(){if((g*=.99)<.005)return w.end({type:"end",alpha:g=0}),!0;var t,n,o,r,a,c,l,d,s,p=N.length,f=S.length;for(n=0;n<f;++n)o=S[n],r=o.source,a=o.target,d=u(a.x-r.x,x[0]),s=a.y-r.y,c=d*d+s*s,0!==c&&(c=g*v[n]*((c=Math.sqrt(c))-h[n])/c,d*=c,s*=c,a.x-=d*(l=r.weight/(a.weight+r.weight)),a.y-=s*l,r.x+=d*(l=1-l),r.y+=s*l);if(l=g*T,0!==l&&(d=x[0]/2,s=x[1]/2,n=-1,l))for(;++n<p;)o=N[n],o.y+=(s-o.y)*l;if(E)for(i(t=e.geom.quadtree(N),g,y),n=-1;++n<p;)(o=N[n]).fixed||t.visit(m(o));for(n=-1;++n<p;)o=N[n],o.fixed?(o.x=o.px,o.y=o.py):(o.x-=(o.px-(o.px=o.x))*k,o.y-=(o.py-(o.py=o.y))*k);n=-1;for(var b=x[0];++n<p;){o=N[n];var $=o.px-o.x;o.x%=b,o.x<0&&(o.x+=b),o.px=o.x+$}w.tick({type:"tick",alpha:g})},b.nodes=function(e){return arguments.length?(N=e,b):N},b.links=function(e){return arguments.length?(S=e,b):S},b.size=function(e){return arguments.length?(x=e,b):x},b.linkDistance=function(e){return arguments.length?($=a(e)?e:+e,b):$},b.linkStrength=function(e){return arguments.length?(M=a(e)?e:+e,b):M},b.friction=function(e){return arguments.length?(k=+e,b):k},b.charge=function(e){return arguments.length?(E=a(e)?e:+e,b):E},b.chargeDistance=function(e){return arguments.length?(C=e*e,b):Math.sqrt(C)},b.gravity=function(e){return arguments.length?(T=+e,b):T},b.theta=function(e){return arguments.length?(O=e*e,b):Math.sqrt(O)},b.alpha=function(t){return arguments.length?(t=+t,g?g=t>0?t:0:t>0&&(w.start({type:"start",alpha:g=t}),e.timer(b.tick)),b):g},b.start=function(){function e(e,o){if(!n){for(n=new Array(r),d=0;d<r;++d)n[d]=[];for(d=0;d<i;++d){var a=S[d];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var c,l=n[t],d=-1,s=l.length;++d<s;)if(!isNaN(c=l[d][e]))return c;return Math.random()*o}var t,n,o,r=N.length,i=S.length,l=x[0],d=x[1];for(t=0;t<r;++t)(o=N[t]).index=t,o.weight=0;for(t=0;t<i;++t)o=S[t],c(o.source)&&(o.source=N[o.source]),c(o.target)&&(o.target=N[o.target]),++o.source.weight,++o.target.weight;for(t=0;t<r;++t)o=N[t],isNaN(o.x)&&(o.x=e("x",l)),isNaN(o.y)&&(o.y=e("y",d)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);if(h=[],a($))for(t=0;t<i;++t)h[t]=+$.call(this,S[t],t);else for(t=0;t<i;++t)h[t]=$;if(v=[],a(M))for(t=0;t<i;++t)v[t]=+M.call(this,S[t],t);else for(t=0;t<i;++t)v[t]=M;if(y=[],a(E))for(t=0;t<r;++t)y[t]=+E.call(this,N[t],t);else for(t=0;t<r;++t)y[t]=E;return b.resume()},b.resume=function(){return b.alpha(.1)},b.stop=function(){return b.alpha(0)},b.drag=function(){return f||(f=e.behavior.drag().origin(function(e){return e}).on("dragstart.force",t).on("drag.force",p).on("dragend.force",n)),arguments.length?void this.on("mouseover.force",o).on("mouseout.force",r).call(f):f},b.edgePath=function(){var e=x[0],t=function(e){return e[0][0]},n=function(e){return e[0][1]},o=function(e){return e[1][0]},r=function(e){return e[1][1]},i=function(i){i.attr("d",function(i){var a=t(i),c=n(i),l=o(i),d=r(i);return 2*Math.abs(a-l)<e?"M "+a+" "+c+" L "+l+" "+d:a<l?"M "+a+" "+c+" L "+(l-e)+" "+d+" M "+l+" "+d+" L "+(a+e)+" "+c:"M "+a+" "+c+" L "+(l+e)+" "+d+" M "+l+" "+d+" L "+(a-e)+" "+c})};return i.x1=function(e){return t=e,i},i.y1=function(e){return n=e,i},i.x2=function(e){return o=e,i},i.y2=function(e){return r=e,i},i},e.rebind(b,w,"on")}}),function(e,t){"function"==typeof define&&define.amd?define(["d3","event-dispatcher","d3-force-cylindrical"],t):"object"==typeof module&&module.exports?(require("d3-force-cylindrical"),module.exports=t(require("d3"),require("event-dispatcher"))):e.ConceptBrowser=t(e.d3,e.EventDispatcher)}(this,function(e,t){"use strict";function n(n,d,s){function u(e){return U=e[0],I=e[1],ie&&(q.attr("width",U).attr("height",I),K.range([0,U]),X.size([U,I])),de}function m(t){if(ce=t,ie){var n=e.extent(J,ce);W.domain(n[0]===n[1]?[n[0]-1,n[1]+1]:n)}return de}function p(e){return ae=e,de}function f(e,t){return J=e,V=t,J.forEach(function(e){e.x=(e.x||Math.random())*U,e.y=(e.y||Math.random())*I}),de}function g(e){e instanceof Array||(e=[e]);var t=e.every(function(e){return J.indexOf(e)>=0});if(!t)throw new Error("some node(s) to be highlighted are not members of the graph");return E(),M(e),de}function h(e){if(e&&J.indexOf(e)<0)throw new Error("node to be activated is not a member of the graph");return N(),e&&(O(e),A(),S(e)),de}function v(e){return le=e,de}function y(){return b(),X.nodes(J).links(V).start(),k(),$(),de}function b(){if(!U||!I)throw new Error("No width/height set. Use size([width, height]) to set size before initializing");if(!J||!V)throw new Error("No nodes/edges set. Use data(nodes, edges) to set them before initializing");if(!ie){ie=!0,q=e.select(n).append("svg").attr("width",U).attr("height",I);var t=V.reduce(function(e,t){return e.indexOf(t.relation)<0&&e.push(t.relation),e},[]);R(q,t,["","activated","selected","focused"]);var l=q.append("g").attr("class","concept-browser");G=l.append("g").attr("class","edges"),H=l.append("g").attr("class","nodes"),Q=l.append("rect").attr("class","progress").attr("x",0).attr("y",0).attr("height",2),K=e.scale.linear().domain([Math.log(.1),Math.log(.005)]).range([0,U]);var s=e.extent(J,ce);W=e.scale.linear().domain(s[0]===s[1]?[s[0]-1,s[1]+1]:s).range([0,1]),Y=function(e){return r+(i-r)*W(e)},X=a[d||"planar"]().size([U,I]).on("tick",x),w(X),X.edgePath&&(oe=X.edgePath().x1(function(e){return e.source.x}).y1(function(e){return e.source.y}).x2(function(e){return e.target.x}).y2(function(e){return e.target.y})),e.tip&&(re=e.tip().attr("class",c).direction(D).offset(L).html(function(e){return e.label}),j.on("focus",function(e){_(e.node)}),j.on("blur",function(e){z(e.node)}));var u=o(F,100,!0,!0);j.on("highlight",u),j.on("unhighlight",u),j.on("focus",u),j.on("blur",u),j.on("select",u),j.on("deselect",u),j.on("activate",u),j.on("deactivate",u)}}function w(e){e.gravity(.1).linkDistance(50).linkStrength(function(e){var t=ce(e.source);return W(t)}).charge(function(e){var t=[-50,-300],n=[0,1],o=ce(e);return t[0]+(t[1]-t[0])/(n[1]-n[0])*(W(o)-n[0])}).friction(.9)}function x(e){if(P(),e.alpha>.0051){if(Q.attr("width",K(Math.log(e.alpha))),Math.random()<.9)return}else Q.attr("width",0);H.selectAll(".node").transition().duration(500).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),G.selectAll(".edge").transition().duration(500).call(oe)}function k(){if(!J||0===J.length)throw new Error("no nodes provided");var t=H.selectAll(".node").data(J,function(e){return e.id}),n=t.enter().append("g").attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).on("mouseover",C).on("mouseout",T).on("dblclick",O).on("click",function(t){e.event.ctrlKey||e.event.metaKey||e.event.shiftKey?te.indexOf(t)<0?S(t):B(t):(A(),S(t))});n.append("circle"),t.select("circle").attr("r",function(e){var t=ce(e);return Y(t)}),t.exit().remove(),re&&H.call(re)}function $(){if(!V||0===V.length)throw new Error("no edges provided");var e=G.selectAll(".edge").data(V,function(e){return e.source.id+","+e.target.id});e.enter().append("path").attr("class",function(e){return"edge "+e.relation}).attr("marker-end",function(e){return"url(#arrowhead-"+e.relation+")"}).call(oe),e.exit().remove()}function M(e){e instanceof Array||(e=[e]),e.forEach(function(e){Z.indexOf(e)<0&&Z.push(e),j.trigger("highlight",{node:e,selection:te})})}function E(){Z.forEach(function(e){j.trigger("unhighlight",{node:e,selection:te})}),Z=[]}function C(e){T(),ee=e,j.trigger("focus",{node:ee,selection:te})}function T(e){if(e=e||ee){if(ee!==e)throw new Error("tried to blur a node that was not focused");ee=null,j.trigger("blur",{node:e,selection:te})}}function O(e){ne!==e&&(N(),ne=e,j.trigger("activate",{node:ne,selection:te}))}function N(e){if(e=e||ne){if(ne!==e)throw new Error("tried to deactivate a node that was not activated");ne=null,j.trigger("deactivate",{node:e,selection:te})}}function S(e){if(!e)throw new Error("no node provided");if(!(te.indexOf(e)<0))throw new Error("tried to select a node that is already selected");te.push(e),j.trigger("select",{node:e,selection:te})}function B(e){if(!e)throw new Error("no node provided to deselect");var t=te.indexOf(e);if(t<0)throw new Error("tried to deselect a node that was not selected");te.splice(t,1),j.trigger("deselect",{node:e,selection:te})}function A(){te.forEach(function(e){j.trigger("deselect",{node:e,selection:[]})}),te=[]}function _(e){re&&re.attr("class",c).show(e)}function z(e){re&&re.attr("class",c).hide(e)}function F(){var e=[ne],t=te.slice(),n=ae(ee);te.forEach(function(e){ae(e).forEach(function(e){n.indexOf(e)<0&&n.push(e)})}),ae(ne).forEach(function(e){n.indexOf(e)<0&&n.push(e)});var o=Z.slice();H.selectAll(".node").classed("activated",function(t){return e.indexOf(t)>=0}).classed("selected",function(e){return t.indexOf(e)>=0}).classed("focused",function(e){return n.indexOf(e)>=0}).classed("highlighted",function(e){return o.indexOf(e)>=0}),G.selectAll(".edge").classed("activated",function(t){return e.indexOf(t.source)>=0&&e.indexOf(t.target)>=0}).classed("selected",function(e){return t.indexOf(e.source)>=0&&t.indexOf(e.target)>=0}).classed("focused",function(e){return n.indexOf(e.source)>=0&&n.indexOf(e.target)>=0}).classed("hidden",function(e){return!le(e)}).attr("marker-end",function(o){var r="";return e.indexOf(o.source)>=0&&e.indexOf(o.target)>=0?r="-activated":t.indexOf(o.source)>=0&&t.indexOf(o.target)>=0?r="-selected":n.indexOf(o.source)>=0&&n.indexOf(o.target)>=0&&(r="-focused"),"url(#arrowhead-"+o.relation+r+")"})}function P(){J.forEach(function(e){e.x=Math.max(Math.min(e.x,U),0),e.y=Math.max(Math.min(e.y,I),0)})}function D(e){var t="";return e.y>I-l.bottom?t+="n":e.y<l.top&&(t+="s"),e.x>U-l.right?t+="w":e.x<l.left&&(t+="e"),""===t&&(t="n"),t}function L(e){var t=ce(e),n=Y(t),o=[0,0];return e.y>I-l.bottom?o[0]-=n:e.y<l.top&&(o[0]+=n),e.x>U-l.left_right?o[1]-=n:e.x<l.left_right&&(o[1]+=n),0===o[1]&&0===o[0]&&(o[0]-=n),o}function R(e,t,n){var o=[];t.forEach(function(e){n.forEach(function(t){o.push("arrowhead-"+e+(t?"-"+t:""))})}),e.append("defs").selectAll("marker").data(o).enter().append("marker").attr("id",function(e){return e}).attr("viewBox","0 -4 10 8").attr("refX",25).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0,-4 L 10,0 L 0,4")}d=d||"planar",s=s||{};var j=t();s.debug&&j.all(function(e,t){console.log(e,t.node?t.node.id:t)});var U,I,q,H,G,Q,K,Y,W,X,J=[],V=[],Z=[],ee=null,te=[],ne=null,oe=function(e){e.attr("d",function(e){var t=e.source.x,n=e.source.y,o=e.target.x,r=e.target.y;return"M "+t+" "+n+" L "+o+" "+r})},re=null,ie=!1,ae=function(e){if(!e)return[];var t=e.outEdges.forEach(function(e){return e.target}),n=e.inEdges.forEach(function(e){return e.source});return[e].concat(t,n)},ce=function(){return 1},le=function(){return!0},de={};return de.size=u,de.nodeCentralityMetric=m,de.selectMode=p,de.data=f,de.highlight=g,de.activate=h,de.edgeFilter=v,de.updateGraphSelections=F,de.refresh=y,de.on=j.on,de}function o(e,t,n,o){var r;return"undefined"==typeof n&&(n=!0),"undefined"==typeof o&&(o=!1),function(){function i(){r=null,o&&e.apply(a,c)}var a=this,c=arguments,l=n&&!r;clearTimeout(r),r=setTimeout(i,t),l&&e.apply(a,c)}}var r=5,i=13,a={planar:e.layout.force,cylindrical:e.layout.force.cylindrical},c="d3-tip",l={left:200,right:200,top:100,bottom:100};return e.tip||console.warn("d3.tip is not available; tooltips will not display properly."),n}),angular.module("sdaConceptBrowser").run(["$templateCache",function(e){e.put("app/help/help.html",'<md-dialog> <md-toolbar> <div class=md-toolbar-tools> <h2>Help</h2> <span flex></span> <md-button class=md-icon-button ng-click=close()> <md-icon>close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class=md-dialog-content layout=column layout-align="center center"> <iframe width=1280 height=720 src=https://www.youtube.com/embed/0PzUCCnlN18 frameborder=0 allowfullscreen></iframe> </div> </md-dialog-content> </md-dialog> '),e.put("app/main/main.html",'<md-toolbar class=layout-navbar> <div class=md-toolbar-tools layout-align="center stretch"> <a class=logo href=/ layout=column layout-align="center center"> <img src=/assets/images/sda-logo-light.png alt=SDA flex=nogrow> </a> <sda-sitenav layout=column active-url=/research></sda-sitenav> <span flex></span> <div layout=row layout-align="start center"> <md-button class=md-icon-button aria-label="Show People" ng-if="vm.graphType == \'works\'" ui-sref="home({type: \'people\'})"> <md-icon>person</md-icon> <md-tooltip>Show People</md-tooltip> </md-button> <md-button class=md-icon-button aria-label="Show Books" ng-if="vm.graphType == \'people\'" ui-sref="home({type: \'works\'})"> <md-icon>book</md-icon> <md-tooltip>Show Books</md-tooltip> </md-button> <md-menu> <md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) aria-label="Ranking Model"> <md-icon>adjust</md-icon> <md-tooltip>Ranking Model</md-tooltip> </md-button> <md-menu-content> <md-menu-item ng-repeat="metric in vm.sizeMetrics"> <md-button ng-click="vm.sizeMetric = metric" ng-disabled=metric.disabled> <md-icon md-menu-align-target>radio_button_{{vm.sizeMetric === metric ? \'\' : \'un\'}}checked</md-icon> {{metric.label}} </md-button> </md-menu-item></md-menu-content> </md-menu> <md-menu> <md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) aria-label="Selection Mode"> <md-icon>device_hub</md-icon> <md-tooltip>Selection Mode</md-tooltip> </md-button> <md-menu-content> <md-menu-item ng-repeat="mode in vm.selectModes"> <md-button ng-click="vm.selectMode = mode" ng-disabled=metric.disabled> <md-icon md-menu-align-target>radio_button_{{vm.selectMode === mode ? \'\' : \'un\'}}checked</md-icon> {{mode.label}} </md-button> </md-menu-item></md-menu-content> </md-menu> <md-menu> <md-button class=md-icon-button md-menu-origin ng-click=$mdOpenMenu($event) aria-label="Relationship Types"> <md-icon>filter_list</md-icon> <md-tooltip>Filter Types</md-tooltip> </md-button> <md-menu-content> <md-menu-item> <md-button ng-click="vm.relnTypeFilter = []"> <md-icon md-menu-align-target>check_box{{vm.relnTypeFilter.length &gt; 0 ? \'_outline_blank\' : \'\'}}</md-icon> All Relationships </md-button> </md-menu-item> <md-divider></md-divider> <md-menu-item ng-repeat="type in vm.relnTypes"> <md-button ng-click=vm.toggleRelnTypeFilter(type.id) md-prevent-menu-close> <md-icon md-menu-align-target>check_box{{vm.relnTypeFilter.indexOf(type.id) &lt; 0 ? \'_outline_blank\' : \'\'}}</md-icon> {{type.title}} </md-button> </md-menu-item> </md-menu-content> </md-menu> <md-button class=md-icon-button ng-click=vm.toggleSearchForm($event)> <md-icon>search</md-icon> <md-tooltip>{{vm.showSearchForm ? \'Hide\' : \'Show\'}} Search</md-tooltip> </md-button> <form name=search class=search-form layout=row ng-style="{ width: vm.showSearchForm ? \'20rem\' : \'0\' }"> <input type=search name=query ng-model=searchQuery ng-change=vm.highlightNodes() flex> <button class=clear ng-click=vm.clearSearchForm()> <md-icon>clear</md-icon> <md-tooltip>Clear</md-tooltip> </button> </form> <md-button class=md-icon-button ng-click=vm.showHelp($event) aria-label=Help> <md-icon>help_outline</md-icon> <md-tooltip>Help</md-tooltip> </md-button> </div> </div> </md-toolbar> <md-sidenav md-component-id=right class=md-sidenav-right md-is-open=vm.activeNode md-disable-backdrop md-whiteframe=4 layout=column> <md-toolbar> <div class=md-toolbar-tools> <span flex></span> <md-button class=md-icon-button ng-click="vm.activeNode = null"> <md-icon>close</md-icon> </md-button> </div> </md-toolbar> <div flex layout=column layout-align="center center" ng-if=vm.sidebarLoading> <md-progress-circular md-mode=indeterminate></md-progress-circular> </div> <div ng-switch=vm.graphType ng-if="!vm.sidebarLoading && vm.nodeData" layout=column flex> <person-info ng-switch-when=people person=vm.nodeData related=vm.related activate="vm.activeNode = $node" layout=column flex></person-info> <work-info ng-switch-when=works work=vm.nodeData related=vm.related activate="vm.activeNode = $node" layout=column flex></work-info> </div> </md-sidenav> <main layout=column flex> <concept-browser flex ng-if=vm.graph ng-model=vm.graph active-node=vm.activeNode size-metric=vm.sizeMetric.strategy select-mode=vm.selectMode.strategy highlighted-nodes=vm.highlightedNodes reln-types=vm.relnTypeFilter> </concept-browser> <div ng-if="!vm.graph && vm.graphLoading" flex layout=column layout-align="center center" layout-padding> <md-progress-circular md-mode=indeterminate></md-progress-circular> <div class="text-center md-headline md-secondary"> Loading graph data&hellip;<br> This may take a while. </div> </div> </main> '),e.put("app/components/collapsible-summary/collapsible-summary.html",'<section class=summary ng-bind-html=$ctrl.content ng-class="{collapsed: ($ctrl.longEnough && !$ctrl.summaryExpanded)}" ng-click="$ctrl.summaryExpanded = true"></section> <div layout=row layout-align="center center" ng-if=$ctrl.longEnough> <md-button ng-click="$ctrl.summaryExpanded = !$ctrl.summaryExpanded" class=md-raised> Show {{$ctrl.summaryExpanded ? \'Less\' : \'More\'}} </md-button> </div> '),e.put("app/components/person-info/person-info.html",'<div layout=column layout-margin> <div> <h2 class=name> <span class=given>{{$ctrl.person.name.givenName}}</span> <span class=family>{{$ctrl.person.name.familyName}}</span> </h2> </div> </div> <md-tabs flex> <md-tab> <md-tab-label> <md-icon>person</md-icon> </md-tab-label> <md-tab-body> <div layout=column layout-padding flex> <div class=summary ng-if=$ctrl.person.summary ng-bind-html=$ctrl.person.summary flex></div> <div class=summary ng-if=!$ctrl.person.summary flex>Summary not available</div> </div> </md-tab-body> </md-tab> <md-tab ng-if="$ctrl.works.length > 0"> <md-tab-label> <md-icon>content_copy</md-icon> </md-tab-label> <md-tab-body> <div layout-padding layout=column> <h4 class=list-heading>Books ({{$ctrl.works.length}})</h4> </div> <md-list> <md-list-item ng-repeat="work in $ctrl.works" ng-href=/research/#/books/{{work.id}}> <p class=work-result-label> <span class=title>{{work.title}}</span> <span ng-if=work.pubYear>({{work.pubYear}})</span> </p> </md-list-item> </md-list> </md-tab-body> </md-tab> <md-tab ng-if="$ctrl.related.length > 0"> <md-tab-label> <md-icon>link</md-icon> </md-tab-label> <md-tab-body> <related-nodes related=$ctrl.related activate="$ctrl.activate({$node: $node})"></related-nodes> </md-tab-body> </md-tab> </md-tabs> '),e.put("app/components/related-nodes/related-nodes.html",'<md-list> <div ng-repeat="group in $ctrl.related"> <div ng-if="group.directed && group.out.nodes.length > 0"> <md-subheader class="md-no-sticky collapse-handle" ng-click="group.out.expanded = !group.out.expanded"> <md-icon>{{group.out.expanded ? \'expand_more\' : \'keyboard_arrow_right\'}}</md-icon> {{group.out.label}} </md-subheader> <div class=slide ng-show=group.out.expanded> <md-list-item ng-repeat="node in group.out.nodes track by node.id" ng-click="$ctrl.activate({$node: node})"> <p class=work-result-label>{{node.label}}</p> </md-list-item> </div> </div> <div ng-if="group.directed && group.in.nodes.length > 0"> <md-subheader class="md-no-sticky collapse-handle" ng-click="group.in.expanded = !group.in.expanded"> <md-icon>{{group.in.expanded ? \'expand_more\' : \'keyboard_arrow_right\'}}</md-icon> {{group.in.label}} </md-subheader> <div class=slide ng-show=group.in.expanded> <md-list-item ng-repeat="node in group.in.nodes track by node.id" ng-click="$ctrl.activate({$node: node})"> <p class=work-result-label>{{node.label}}</p> </md-list-item> </div> </div> <div ng-if="!group.directed && group.none.nodes.length > 0"> <md-subheader class="md-no-sticky collapse-handle" ng-click="group.none.expanded = !group.none.expanded"> <md-icon>{{group.none.expanded ? \'expand_more\' : \'keyboard_arrow_right\'}}</md-icon> {{group.none.label}} </md-subheader> <div class=slide ng-show=group.none.expanded> <md-list-item ng-repeat="node in group.none.nodes track by node.id" ng-click="$ctrl.activate({$node: node})"> <p class=work-result-label>{{node.label}}</p> </md-list-item> </div> </div> </div> </md-list> '),
e.put("app/components/work-authors/work-authors.html","<span class=author ng-repeat=\"author in $ctrl.authors\"> <a ng-href=/research/#/people/{{author.authorId}}>{{author.firstName}} {{author.lastName}}</a>{{$last ? '' : ',' }} </span> "),e.put("app/components/work-info/work-info.html",'<div layout=column layout-padding flex> <div> <h1 class="md-title title"> <work-title title=$ctrl.work.titles></work-title> </h1> <p class=by-line>by <work-authors authors=$ctrl.work.authors></work-authors></p> </div> <collapsible-summary ng-if=$ctrl.work.summary content=$ctrl.work.summary></collapsible-summary> <div flex></div> <div ng-if="$ctrl.related.length > 0"> <h2>Related Books</h2> <related-nodes related=$ctrl.related activate="$ctrl.activate({$node: $node})"></related-nodes> </div> </div> '),e.put("app/components/work-title/work-title.html","<span class=title ng-if=$ctrl.title.title>{{$ctrl.title.title}}</span>{{ $ctrl.title.title && $ctrl.title.subtitle ? ': ' : ''}}<span class=subtitle ng-if=$ctrl.title.subtitle>{{$ctrl.title.subtitle}}</span> ")}]);