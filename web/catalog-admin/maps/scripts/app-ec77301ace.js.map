{"version":3,"sources":["scripts/app.js"],"names":["angular","module","workEditorDirective","WorkEditorController","$scope","worksRepo","_","activate","work","editions","forEach","edition","vm","push","model","focused","createEdition","titles","cloneDeep","authors","otherAuthors","deleteEdition","ix","splice","this","$inject","directive","restrict","templateUrl","scope","controller","controllerAs","volumeEditorDirective","volume","titleEditorDirective","title","publicationInfoEditorDirective","pubInfo","copyEditorDirective","CopyEditorController","addHandler","HathiTrustRefHandler","GoogleBooksRefHandler","handler","refHandlers","id","parseProperties","type","url","copy","properties","copyForm","$setValidity","setProperties","handle","parsed","parseUrl","seq","hostname","query","path","substr","lastIndexOf","urlappend","subquery","parseQueryString","htid","display","section","printsec","page","pg","parser","document","createElement","href","toString","protocol","host","port","pathname","search","fragment","hash","sep","isString","flags","indexOf","kvpairs","split","pair","key","value","decodeURIComponent","URIError","hasOwnProperty","isArray","editionEditorDirective","EditionEditorController","volumes","createVolume","publicationInfo","deleteVolume","authorRefEditorDirective","AuthorRefEditorController","peopleRepo","ref","authorId","author","get","$promise","then","linkAuthorSearchText","name","label","setLinkedAuthor","person","getResults","resultSet","items","authorRoles","workEditorItemDirective","$log","linkFunc","error","WorkEditorItemController","loaded","link","nameEditorDirective","eventEditorDirective","event","summaryEditorDirective","summary","SummaryEditDialogController","$mdDialog","close","hide","cancel","dateEditorDirective","date","ShowWorkController","$state","$stateParams","$mdToast","workId","bcTitle","getTitle","loading","editBibInfo","$event","dialog","targetEvent","locals","dialogPromise","show","updatedWork","extend","saveWork","showSavedToast","editSummary","updatedSummary","addEdition","prompt","textContent","placeholder","ok","savePromise","editionName","saveEdition","go","editionId","confirm","addCopy","editCopy","copies","updatedCopy","deleteCopy","toast","simple","position","WorkEditDialogController","addAuthor","field","authorRef","deleteAuthor","addTitle","deleteTitle","ShowVolumeController","$q","getWork","getEdition","getVolume","volumeId","workTitle","all","updatedVolume","saveVolume","VolumeEditDialogController","ShowEditionController","updatedEdition","addVolume","volumeNumber","EditionEditDialogController","CopyEditDialogController","worksRepoProvider","worksRepoFactory","$resource","findAll","restResource","q","max","isUndefined","TypeError","adaptWork","editionResource","adaptEdition","volumeResource","adaptVolume","createWork","save","arguments","length","apply","Error","$update","$save","deleteWork","dataItem","adaptCommon","entity","toLowerCase","role","getTitleByTypePreference","types","reduce","found","find","provider","update","method","repo","getAll","create","$get","tasksRepoProvider","tasksRepoFactory","getTask","taskId","workflow","workflowResource","task","getItems","stageId","options","itemResource","stage","start","transition","item","sourceStage","targetStage","result","itemId","comments","resp","peopleRepoProvider","peopleRepoFactory","createPerson","adaptPerson","createMeta","meta","adaptMeta","createName","adaptName","createEvent","evt","adaptEvent","createDateDescription","dateDescription","findById","savePerson","response","personId","deletePerson","altNames","birth","death","links","trcPersonEditorDirective","PersonEditorController","addName","newName","removeName","addEvent","newEvent","removeEvent","trcNameEditorDirective","NameEditorController","roles","trcEventEditorDirective","TaskController","$mdSidenav","tasksRepo","worklistPromises","stages","worklistPromise","fetchStage","openMenu","toggle","focusItem","stopImmediatePropagation","entityId","transitionItem","updatedItem","group","worklists","stageOrder","slideToggle","el","attr","duration","parseInt","slideToggleDuration","$watch","active","stop","slideDown","slideUp","ShowPersonController","editBioInfo","updatedPerson","editEvent","updatedEvent","PersonEditDialogController","deleteName","nameRoles","EventEditDialogController","MainController","searchQuery","peopleResults","worksResults","debounce","runBlock","debug","run","routerConfig","$stateProvider","$urlRouterProvider","state","views","main","otherwise","config","constant","moment","$logProvider","$mdThemingProvider","debugEnabled","definePalette","50","100","200","300","400","500","600","700","800","900","A100","A200","A400","A700","contrastDefaultColor","contrastDarkColors","theme","primaryPalette","accentPalette","$templateCache","put"],"mappings":"CAAA,WACE,YAEAA,SACGC,OAAO,eACN,YACA,YAEA,aACA,aACA,SACA,aACA,YACA,WACA,aACA,cACA,WACA,WACA,cAKN,WACE,YAOA,SAASC,KAcP,QAASC,GAAqBC,EAAQC,EAAWC,GAU/C,QAASC,KACPH,EAAOI,KAAKC,SAASC,QAAQ,SAAUC,GACrCC,EAAGH,SAASI,MACVC,MAAOH,EACPI,SAAS,MAKf,QAASC,KACP,GAAIL,GAAUN,EAAUW,eACxBL,GAAQM,OAASX,EAAEY,UAAUd,EAAOI,KAAKS,QACzCN,EAAQQ,QAAUb,EAAEY,UAAUd,EAAOI,KAAKW,SAC1CR,EAAQS,aAAed,EAAEY,UAAUd,EAAOI,KAAKY,cAE/ChB,EAAOI,KAAKC,SAASI,KAAKF,GAC1BC,EAAGH,SAASI,MACVC,MAAOH,EACPI,SAAS,IAIb,QAASM,GAAcC,GACrBV,EAAGH,SAASc,OAAOD,EAAI,GACvBlB,EAAOI,KAAKC,SAASc,OAAOD,EAAI,GAjClC,GAAIV,GAAKY,IAETZ,GAAGH,YAEHG,EAAGI,cAAgBA,EACnBJ,EAAGS,cAAgBA,EAEnBd,IArBFJ,EAAqBsB,SAAW,SAAU,YAAa,IAAvD,IAAIC,IACFC,SAAU,IACVC,YAAa,mDACbC,OACErB,KAAM,YAERsB,WAAY3B,EACZ4B,aAAc,KAGhB,OAAOL,GAhBT1B,QACGC,OAAO,eACPyB,UAAU,aAAcxB,MAyD7B,WACE,YAOA,SAAS8B,KACP,GAAIN,IACFC,SAAU,IACVC,YAAa,uDACbC,OACEI,OAAQ,YAIZ,OAAOP,GAdT1B,QACGC,OAAO,eACPyB,UAAU,eAAgBM,MAiB/B,WACE,YAOA,SAASE,KACP,GAAIR,IACFC,SAAU,IACVC,YAAa,qDACbC,OACEM,MAAO,YAIX,OAAOT,GAdT1B,QACGC,OAAO,eACPyB,UAAU,cAAeQ,MAiB9B,WACE,YAOA,SAASE,KACP,GAAIV,IACFC,SAAU,IACVC,YAAa,2EACbC,OACEQ,QAAS,YAIb,OAAOX,GAdT1B,QACGC,OAAO,eACPyB,UAAU,wBAAyBU,MAiBxC,WACE,YAQA,SAASE,KAaP,QAASC,GAAqBnC,GAQ5B,QAASG,KACPiC,EAAWC,KACXD,EAAWE,KAGb,QAASF,GAAWG,GAClB/B,EAAGgC,YAAYD,EAAQE,IAAMF,EAG/B,QAASG,GAAgBC,EAAMC,GACzBpC,EAAGgC,YAAYG,KACjB3C,EAAO6C,KAAKC,WAAatC,EAAGgC,YAAYG,GAAMC,IAGhD5C,EAAO+C,SAASH,IAAII,aAAaL,EAAgC,MAA1B3C,EAAO6C,KAAKC,YArBrD,GAAItC,GAAKY,IAETZ,GAAGgC,eACHhC,EAAGyC,cAAgBP,EAEnBvC,IAlBFgC,EAAqBd,SAAW,SADhC,IAAIC,IACFC,SAAU,IACVC,YAAa,mDACbC,OACEoB,KAAM,YAERnB,WAAYS,EACZR,aAAc,KAGhB,OAAOL,GA8BT,QAASe,KACP,QAASa,GAAON,GACd,GAAIO,GAASC,EAASR,EACtB,KAAKO,EACH,MAAO,KAGT,IAAIV,GAAIY,CAER,QAAQF,EAAOG,UACb,IAAK,uBACHb,EAAKU,EAAOI,MAAMd,GAClBY,EAAMF,EAAOI,MAAMF,GACnB,MAEF,KAAK,iBAGH,GAFAZ,EAAKU,EAAOK,KAAKC,OAAON,EAAOK,KAAKE,YAAY,KAAO,IAElDP,EAAOI,MAAMI,UAChB,KAGF,IAAIC,GAAWC,EAAiBV,EAAOI,MAAMI,UAC7C,KAAKC,EACH,KAEFP,GAAMO,EAASP,IAInB,MAAKZ,IAKHqB,KAAMrB,EACNY,IAAKA,GALE,KAYX,MAHAH,GAAOT,GAAK,aACZS,EAAOa,QAAU,aAEVb,EAGT,QAASZ,KACP,QAASY,GAAON,GACd,GAAIO,GAASC,EAASR,EACtB,KAAKO,EACH,MAAO,KAGT,QAAQA,EAAOG,UACb,IAAK,mBACH,GAAIb,GAAKU,EAAOI,MAAMd,GAClBuB,EAAUb,EAAOI,MAAMU,SACvBC,EAAOf,EAAOI,MAAMY,GAI5B,MAAK1B,IAKHA,GAAIA,EACJuB,QAASA,EACTE,KAAMA,GANC,KAaX,MAHAhB,GAAOT,GAAK,cACZS,EAAOa,QAAU,eAEVb,EAST,QAASE,GAASR,GAChB,IAAKA,EACH,MAAO,KAGT,IAAIwB,GAASC,SAASC,cAAc,IAGpC,OAFAF,GAAOG,KAAO3B,GAGZ4B,SAAU,WACR,MAAO5B,IAET6B,SAAUL,EAAOK,SACjBC,KAAMN,EAAOM,KACbpB,SAAUc,EAAOd,SACjBqB,KAAMP,EAAOO,KACbnB,KAAMY,EAAOQ,SACbrB,MAAOM,EAAiBO,EAAOS,QAC/BC,SAAUV,EAAOW,MAUrB,QAASlB,GAAiBN,EAAOyB,GAC/B,IAAKzB,IAAU3D,QAAQqF,SAAS1B,GAC9B,QASF,IALiB,MAAbA,EAAM,KACRA,EAAQA,EAAME,OAAO,KAIlBuB,EAAK,CAMR,GAAIE,IAAS3B,EAAM4B,QAAQ,MAAQ,EAAI,EAAI,IAAM5B,EAAM4B,QAAQ,MAAQ,EAAI,EAAI,EAC/EH,GAAgB,IAAVE,EAAc,IAAM,IAG5B,GAAI/B,MAEAiC,EAAU7B,EAAM8B,MAAML,EAoC1B,OAnCAI,GAAQ9E,QAAQ,SAAUgF,GACxB,GAAIpE,GAAKoE,EAAKH,QAAQ,KAClBI,EAAMD,EACNE,EAAQ,IAEZ,IAAKD,EAAL,CAIIrE,GAAM,IACRqE,EAAMD,EAAK7B,OAAO,EAAGvC,GACrBsE,EAAQF,EAAK7B,OAAOvC,EAAK,GAG3B,KACEqE,EAAME,mBAAmBF,GACzBC,EAAQC,mBAAmBD,GAC3B,MAAOE,GACP,OAKEvC,EAAOwC,eAAeJ,GAEpB3F,QAAQgG,QAAQzC,EAAOoC,IACzBpC,EAAOoC,GAAK9E,KAAK+E,GAEjBrC,EAAOoC,IAAQpC,EAAOoC,GAAMC,GAG9BrC,EAAOoC,GAAOC,KAIXrC,EAzNTvD,QACGC,OAAO,eACPyB,UAAU,aAAcY,MA4N7B,WACE,YASA,SAAS2D,KAYP,QAASC,GAAwB9F,EAAQC,EAAWC,GAUlD,QAASC,KACPH,EAAOO,QAAQwF,QAAQzF,QAAQ,SAAUuB,GACvCrB,EAAGuF,QAAQtF,MACTC,MAAOmB,EACPlB,SAAS,MAKf,QAASqF,KACP,GAAInE,GAAS5B,EAAU+F,cACvBnE,GAAOhB,OAASX,EAAEY,UAAUd,EAAOO,QAAQM,QAC3CgB,EAAOd,QAAUb,EAAEY,UAAUd,EAAOO,QAAQQ,SAC5Cc,EAAOb,aAAed,EAAEY,UAAUd,EAAOO,QAAQS,cACjDa,EAAOoE,gBAAkB/F,EAAEY,UAAUd,EAAOO,QAAQ0F,iBAEpDjG,EAAOO,QAAQwF,QAAQtF,KAAKoB,GAC5BrB,EAAGuF,QAAQtF,MACTC,MAAOmB,EACPlB,SAAS,IAIb,QAASuF,GAAahF,GACpBV,EAAGuF,QAAQ5E,OAAOD,EAAI,GACtBlB,EAAOO,QAAQwF,QAAQ5E,OAAOD,EAAI,GAlCpC,GAAIV,GAAKY,IAETZ,GAAGuF,WAEHvF,EAAGwF,aAAeA,EAClBxF,EAAG0F,aAAeA,EAElB/F,IAnBF2F,EAAwBzE,SAAW,SAAU,YAAa,IAF1D,IAAIC,IACFC,SAAU,IACVC,YAAa,yDACbC,OACElB,QAAS,YAEXmB,WAAYoE,EACZnE,aAAc,KAGhB,OAAOL,GAhBT1B,QACGC,OAAO,eACPyB,UAAU,gBAAiBuE,MA2DhC,WACE,YAUA,SAASM,KAWP,QAASC,GAA0BpG,EAAQqG,GAgBzC,QAASlG,KACP,GAAIH,EAAOsG,IAAIC,SAAU,CACvB,GAAIC,GAASH,EAAWI,IAAIzG,EAAOsG,IAAIC,SACvCC,GAAOE,SAASC,KAAK,WACnBnG,EAAGoG,qBAAuBJ,EAAOK,KAAKC,SAK5C,QAASC,GAAgBC,GACvBhH,EAAOsG,IAAIC,SAAWS,EAAOvE,GAG/B,QAASwE,GAAW1D,GAClB,GAAI2D,GAAYb,EAAWxB,OAAOtB,EAClC,OAAO2D,GAAUR,SAASC,KAAK,WAC7B,MAAOO,GAAUC,QA/BrB,GAAI3G,GAAKY,IAETZ,GAAGoG,qBAAuB,GAC1BpG,EAAG4G,aACD,SACA,SACA,aACA,SAGF5G,EAAGuG,gBAAkBA,EACrBvG,EAAGyG,WAAaA,EAEhB9G,IAxBFiG,EAA0B/E,SAAW,SAAU,aAH/C,IAAIC,IACFC,SAAU,IACVC,YAAa,+DACbC,OACE6E,IAAK,YAEP5E,WAAY0E,EACZzE,aAAc,KAGhB,OAAOL,GAhBT1B,QACGC,OAAO,eACPyB,UAAU,kBAAmB6E,MA0DlC,WACE,YAYA,SAASkB,GAAwBC,GAS/B,QAASC,GAASvH,GACXA,EAAOyC,IACV6E,EAAKE,MAAM,mCAKf,QAASC,GAAyBzH,EAAQC,GAOxC,QAASE,KACHH,EAAOyC,KACTjC,EAAGJ,KAAOH,EAAUwG,IAAIzG,EAAOyC,IAC/BjC,EAAGJ,KAAKsG,SAASC,KAAK,WACpBnG,EAAGkH,QAAS,KAVlB,GAAIlH,GAAKY,IAETZ,GAAGkH,QAAS,EAEZvH,IApBFsH,EAAyBpG,SAAW,SAAU,YAL9C,IAAIC,IACFC,SAAU,IACVC,YAAa,wDACbmG,KAAMJ,EACN9F,OACEgB,GAAI,OAENf,WAAY+F,EACZ9F,aAAc,KAGhB,OAAOL,GAbT+F,EAAwBhG,SAAW,QAJnCzB,QACGC,OAAO,eACPyB,UAAU,iBAAkB+F,MA4CjC,WACE,YAOA,SAASO,KACP,GAAItG,IACFC,SAAU,IACVC,YAAa,qDACbC,OACEoF,KAAM,YAIV,OAAOvF,GAdT1B,QACGC,OAAO,eACPyB,UAAU,aAAcsG,MAiB7B,WACE,YAOA,SAASC,KACP,GAAIvG,IACFC,SAAU,IACVC,YAAa,uDACbC,OACEqG,MAAO,YAIX,OAAOxG,GAdT1B,QACGC,OAAO,eACPyB,UAAU,cAAeuG,MAiB9B,WACE,YAOA,SAASE,KACP,GAAIzG,IACFC,SAAU,IACVC,YAAa,oDACbC,OACEuG,QAAS,YAIb,OAAO1G,GAdT1B,QACGC,OAAO,eACPyB,UAAU,gBAAiByG,MAiBhC,WACE,YAOA,SAASE,GAA4BC,EAAWF,GAQ9C,QAASG,KACPD,EAAUE,KAAK5H,EAAGwH,SAGpB,QAASK,KACPH,EAAUG,SAZZ,GAAI7H,GAAKY,IAETZ,GAAGwH,QAAUA,EAEbxH,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EALdJ,EAA4B5G,SAAW,YAAa,WANpDzB,QACGC,OAAO,eACP6B,WAAW,8BAA+BuG,MAsB/C,WACE,YAOA,SAASK,KACP,GAAIhH,IACFC,SAAU,IACVC,YAAa,8CACbC,OACE8G,KAAM,YAIV,OAAOjH,GAdT1B,QACGC,OAAO,eACPyB,UAAU,aAAcgH,MAiB7B,WACE,YAOA,SAASE,GAAmBC,EAAQC,EAAczI,EAAWiI,EAAWS,GAiBtE,QAASxI,KACPK,EAAGJ,KAAOH,EAAUwG,IAAIiC,EAAaE,QAErCpI,EAAGJ,KAAKsG,SAASC,KAAK,WACpBnG,EAAGqI,QAAU5I,EAAU6I,SAAStI,EAAGJ,KAAKS,QAAS,QAAS,YAAa,kBACvEL,EAAGuB,MAAQ9B,EAAU6I,SAAStI,EAAGJ,KAAKS,QAAS,YAAa,gBAAiB,UAE7EL,EAAGuI,SAAU,IAIjB,QAASC,GAAYC,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,iCACb4H,QAEEhJ,KAAMR,QAAQiD,KAAKrC,EAAGJ,OAExBsB,WAAY,2BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAU4C,GAE3B3J,QAAQ4J,OAAOhJ,EAAGJ,KAAMmJ,GAExBtJ,EAAUwJ,SAASjJ,EAAGJ,MAAMuG,KAAK+C,KAIrC,QAASC,GAAYV,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,8DACb4H,QAEEpB,QAASpI,QAAQiD,KAAKrC,EAAGJ,KAAK4H,UAEhCtG,WAAY,8BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAUiD,GAE3BpJ,EAAGJ,KAAK4H,QAAU4B,EAElB3J,EAAUwJ,SAASjJ,EAAGJ,MAAMuG,KAAK+C,KAIrC,QAASG,GAAWZ,GAClB,GAAIa,GAAS5B,EAAU4B,SACpBX,YAAYF,GACZlH,MAAM,kBACNgI,YAAY,8CACZC,YAAY,gBACZC,GAAG,UACH5B,OAAO,UAENgB,EAAgBnB,EAAUoB,KAAKQ,GAE/BI,EAAcb,EAAc1C,KAAK,SAAUwD,GAC7C,GAAI5J,GAAUN,EAAUW,eASxB,OARAL,GAAQ4J,YAAcA,EACtB5J,EAAQM,OAASjB,QAAQiD,KAAKrC,EAAGJ,KAAKS,QACtCN,EAAQQ,QAAUnB,QAAQiD,KAAKrC,EAAGJ,KAAKW,SACvCR,EAAQS,aAAepB,QAAQiD,KAAKrC,EAAGJ,KAAKY,cAE5CR,EAAGJ,KAAKC,SAASI,KAAKF,GAGfN,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIlC,IAG3C2J,GAAYvD,KAAK+C,GAEjBQ,EAAYvD,KAAK,SAAUpG,GACzBkI,EAAO4B,GAAG,kBAAoBzB,OAAQpI,EAAGJ,KAAKqC,GAAI6H,UAAW/J,EAAQkC,OAIzE,QAASxB,GAAcV,EAAS0I,GAC9B,GAAIsB,GAAUrC,EAAUqC,UACrBpB,YAAYF,GACZlH,MAAM,oBACNgI,YAAY,iDACZE,GAAG,OACH5B,OAAO,KAEVH,GAAUoB,KAAKiB,GACZ5D,KAAK,WACJ,GAAIzF,GAAKV,EAAGJ,KAAKC,SAAS8E,QAAQ5E,EAC9BW,IAAM,IACRV,EAAGJ,KAAKC,SAASc,OAAOD,EAAI,GAC5BjB,EAAUwJ,SAASjJ,EAAGJ,MAAMuG,KAAK+C,MAKzC,QAASc,GAAQvB,GACf,GAAIpG,KACJ4H,GAAS5H,EAAMoG,GAAQtC,KAAK,WAC1BnG,EAAGJ,KAAKsK,OAAOjK,KAAKoC,KAIxB,QAAS4H,GAAS5H,EAAMoG,GACtB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,iCACb4H,QAEEvG,KAAMjD,QAAQiD,KAAKA,IAErBnB,WAAY,2BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EASnC,OAPAG,GAAc1C,KAAK,SAAUgE,GAE3B/K,QAAQ4J,OAAO3G,EAAM8H,GAErB1K,EAAUwJ,SAASjJ,EAAGJ,MAAMuG,KAAK+C,KAG5BL,EAGT,QAASuB,GAAW/H,EAAMoG,GACxB,GAAIsB,GAAUrC,EAAUqC,UACrBpB,YAAYF,GACZlH,MAAM,oBACNgI,YAAY,8CACZE,GAAG,OACH5B,OAAO,KAEVH,GAAUoB,KAAKiB,GACZ5D,KAAK,WACJ,GAAIzF,GAAKV,EAAGJ,KAAKsK,OAAOvF,QAAQtC,EAC5B3B,IAAM,IACRV,EAAGJ,KAAKsK,OAAOvJ,OAAOD,EAAI,GAC1BjB,EAAUwJ,SAASjJ,EAAGJ,MAAMuG,KAAK+C,MAKzC,QAASA,KACP,GAAImB,GAAQlC,EAASmC,SAClBf,YAAY,SACZgB,SAAS,eAEZ,OAAOpC,GAASW,KAAKuB,GA9KvB,GAAIrK,GAAKY,IAETZ,GAAGuI,SAAU,EACbvI,EAAGJ,KAAO,KACVI,EAAGuB,MAAQ,KAEXvB,EAAGwI,YAAcA,EACjBxI,EAAGmJ,YAAcA,EACjBnJ,EAAGqJ,WAAaA,EAChBrJ,EAAGS,cAAgBA,EACnBT,EAAGgK,QAAUA,EACbhK,EAAGiK,SAAWA,EACdjK,EAAGoK,WAAaA,EAEhBzK,IAbFqI,EAAmBnH,SAAW,SAAU,eAAgB,YAAa,YAAa,YAPlFzB,QACGC,OAAO,eACP6B,WAAW,qBAAsB8G,MAwLtC,WACE,YAOA,SAASwC,GAAyB9C,EAAW9H,GAY3C,QAAS+H,KACPD,EAAUE,KAAK5H,EAAGJ,MAGpB,QAASiI,KACPH,EAAUG,SAGZ,QAAS4C,GAAUC,GAEjB,GAAIC,KACJ3K,GAAGJ,KAAK8K,GAAOzK,KAAK0K,GAGtB,QAASC,GAAaF,EAAOC,GAC3B,GAAIjK,GAAKV,EAAGJ,KAAK8K,GAAO/F,QAAQgG,EAC5BjK,IAAM,GACRV,EAAGJ,KAAK8K,GAAO/J,OAAOD,EAAI,GAI9B,QAASmK,KAEP,GAAItJ,KACJvB,GAAGJ,KAAKS,OAAOJ,KAAKsB,GAGtB,QAASuJ,GAAYvJ,GACnB,GAAIb,GAAKV,EAAGJ,KAAKS,OAAOsE,QAAQpD,EAC5Bb,IAAM,GACRV,EAAGJ,KAAKS,OAAOM,OAAOD,EAAI,GAzC9B,GAAIV,GAAKY,IAETZ,GAAGJ,KAAOA,EAEVI,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EACZ7H,EAAGyK,UAAYA,EACfzK,EAAG4K,aAAeA,EAClB5K,EAAG6K,SAAWA,EACd7K,EAAG8K,YAAcA,EAPnBN,EAAyB3J,SAAW,YAAa,QARjDzB,QACGC,OAAO,eACP6B,WAAW,2BAA4BsJ,MAoD5C,WACE,YAOA,SAASO,GAAqB9C,EAAQC,EAAczI,EAAWC,EAAGgI,EAAWS,EAAU6C,GAkBrF,QAASrL,KACPK,EAAGJ,KAAOH,EAAUwL,QAAQ/C,EAAaE,QACzCpI,EAAGD,QAAUN,EAAUyL,WAAWhD,EAAaE,OAAQF,EAAa4B,WACpE9J,EAAGqB,OAAS5B,EAAU0L,UAAUjD,EAAaE,OAAQF,EAAa4B,UAAW5B,EAAakD,UAE1FpL,EAAGJ,KAAKsG,SAASC,KAAK,WACpBnG,EAAGqL,UAAY5L,EAAU6I,SAAStI,EAAGJ,KAAKS,QAAS,QAAS,YAAa,oBAG3EL,EAAGqB,OAAO6E,SAASC,KAAK,WACtBnG,EAAGuB,MAAQ9B,EAAU6I,SAAStI,EAAGqB,OAAOhB,QAAS,YAAa,gBAAiB,YAGjF2K,EAAGM,KAAKtL,EAAGJ,KAAKsG,SAAUlG,EAAGD,QAAQmG,SAAUlG,EAAGqB,OAAO6E,WAAWC,KAAK,WACvEnG,EAAGuI,SAAU,IAIjB,QAASC,GAAYC,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,mCACb4H,QAEEvH,OAAQjC,QAAQiD,KAAKrC,EAAGqB,SAE1BH,WAAY,6BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EASnC,OAPAG,GAAc1C,KAAK,SAAUoF,GAE3BnM,QAAQ4J,OAAOhJ,EAAGqB,OAAQkK,GAE1B9L,EAAU+L,WAAWxL,EAAGJ,KAAKqC,GAAIjC,EAAGD,QAAQkC,GAAIjC,EAAGqB,QAAQ8E,KAAK+C,KAG3DL,EAGT,QAASM,GAAYV,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,8DACb4H,QAEEpB,QAASpI,QAAQiD,KAAKrC,EAAGqB,OAAOmG,UAElCtG,WAAY,8BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAUiD,GAE3BpJ,EAAGqB,OAAOmG,QAAU4B,EAEpB3J,EAAU+L,WAAWxL,EAAGJ,KAAKqC,GAAIjC,EAAGD,QAAQkC,GAAIjC,EAAGqB,QAAQ8E,KAAK+C,KAIpE,QAASc,GAAQvB,GACf,GAAIpG,KACJ4H,GAAS5H,EAAMoG,GAAQtC,KAAK,WAC1BnG,EAAGqB,OAAO6I,OAAOjK,KAAKoC,KAI1B,QAAS4H,GAAS5H,EAAMoG,GACtB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,iCACb4H,QAEEvG,KAAMjD,QAAQiD,KAAKA,IAErBnB,WAAY,2BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EASnC,OAPAG,GAAc1C,KAAK,SAAUgE,GAE3B/K,QAAQ4J,OAAO3G,EAAM8H,GAErB1K,EAAU+L,WAAWxL,EAAGJ,KAAKqC,GAAIjC,EAAGD,QAAQkC,GAAIjC,EAAGqB,QAAQ8E,KAAK+C,KAG3DL,EAGT,QAASuB,GAAW/H,EAAMoG,GACxB,GAAIsB,GAAUrC,EAAUqC,UACrBpB,YAAYF,GACZlH,MAAM,oBACNgI,YAAY,8CACZE,GAAG,OACH5B,OAAO,KAEVH,GAAUoB,KAAKiB,GACZ5D,KAAK,WACJ,GAAIzF,GAAKV,EAAGqB,OAAO6I,OAAOvF,QAAQtC,EAC9B3B,IAAM,IACRV,EAAGqB,OAAO6I,OAAOvJ,OAAOD,EAAI,GAC5BjB,EAAU+L,WAAWxL,EAAGJ,KAAKqC,GAAIjC,EAAGD,QAAQkC,GAAIjC,EAAGqB,QAAQ8E,KAAK+C,MAKxE,QAASA,KACP,GAAImB,GAAQlC,EAASmC,SAClBf,YAAY,SACZgB,SAAS,eAEZ,OAAOpC,GAASW,KAAKuB,GAvIvB,GAAIrK,GAAKY,IAETZ,GAAGuI,SAAU,EACbvI,EAAGJ,KAAO,KACVI,EAAGqL,UAAY,KACfrL,EAAGD,QAAU,KACbC,EAAGqB,OAAS,KACZrB,EAAGuB,MAAQ,KAEXvB,EAAGwI,YAAcA,EACjBxI,EAAGmJ,YAAcA,EACjBnJ,EAAGgK,QAAUA,EACbhK,EAAGiK,SAAWA,EACdjK,EAAGoK,WAAaA,EAEhBzK,IAZFoL,EAAqBlK,SAAW,SAAU,eAAgB,YAAa,IAAK,YAAa,WAAY,MATrGzB,QACGC,OAAO,eACP6B,WAAW,uBAAwB6J,MAiJxC,WACE,YAOA,SAASU,GAA2B/D,EAAWrG,GAY7C,QAASsG,KACPD,EAAUE,KAAK5H,EAAGqB,QAGpB,QAASwG,KACPH,EAAUG,SAGZ,QAAS4C,GAAUC,GAEjB,GAAIC,KACJ3K,GAAGqB,OAAOqJ,GAAOzK,KAAK0K,GAGxB,QAASC,GAAaF,EAAOC,GAC3B,GAAIjK,GAAKV,EAAGqB,OAAOqJ,GAAO/F,QAAQgG,EAC9BjK,IAAM,GACRV,EAAGqB,OAAOqJ,GAAO/J,OAAOD,EAAI,GAIhC,QAASmK,KAEP,GAAItJ,KACJvB,GAAGqB,OAAOhB,OAAOJ,KAAKsB,GAGxB,QAASuJ,GAAYvJ,GACnB,GAAIb,GAAKV,EAAGqB,OAAOhB,OAAOsE,QAAQpD,EAC9Bb,IAAM,GACRV,EAAGqB,OAAOhB,OAAOM,OAAOD,EAAI,GAzChC,GAAIV,GAAKY,IAETZ,GAAGqB,OAASA,EAEZrB,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EACZ7H,EAAGyK,UAAYA,EACfzK,EAAG4K,aAAeA,EAClB5K,EAAG6K,SAAWA,EACd7K,EAAG8K,YAAcA,EALnBW,EAA2B5K,SAAW,YAAa,UAVnDzB,QACGC,OAAO,eACP6B,WAAW,6BAA8BuK,MAoD9C,WACE,YAOA,SAASC,GAAsBzD,EAAQC,EAAczI,EAAWC,EAAGgI,EAAWS,EAAU6C,GAmBtF,QAASrL,KACPK,EAAGJ,KAAOH,EAAUwL,QAAQ/C,EAAaE,QACzCpI,EAAGD,QAAUN,EAAUyL,WAAWhD,EAAaE,OAAQF,EAAa4B,WAEpE9J,EAAGJ,KAAKsG,SAASC,KAAK,WACpBnG,EAAGqL,UAAY5L,EAAU6I,SAAStI,EAAGJ,KAAKS,QAAS,QAAS,YAAa,oBAG3EL,EAAGD,QAAQmG,SAASC,KAAK,WACvBnG,EAAGuB,MAAQ9B,EAAU6I,SAAStI,EAAGD,QAAQM,QAAS,YAAa,gBAAiB,YAGlF2K,EAAGM,KAAKtL,EAAGJ,KAAKsG,SAAUlG,EAAGD,QAAQmG,WAAWC,KAAK,WACnDnG,EAAGuI,SAAU,IAIjB,QAASC,GAAYC,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,oCACb4H,QAEE7I,QAASX,QAAQiD,KAAKrC,EAAGD,UAE3BmB,WAAY,8BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EASnC,OAPAG,GAAc1C,KAAK,SAAUwF,GAE3BvM,QAAQ4J,OAAOhJ,EAAGD,QAAS4L,GAE3BlM,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIjC,EAAGD,SAASoG,KAAK+C,KAG9CL,EAGT,QAASM,GAAYV,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,8DACb4H,QAEEpB,QAASpI,QAAQiD,KAAKrC,EAAGD,QAAQyH,UAEnCtG,WAAY,8BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAUiD,GAE3BpJ,EAAGD,QAAQyH,QAAU4B,EAErB3J,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIjC,EAAGD,SAASoG,KAAK+C,KAIvD,QAAS0C,GAAUnD,GACjB,GAAIa,GAAS5B,EAAU4B,SACpBX,YAAYF,GACZlH,MAAM,iBACNgI,YAAY,+CACZC,YAAY,iBACZC,GAAG,UACH5B,OAAO,UAENgB,EAAgBnB,EAAUoB,KAAKQ,GAE/BI,EAAcb,EAAc1C,KAAK,SAAU0F,GAC7C,GAAIxK,GAAS5B,EAAU+F,cASvB,OARAnE,GAAOwK,aAAeA,EACtBxK,EAAOhB,OAASjB,QAAQiD,KAAKrC,EAAGD,QAAQM,QACxCgB,EAAOd,QAAUnB,QAAQiD,KAAKrC,EAAGD,QAAQQ,SACzCc,EAAOb,aAAepB,QAAQiD,KAAKrC,EAAGD,QAAQS,cAC9Ca,EAAOoE,gBAAkBrG,QAAQiD,KAAKrC,EAAGD,QAAQ0F,iBAEjDzF,EAAGD,QAAQwF,QAAQtF,KAAKoB,GAEjB5B,EAAU+L,WAAWxL,EAAGJ,KAAKqC,GAAIjC,EAAGD,QAAQkC,GAAIZ,IAGzDqI,GAAYvD,KAAK+C,GAEjBQ,EAAYvD,KAAK,SAAU9E,GACzB4G,EAAO4B,GAAG,iBAAmBzB,OAAQpI,EAAGJ,KAAKqC,GAAI6H,UAAW9J,EAAGD,QAAQkC,GAAImJ,SAAU/J,EAAOY,OAIhG,QAASyD,GAAarE,EAAQoH,GAC5B,GAAIsB,GAAUrC,EAAUqC,UACrBpB,YAAYF,GACZlH,MAAM,oBACNgI,YAAY,gDACZE,GAAG,OACH5B,OAAO,KAEVH,GAAUoB,KAAKiB,GACZ5D,KAAK,WACJ,GAAIzF,GAAKV,EAAGD,QAAQwF,QAAQZ,QAAQtD,EAChCX,IAAM,IACRV,EAAGD,QAAQwF,QAAQ5E,OAAOD,EAAI,GAC9BjB,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIjC,EAAGD,SAASoG,KAAK+C,MAK3D,QAASc,GAAQvB,GACf,GAAIpG,KACJ4H,GAAS5H,EAAMoG,GAAQtC,KAAK,WAC1BnG,EAAGD,QAAQmK,OAAOjK,KAAKoC,KAI3B,QAAS4H,GAAS5H,EAAMoG,GACtB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,iCACb4H,QAEEvG,KAAMjD,QAAQiD,KAAKA,IAErBnB,WAAY,2BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EASnC,OAPAG,GAAc1C,KAAK,SAAUgE,GAE3B/K,QAAQ4J,OAAO3G,EAAM8H,GAErB1K,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIjC,EAAGD,SAASoG,KAAK+C,KAG9CL,EAGT,QAASuB,GAAW/H,EAAMoG,GACxB,GAAIsB,GAAUrC,EAAUqC,UACrBpB,YAAYF,GACZlH,MAAM,oBACNgI,YAAY,8CACZE,GAAG,OACH5B,OAAO,KAEVH,GAAUoB,KAAKiB,GACZ5D,KAAK,WACJ,GAAIzF,GAAKV,EAAGD,QAAQmK,OAAOvF,QAAQtC,EAC/B3B,IAAM,IACRV,EAAGD,QAAQmK,OAAOvJ,OAAOD,EAAI,GAC7BjB,EAAUmK,YAAY5J,EAAGJ,KAAKqC,GAAIjC,EAAGD,SAASoG,KAAK+C,MAK3D,QAASA,KACP,GAAImB,GAAQlC,EAASmC,SAClBf,YAAY,SACZgB,SAAS,eAEZ,OAAOpC,GAASW,KAAKuB,GAxLvB,GAAIrK,GAAKY,IAETZ,GAAGuI,SAAU,EACbvI,EAAGJ,KAAO,KACVI,EAAGqL,UAAY,KACfrL,EAAGD,QAAU,KACbC,EAAGuB,MAAQ,KAEXvB,EAAGwI,YAAcA,EACjBxI,EAAGmJ,YAAcA,EACjBnJ,EAAG4L,UAAYA,EACf5L,EAAG0F,aAAeA,EAClB1F,EAAGgK,QAAUA,EACbhK,EAAGiK,SAAWA,EACdjK,EAAGoK,WAAaA,EAEhBzK,IAXF+L,EAAsB7K,SAAW,SAAU,eAAgB,YAAa,IAAK,YAAa,WAAY,MAXtGzB,QACGC,OAAO,eACP6B,WAAW,wBAAyBwK,MAkMzC,WACE,YAOA,SAASI,GAA4BpE,EAAW3H,GAY9C,QAAS4H,KACPD,EAAUE,KAAK5H,EAAGD,SAGpB,QAAS8H,KACPH,EAAUG,SAGZ,QAAS4C,GAAUC,GAEjB,GAAIC,KACJ3K,GAAGD,QAAQ2K,GAAOzK,KAAK0K,GAGzB,QAASC,GAAaF,EAAOC,GAC3B,GAAIjK,GAAKV,EAAGD,QAAQ2K,GAAO/F,QAAQgG,EAC/BjK,IAAM,GACRV,EAAGD,QAAQ2K,GAAO/J,OAAOD,EAAI,GAIjC,QAASmK,KAEP,GAAItJ,KACJvB,GAAGD,QAAQM,OAAOJ,KAAKsB,GAGzB,QAASuJ,GAAYvJ,GACnB,GAAIb,GAAKV,EAAGD,QAAQM,OAAOsE,QAAQpD,EAC/Bb,IAAM,GACRV,EAAGD,QAAQM,OAAOM,OAAOD,EAAI,GAzCjC,GAAIV,GAAKY,IAETZ,GAAGD,QAAUA,EAEbC,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EACZ7H,EAAGyK,UAAYA,EACfzK,EAAG4K,aAAeA,EAClB5K,EAAG6K,SAAWA,EACd7K,EAAG8K,YAAcA,EAHnBgB,EAA4BjL,SAAW,YAAa,WAZpDzB,QACGC,OAAO,eACP6B,WAAW,8BAA+B4K,MAoD/C,WACE,YAOA,SAASC,GAAyBrE,EAAWrF,GAQ3C,QAASsF,KACPD,EAAUE,KAAK5H,EAAGqC,MAGpB,QAASwF,KACPH,EAAUG,SAZZ,GAAI7H,GAAKY,IAETZ,GAAGqC,KAAOA,EAEVrC,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EAEdkE,EAAyBlL,SAAW,YAAa,QAbjDzB,QACGC,OAAO,eACP6B,WAAW,2BAA4B6K,MAsB5C,WACE,YAEA3M,SACGC,OAAO,YACN,kBAKN,WACE,YA0BA,SAAS2M,KAPP,QAASC,GAAiBC,EAAWxM,GA2CnC,QAASyM,KACP,MAAO9H,GAAO,IAQhB,QAASA,GAAOtB,GACd,MAAOqJ,GAAanG,KAAMoG,EAAGtJ,EAAOuJ,IAAK,KAa3C,QAASrB,GAAQ7C,GACf,GAAIhJ,QAAQmN,YAAYnE,GACtB,KAAM,IAAIoE,WAAU,iCAGtB,IAAI5M,GAAOwM,EAAanG,KAAMmC,OAAQA,GAItC,OAFAxI,GAAKsG,SAASC,KAAKsG,GAEZ7M,EAcT,QAASsL,GAAW9C,EAAQ0B,GAC1B,GAAI1K,QAAQmN,YAAYnE,IAAWhJ,QAAQmN,YAAYzC,GACrD,KAAM,IAAI0C,WAAU,qCAGtB,IAAIzM,GAAU2M,EAAgBzG,KAAMmC,OAAQA,EAAQ0B,UAAWA,GAI/D,OAFA/J,GAAQmG,SAASC,KAAKwG,GAEf5M,EAeT,QAASoL,GAAU/C,EAAQ0B,EAAWsB,GACpC,GAAIhM,QAAQmN,YAAYnE,IAAWhJ,QAAQmN,YAAYzC,IAAc1K,QAAQmN,YAAYnB,GACvF,KAAM,IAAIoB,WAAU,oCAGtB,IAAInL,GAASuL,EAAe3G,KAAMmC,OAAQA,EAAQ0B,UAAWA,EAAWsB,SAAUA,GAIlF,OAFA/J,GAAO6E,SAASC,KAAK0G,GAEdxL,EAQT,QAASyL,KACP,GAAIlN,GAAO,GAAIwM,EAIf,OAHAK,GAAU7M,GACVA,EAAKS,OAAOJ,SACZL,EAAKW,QAAQN,SACNL,EAQT,QAASQ,KACP,GAAIL,GAAU,GAAI2M,EAClB,OAAOC,GAAa5M,GAQtB,QAASyF,KACP,GAAInE,GAAS,GAAIuL,EACjB,OAAOC,GAAYxL,GASrB,QAAS0L,KACP,OAAQC,UAAUC,QAChB,IAAK,GAAG,MAAOhE,GAASiE,MAAM,KAAMF,UACpC,KAAK,GAAG,MAAOpD,GAAYsD,MAAM,KAAMF,UACvC,KAAK,GAAG,MAAOxB,GAAW0B,MAAM,KAAMF,WAExC,KAAM,IAAIR,WAAU,0CAStB,QAASvD,GAASrJ,GAChB,KAAMA,YAAgBwM,IACpB,KAAM,IAAIe,OAAM,oCAIlB,OAAOvN,GAAKqC,GACRrC,EAAKwN,UACLxN,EAAKyN,QAUX,QAASzD,GAAYxB,EAAQrI,GAC3B,IAAKqI,EACH,KAAM,IAAI+E,OAAM,sBAGlB,MAAMpN,YAAmB2M,IACvB,KAAM,IAAIS,OAAM,uCAGlB,OAAOpN,GAAQkC,GACXlC,EAAQqN,SAAUhF,OAAQA,IAC1BrI,EAAQsN,OAAQjF,OAAQA,IAW9B,QAASoD,GAAWpD,EAAQ0B,EAAWzI,GACrC,IAAK+G,EACH,KAAM,IAAI+E,OAAM,sBAGlB,KAAKrD,EACH,KAAM,IAAIqD,OAAM,yBAGlB,MAAM9L,YAAkBuL,IACtB,KAAM,IAAIO,OAAM,sCAGlB,OAAO9L,GAAOY,GACVZ,EAAO+L,SAAUhF,OAAQA,EAAQ0B,UAAWA,IAC5CzI,EAAOgM,OAAQjF,OAAQA,EAAQ0B,UAAWA,IAQhD,QAASwD,GAAWlF,GAClB,GAAImF,GAAWnB,EAAAA,WAAsBnK,GAAImG,GACzC,OAAOmF,GAASrH,SASlB,QAASsH,GAAYC,GA6BnB,MA5BKA,GAAOpN,OAGVoN,EAAOpN,OAAOP,QAAQ,SAAUyB,GAC9BA,EAAMY,KAAOZ,EAAMY,KAAKuL,gBAH1BD,EAAOpN,UAOJoN,EAAOlN,QAGVkN,EAAOlN,QAAQT,QAAQ,SAAUkG,GAC/BA,EAAO2H,KAAO3H,EAAO2H,KAAKD,gBAH5BD,EAAOlN,WAOJkN,EAAOjN,aAGViN,EAAOjN,aAAaV,QAAQ,SAAUkG,GACpCA,EAAO2H,KAAO3H,EAAO2H,KAAKD,gBAH5BD,EAAOjN,gBAOJiN,EAAOvD,SACVuD,EAAOvD,WAGFuD,EAST,QAAShB,GAAU7M,GASjB,MARA4N,GAAY5N,GAEPA,EAAKC,SAGRD,EAAKC,SAASC,QAAQ6M,GAFtB/M,EAAKC,YAKAD,EAST,QAAS+M,GAAa5M,GASpB,MARAyN,GAAYzN,GAEPA,EAAQwF,QAGXxF,EAAQwF,QAAQzF,QAAQ+M,GAFxB9M,EAAQwF,WAKHxF,EAST,QAAS8M,GAAYxL,GAGnB,MAFAmM,GAAYnM,GAELA,EAWT,QAASuM,GAAyBvN,EAAQwN,GAKxC,MAJKzO,SAAQgG,QAAQyI,KACnBA,GAASA,IAGJA,EAAMC,OAAO,SAAUC,EAAO5L,GACnC,MAAO4L,IAASrO,EAAEsO,KAAK3N,GAAU8B,KAAMA,KACtC,MA3VL,GAAIiK,GAAeF,EAAU+B,EAAS7L,IAAM,YAAcgG,OAAQ,QAChE8F,QACEC,OAAQ,SAIRzB,EAAkBR,EAAU+B,EAAS7L,IAAM,gCAAkC0H,UAAW,QAC1FoE,QACEC,OAAQ,SAIRvB,EAAiBV,EAAU+B,EAAS7L,IAAM,kDAAoDgJ,SAAU,QAC1G8C,QACEC,OAAQ,SAIRC,IAiBJ,OAhBAA,GAAKC,OAASlC,EACdiC,EAAK/J,OAASA,EACd+J,EAAKnI,IAAMgF,EACXmD,EAAKnD,QAAUA,EACfmD,EAAKlD,WAAaA,EAClBkD,EAAKjD,UAAYA,EACjBiD,EAAKE,OAASxB,EACdsB,EAAKtB,WAAaA,EAClBsB,EAAKhO,cAAgBA,EACrBgO,EAAK5I,aAAeA,EACpB4I,EAAKrB,KAAOA,EACZqB,EAAKnF,SAAWA,EAChBmF,EAAKxE,YAAcA,EACnBwE,EAAK5C,WAAaA,EAClB4C,EAAAA,UAAcd,EACdc,EAAK9F,SAAWsF,EACTQ,EA5BTnC,EAAiBpL,SAAW,YAAa,IAdzC,IAAIoN,KAGJ,OAFAA,GAAS7L,IAAM,aACf6L,EAASM,KAAOtC,EACTgC,EAdT7O,QACGC,OAAO,YACP4O,SAAS,YAAajC,MAkX3B,WACE,YAEA5M,SACGC,OAAO,YACN,kBAmDN,WACE,YAwBA,SAASmP,KARP,QAASC,GAAiBvC,GAgBxB,QAASwC,GAAQC,GACfA,EAASA,GAAU,QAEnB,IAAIC,GAAWC,EAAiB5I,KAAM0I,OAAQA,IAE1CG,GACF5I,SAAU0I,EAAS1I,SAASC,KAAK,WAC/B,MAAO2I,KAETF,SAAUA,EACVG,SAAU,SAAUC,EAASC,GAC3B,MAAOF,GAASJ,EAAQK,EAASC,IAIrC,OAAOH,GAaT,QAASC,GAASJ,EAAQK,EAASC,GAEjC,MADAA,GAAUA,MACHC,EAAajJ,KAClB0I,OAAQA,EACRQ,MAAOH,EACPI,MAAOH,EAAQG,MACf9C,IAAK2C,EAAQ3C,MAWjB,QAAS+C,GAAWC,EAAMD,GACxB,GAAIC,EAAKH,QAAUE,EAAWE,YAC5B,KAAM,IAAIpC,OAAM,eAAiBkC,EAAWE,YAAc,OAASF,EAAWG,YAAc,8CAAgDF,EAAKH,MAGnJ,IAAIM,GAASP,EAAanC,MACxB2C,OAAQJ,EAAKI,SAEbP,MAAOE,EAAWG,YAElBG,SAAU,MAQZ,OAJAF,GAAOvJ,SAASC,KAAK,SAAUyJ,GAC7BxQ,QAAQ4J,OAAOsG,EAAMM,KAGhBH,EA9ET,GAAIZ,GAAmB3C,EAAU+B,EAAS7L,IAAM,qBAAuBuM,OAAQ,WAC3EO,EAAehD,EAAU+B,EAAS7L,IAAM,0BAA4BuM,OAAQ,SAAUe,OAAQ,YAE9FtB,IAIJ,OAHAA,GAAKnI,IAAMyI,EACXN,EAAKW,SAAWA,EAChBX,EAAKiB,WAAaA,EACXjB,EACTK,EAAiB5N,SAAW,YAf5B,IAAIoN,KAGJ,OAFAA,GAAS7L,IAAM,aACf6L,EAASM,KAAOE,EACTR,EAXT7O,QACGC,OAAO,YACP4O,SAAS,YAAaO,MAkG3B,WACE,YAEApP,SACGC,OAAO,UACN,kBAyFN,WACE,YAuBA,SAASwQ,KATP,QAASC,GAAkB9E,EAAIkB,GAoB7B,QAAS6D,KACP,GAAIvJ,GAAS,GAAI4F,EACjB,OAAO4D,GAAYxJ,GAQrB,QAASyJ,KACP,GAAIC,KACJ,OAAOC,GAAUD,GAQnB,QAASE,KACP,GAAI/J,KACJ,OAAOgK,GAAUhK,GAQnB,QAASiK,KACP,GAAIC,KACJ,OAAOC,GAAWD,GAQpB,QAASE,KACP,GAAIC,KACJ,OAAOA,GAaT,QAASC,GAAS1O,GAChB,MAAOmK,GAAanG,KAAMhE,GAAIA,IAShC,QAASoC,GAAOtB,GACd,MAAOqJ,GAAanG,KAAMoG,EAAGtJ,IAY/B,QAAS6N,GAAWpK,GAClB,GAAIqK,EAOJ,OALEA,GADErK,EAAOvE,GACEmK,EAAa8B,QAASjM,GAAIuE,EAAOvE,IAAMuE,GAEvC4F,EAAaW,KAAK,KAAMvG,GAG9BqK,EAAS3K,SAASC,KAAK,SAAU2K,GAEtC,MADAtK,GAAOvE,GAAK6O,EAAS7O,GACduE,IAUX,QAASuK,GAAa9O,GACpB,GAAI4O,GAAWzE,EAAAA,WAAsBnK,GAAIA,GACzC,OAAO4O,GAAS3K,SASlB,QAAS8J,GAAYxJ,GA+BnB,MA9BKA,GAAO0J,KAGVC,EAAU3J,EAAO0J,MAFjB1J,EAAO0J,KAAOD,IAKXzJ,EAAOH,KAGVgK,EAAU7J,EAAOH,MAFjBG,EAAOH,KAAO+J,IAKX5J,EAAOwK,SAGVxK,EAAOwK,SAASlR,QAAQuQ,GAFxB7J,EAAOwK,YAKJxK,EAAOyK,MAGVT,EAAWhK,EAAOyK,OAFlBzK,EAAOyK,MAAQX,IAKZ9J,EAAO0K,MAGVV,EAAWhK,EAAO0K,OAFlB1K,EAAO0K,MAAQZ,IAKV9J,EAST,QAAS2J,GAAUD,GAKjB,MAJKA,GAAKiB,QACRjB,EAAKiB,UAGAjB,EAQT,QAASG,GAAUhK,GAEjB,MAAOA,GAST,QAASmK,GAAWD,GAKlB,MAJKA,GAAIxI,OACPwI,EAAIxI,KAAO0I,KAGNF,EArMT,GAAInE,GAAeF,EAAU+B,EAAS7L,IAAM,OAAQ,MAClD8L,QAAYC,OAAQ,SAGlBC,IAQJ,OAPAA,GAAKE,OAASyB,EACd3B,EAAKgC,WAAaA,EAClBhC,EAAKkC,YAAcA,EACnBlC,EAAKnI,IAAM0K,EACXvC,EAAK/J,OAASA,EACd+J,EAAKrB,KAAO6D,EACZxC,EAAAA,UAAc2C,EACP3C,EAHT0B,EAAkBjP,SAAW,KAAM,YAhBnC,IAAIoN,KAGJ,OAFAA,GAAS7L,IAAM,cACf6L,EAASM,KAAOuB,EACT7B,EATT7O,QACGC,OAAO,UACP4O,SAAS,aAAc4B,MAuN5B,WACE,YAwBA,SAASuB,KAHP,QAASC,GAAuB7R,EAAQqG,GAWtC,QAASyL,KACP,GAAIC,GAAU1L,EAAWuK,YACzB5Q,GAAOgH,OAAOwK,SAAS/Q,KAAKsR,GAQ9B,QAASC,GAAW9Q,GAClBlB,EAAOgH,OAAOwK,SAASrQ,OAAOD,EAAI,GAQpC,QAAS+Q,GAAS1M,GAChB,GAAI2M,GAAW7L,EAAWyK,aAC1B9Q,GAAOgH,OAAOzB,GAAO2M,EAQvB,QAASC,GAAY5M,GACnBvF,EAAOgH,OAAOzB,GAAO,KAxCvB,GAAI/E,GAAKY,IAETZ,GAAGsR,QAAUA,EACbtR,EAAGwR,WAAaA,EAChBxR,EAAGyR,SAAWA,EACdzR,EAAG2R,YAAcA,EAFnBN,EAAuBxQ,SAAW,SAAU,aAjB5C,IAAIC,IACFC,SAAU,IACVC,YAAa,iCACbC,OACEuF,OAAQ,YAEVtF,WAAYmQ,EACZlQ,aAAc,eAGhB,OAAOL,GAhBT1B,QACGC,OAAO,UACPyB,UAAU,kBAAmBsQ,MAiElC,WACE,YAOA,SAASQ,KAaP,QAASC,KACP,GAAI7R,GAAKY,IAETZ,GAAG8R,QACC9M,MAAO,YAAasB,MAAO,mBAC3BtB,MAAO,YAAasB,MAAO,cAC3BtB,MAAO,SAAUsB,MAAO,gBACxBtB,MAAO,cAAesB,MAAO,yBAC7BtB,MAAO,WAAYsB,MAAO,aAC1BtB,MAAO,WAAYsB,MAAO,kBArBhC,GAAIxF,IACFC,SAAU,IACVC,YAAa,+BACbC,OACEoF,KAAM,YAERnF,WAAY2Q,EACZ1Q,aAAc,aAGhB,OAAOL,GAhBT1B,QACGC,OAAO,UACPyB,UAAU,gBAAiB8Q,MAgChC,WACE,YAOA,SAASG,KACP,GAAIjR,IACFC,SAAU,IACVC,YAAa,gCACbC,OACEqG,MAAO,YAIX,OAAOxG,GAdT1B,QACGC,OAAO,UACPyB,UAAU,iBAAkBiR,MAiBjC,WACE,YAOA,SAASC,GAAe/J,EAAQgK,EAAYC,EAAWlH,GAsBrD,QAASrL,KACPK,EAAG8O,KAAOoD,EAAUjM,MAEpBjG,EAAG8O,KAAK5I,SAASC,KAAK,SAAU2I,GAC9B,GAAIqD,KAEJ/S,SAAQU,QAAQgP,EAAKF,SAASwD,OAAQ,SAAUjD,GAC9C,GAAIkD,GAAkBC,EAAWxD,EAAMK,EAAMlN,GAC7CkQ,GAAiBlS,KAAKoS,KAGxBrH,EAAGM,IAAI6G,GAAkBhM,KAAK,WAC5BnG,EAAGuI,SAAU,MAKnB,QAASgK,KACPN,EAAW,QAAQO,SAGrB,QAASC,GAAUnD,EAAM7G,GACvBA,EAAOiK,2BAGPzK,EAAO4B,GAAG,eAAiBzB,OAAQkH,EAAKqD,WAG1C,QAASC,GAAetD,EAAMD,EAAY5G,GACxCA,EAAOiK,0BAEP,IAAIG,GAAcX,EAAU7C,WAAWC,EAAMD,EAC7CwD,GAAY3M,SAASC,KAAK,WACxBmM,EAAWtS,EAAG8O,KAAMO,EAAWE,aAC/B+C,EAAWtS,EAAG8O,KAAMO,EAAWG,eAInC,QAAS8C,GAAWxD,EAAME,GACxB,GAAI8D,GAAQhE,EAAKC,SAASC,GAAW1C,IAAK,MAM1C,OAJAwG,GAAM5M,SAASC,KAAK,WAClBnG,EAAG+S,UAAU/D,GAAW8D,EAAMnM,MAAMsG,OAAS,EAAI6F,EAAQ,OAGpDA,EAAM5M,SAlEf,GAAIlG,GAAKY,IAGTZ,GAAGgT,YACD,SACA,SACA,aACA,UACA,YAGFhT,EAAGuI,SAAU,EACbvI,EAAG+S,aACH/S,EAAG8O,KAAO,KAEV9O,EAAGuS,SAAWA,EACdvS,EAAGyS,UAAYA,EACfzS,EAAGqP,WAAauD,EAEhBjT,IAPFqS,EAAenR,SAAW,SAAU,aAAc,YAAa,MAlB/DzB,QACGC,OAAO,eACP6B,WAAW,iBAAkB8Q,MA4ElC,WACE,YAEA5S,SACGC,OAAO,qBAIZ,WACG,YAOA,SAAS4T,KAWN,QAASlM,GAAS9F,EAAOiS,EAAIC,GAC1B,GAAIC,GAAWC,SAASF,EAAKG,sBAAwB,GACrDrS,GAAMsS,OAAO,SAAU,SAAUC,GAC1BA,EACDN,EAAGO,OAAOC,UAAUN,GAEpBF,EAAGO,OAAOE,QAAQP,KAhB3B,GAAItS,IACDC,SAAU,IACVE,OACGuS,OAAQ,gBAEXrM,KAAMJ,EAGT,OAAOjG,GAdV1B,QACIC,OAAO,eACPyB,UAAU,cAAemS,MA4BhC,WACE,YAOA,SAASW,GAAqB/N,EAAYqC,EAAcR,EAAWS,GAYjE,QAASxI,KACPK,EAAGwG,OAASX,EAAWI,IAAIiC,EAAajG,IAG1C,QAAS4R,GAAYpL,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,qCACb4H,QAEEpC,OAAQpH,QAAQiD,KAAKrC,EAAGwG,SAE1BtF,WAAY,6BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAU2N,GAE3B1U,QAAQ4J,OAAOhJ,EAAGwG,OAAQsN,GAE1BjO,EAAWkH,KAAK/M,EAAGwG,QAAQL,KAAK+C,KAIpC,QAAS6K,GAAUrJ,EAAOjC,GACxB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,oCACb4H,QAEEtB,MAAOlI,QAAQiD,KAAKrC,EAAGwG,OAAOkE,KAEhCxJ,WAAY,4BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAU6N,GAE3B5U,QAAQ4J,OAAOhJ,EAAGwG,OAAOkE,GAAQsJ,GAEjCnO,EAAWkH,KAAK/M,EAAGwG,QAAQL,KAAK+C,KAIpC,QAASC,GAAYV,GACnB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,8DACb4H,QAEEpB,QAASpI,QAAQiD,KAAKrC,EAAGwG,OAAOgB,UAElCtG,WAAY,8BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,EAEnCG,GAAc1C,KAAK,SAAUiD,GAE3BpJ,EAAGwG,OAAOgB,QAAU4B,EAEpBvD,EAAWkH,KAAK/M,EAAGwG,QAAQL,KAAK+C,KAIpC,QAASA,KACP,GAAImB,GAAQlC,EAASmC,SAClBf,YAAY,SACZgB,SAAS,eAEZ,OAAOpC,GAASW,KAAKuB,GAtFvB,GAAIrK,GAAKY,IAETZ,GAAGuI,SAAU,EACbvI,EAAGwG,OAAS,KAEZxG,EAAG6T,YAAcA,EACjB7T,EAAG+T,UAAYA,EACf/T,EAAGmJ,YAAcA,EAEjBxJ,IAIFiU,EAAqB/S,SAAW,aAAc,eAAgB,YAAa,YAnB3EzB,QACGC,OAAO,eACP6B,WAAW,uBAAwB0S,MAgGxC,WACE,YAOA,SAASK,GAA2BpO,EAAY6B,EAAWlB,GAkBzD,QAASmB,KACPD,EAAUE,KAAK5H,EAAGwG,QAGpB,QAASqB,KACPH,EAAUG,SAGZ,QAASyJ,KACP,GAAIjL,GAAOR,EAAWuK,YACtBpQ,GAAGwG,OAAOwK,SAAS/Q,KAAKoG,GAG1B,QAAS6N,GAAW7N,GAClB,GAAI3F,GAAKV,EAAGwG,OAAOwK,SAASrM,QAAQ0B,EAChC3F,IAAM,GACRV,EAAGwG,OAAOwK,SAASrQ,OAAOD,EAAI,GAjClC,GAAIV,GAAKY,IAETZ,GAAGwG,OAASA,EACZxG,EAAGmU,YAEGnP,MAAO,YAAasB,MAAO,cAC3BtB,MAAO,SAAUsB,MAAO,gBACxBtB,MAAO,cAAesB,MAAO,yBAC7BtB,MAAO,WAAYsB,MAAO,aAC1BtB,MAAO,WAAYsB,MAAO,kBAGhCtG,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EACZ7H,EAAGsR,QAAUA,EACbtR,EAAGkU,WAAaA,EADlBD,EAA2BpT,SAAW,aAAc,YAAa,UApBjEzB,QACGC,OAAO,eACP6B,WAAW,6BAA8B+S,MA4C9C,WACE,YAOA,SAASG,GAA0B1M,EAAWJ,GAQ5C,QAASK,KACPD,EAAUE,KAAK5H,EAAGsH,OAGpB,QAASO,KACPH,EAAUG,SAZZ,GAAI7H,GAAKY,IAETZ,GAAGsH,MAAQA,EAEXtH,EAAG2H,MAAQA,EACX3H,EAAG6H,OAASA,EAUduM,EAA0BvT,SAAW,YAAa,SArBlDzB,QACGC,OAAO,eACP6B,WAAW,4BAA6BkT,MAsB7C,WACE,YAOA,SAASC,GAAe5U,EAAWoG,EAAYoC,EAAQC,EAAc+J,EAAYvS,EAAGsL,EAAItD,EAAWS,GAajG,QAASxI,KACHuI,EAAamE,IACfrM,EAAGsU,YAAcpM,EAAamE,EAC9BhI,EAAOrE,EAAGsU,cAId,QAAS/B,KACPN,EAAW,QAAQO,SAGrB,QAASnO,GAAOtB,GACd/C,EAAGuI,SAAU,EAEbvI,EAAGuU,cAAgB1O,EAAWxB,OAAOtB,GACrC/C,EAAGwU,aAAe/U,EAAU4E,OAAOtB,GAEnCiI,EAAGM,KACDtL,EAAGuU,cAAcrO,SACjBlG,EAAGwU,aAAatO,WAEfC,KAAK,WACJnG,EAAGuI,SAAU,IAInB,QAASwH,GAAatH,GACpB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,qCACb4H,QACEpC,OAAQX,EAAWyI,UAErBpN,WAAY,6BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,GAE/BgB,EAAcb,EAAc1C,KAAK,SAAUK,GAC7C,MAAOX,GAAWkH,KAAKvG,IAGzBkD,GAAYvD,KAAK+C,GAEjBQ,EAAYvD,KAAK,SAAUK,GACzByB,EAAO4B,GAAG,iBAAmB5H,GAAIuE,EAAOvE,OAI5C,QAAS6K,GAAWrE,GAClB,GAAIC,IACFC,YAAaF,EACbzH,YAAa,iCACb4H,QACEhJ,KAAMH,EAAUqN,cAElB5L,WAAY,2BACZC,aAAc,MAGZ0H,EAAgBnB,EAAUoB,KAAKJ,GAE/BgB,EAAcb,EAAc1C,KAAK,SAAUvG,GAC7C,MAAOH,GAAUwJ,SAASrJ,IAG5B8J,GAAYvD,KAAK+C,GAEjBQ,EAAYvD,KAAK,SAAUvG,GACzBqI,EAAO4B,GAAG,eAAiBzB,OAAQxI,EAAKqC,OAI5C,QAASiH,KACP,GAAImB,GAAQlC,EAASmC,SAClBf,YAAY,SACZgB,SAAS,eAEZ,OAAOpC,GAASW,KAAKuB,GA3FvB,GAAIrK,GAAKY,IAETZ,GAAGuI,SAAU,EACbvI,EAAGsU,YAAc,GAEjBtU,EAAGuS,SAAWA,EACdvS,EAAG+P,aAAeA,EAClB/P,EAAG8M,WAAaA,EAChB9M,EAAGqE,OAAS3E,EAAE+U,SAASpQ,EAAQ,KAE/B1E,IAMF0U,EAAexT,SAAW,YAAa,aAAc,SAAU,eAAgB,aAAc,IAAK,KAAM,YAAa,YAtBrHzB,QACGC,OAAO,eACP6B,WAAW,iBAAkBmT,MAoGlC,WACE,YAOA,SAASK,GAAS5N,GAChBA,EAAK6N,MAAM,gBAiBbD,EAAS7T,SAAW,QAvBpBzB,QACGC,OAAO,eACPuV,IAAIF,MAST,WACE,YAOA,SAASG,GAAaC,EAAgBC,GACpCD,EACGE,MAAM,UACL5S,IAAK,MACLpB,YAAa,qBACbE,WAAY,iBACZC,aAAc,OAGf6T,MAAM,iBACL5S,IAAK,aACL6S,OACEC,MACElU,YAAa,yBACbE,WAAY,uBACZC,aAAc,SAKnB6T,MAAM,eACL5S,IAAK,gBACL6S,OACEC,MACElU,YAAa,qBACbE,WAAY,qBACZC,aAAc,SAInB6T,MAAM,kBACL5S,IAAK,oCACL6S,OACEC,MACElU,YAAa,wBACbE,WAAY,wBACZC,aAAc,SAInB6T,MAAM,iBACL5S,IAAK,sDACL6S,OACEC,MACElU,YAAa,uBACbE,WAAY,uBACZC,aAAc,SAKnB6T,MAAM,QACL5S,IAAK,QACLpB,YAAa,qBACbE,WAAY,iBACZC,aAAc,OAGlB4T,EAAmBI,UAAU,KAvC/BN,EAAahU,SAAW,iBAAkB,sBAxB1CzB,QACGC,OAAO,eACP+V,OAAOP,MAmEZ,WACE,YAEAzV,SACGC,OAAO,eACPgW,SAAS,IAAK3V,GACd2V,SAAS,SAAUC,WAIxB,WACE,YAOA,SAASF,GAAOG,EAAkCC,EAAoBhH,EAAmBxC,EAAmB6D,GAE1G0F,EAAaE,cAAa,GAE1BD,EAAmBE,cAAc,aAC/BC,GAAM,UACNC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,KAAQ,UACRC,KAAQ,UACRC,KAAQ,UACRC,KAAQ,UAERC,qBAAsB,QACtBC,oBAAqB,UAGvBlB,EAAmBE,cAAc,UAC/BC,GAAM,UACNC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,IAAO,UACPC,KAAQ,UACRC,KAAQ,UACRC,KAAQ,UACRC,KAAQ,UAERC,qBAAsB,QACtBC,oBAAqB,KAAM,MAAO,MAAO,UAG3ClB,EAAmBmB,MAAM,WACtBC,eAAe,aACfC,cAAc,UAGjBrI,EAAkBpM,IAAM,wBACxB4J,EAAkB5J,IAAM,qBACxByN,EAAmBzN,IAAM,sBA/B3BgT,EAAOvU,SAAW,eAAgB,qBAAsB,oBAAqB,oBAAqB,sBAzBlGzB,QACGC,OAAO,eACP+V,OAAOA,MA2DZhW,QAAQC,OAAO,eAAeuV,KAAK,iBAAkB,SAASkC,GAAiBA,EAAeC,IAAI,qBAAqB,mrEACvHD,EAAeC,IAAI,oCAAoC;AACvDD,EAAeC,IAAI,qCAAqC,g5CACxDD,EAAeC,IAAI,yBAAyB,+5DAC5CD,EAAeC,IAAI,qBAAqB,0mDACxCD,EAAeC,IAAI,gCAAgC,40BACnDD,EAAeC,IAAI,+BAA+B,24BAClDD,EAAeC,IAAI,iCAAiC,kzCACpDD,EAAeC,IAAI,iCAAiC,8gBACpDD,EAAeC,IAAI,oCAAoC,4kFACvDD,EAAeC,IAAI,wBAAwB,y1GAC3CD,EAAeC,IAAI,mCAAmC,okFACtDD,EAAeC,IAAI,uBAAuB,01FAC1CD,EAAeC,IAAI,iCAAiC,irEACpDD,EAAeC,IAAI,qBAAqB,wuFACxCD,EAAeC,IAAI,8CAA8C,4PACjED,EAAeC,IAAI,8DAA8D,ikBACjFD,EAAeC,IAAI,oDAAoD,yCACvED,EAAeC,IAAI,uDAAuD,kVAC1ED,EAAeC,IAAI,qDAAqD,0sBACxED,EAAeC,IAAI,wDAAwD,kNAC3ED,EAAeC,IAAI,+DAA+D,m8BAClFD,EAAeC,IAAI,mDAAmD,8hCACtED,EAAeC,IAAI,yDAAyD;AAC5ED,EAAeC,IAAI,2EAA2E,+SAC9FD,EAAeC,IAAI,qDAAqD,uyBACxED,EAAeC,IAAI,uDAAuD,+7EAC1ED,EAAeC,IAAI,mDAAmD","file":"scripts/app-ec77301ace.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb', [\n      'ngAnimate',\n      'ngCookies',\n      // 'ngTouch',\n      'ngSanitize',\n      'ngMessages',\n      'ngAria',\n      'ngResource',\n      'ui.router',\n      'ckeditor',\n      'ngMaterial',\n      'slideToggle',\n      'trcWorks',\n      'trcTasks',\n      'trcBio'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('workEditor', workEditorDirective);\n\n  /** @ngInject */\n  function workEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/work-editor/work-editor.html',\n      scope: {\n        work: '=ngModel'\n      },\n      controller: WorkEditorController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function WorkEditorController($scope, worksRepo, _) {\n      var vm = this;\n\n      vm.editions = [];\n\n      vm.createEdition = createEdition;\n      vm.deleteEdition = deleteEdition;\n\n      activate();\n\n      function activate() {\n        $scope.work.editions.forEach(function (edition) {\n          vm.editions.push({\n            model: edition,\n            focused: false\n          });\n        });\n      }\n\n      function createEdition() {\n        var edition = worksRepo.createEdition();\n        edition.titles = _.cloneDeep($scope.work.titles);\n        edition.authors = _.cloneDeep($scope.work.authors);\n        edition.otherAuthors = _.cloneDeep($scope.work.otherAuthors);\n\n        $scope.work.editions.push(edition);\n        vm.editions.push({\n          model: edition,\n          focused: true\n        });\n      }\n\n      function deleteEdition(ix) {\n        vm.editions.splice(ix, 1);\n        $scope.work.editions.splice(ix, 1);\n      }\n    }\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('volumeEditor', volumeEditorDirective);\n\n  /** @ngInject */\n  function volumeEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/volume-editor/volume-editor.html',\n      scope: {\n        volume: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('titleEditor', titleEditorDirective);\n\n  /** @ngInject */\n  function titleEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/title-editor/title-editor.html',\n      scope: {\n        title: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('publicationInfoEditor', publicationInfoEditorDirective);\n\n  /** @ngInject */\n  function publicationInfoEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/publication-info-editor/publication-info-editor.html',\n      scope: {\n        pubInfo: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('copyEditor', copyEditorDirective);\n\n  /** @ngInject */\n  function copyEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/copy-editor/copy-editor.html',\n      scope: {\n        copy: '=ngModel'\n      },\n      controller: CopyEditorController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function CopyEditorController($scope) {\n      var vm = this;\n\n      vm.refHandlers = {};\n      vm.setProperties = parseProperties;\n\n      activate();\n\n      function activate() {\n        addHandler(HathiTrustRefHandler());\n        addHandler(GoogleBooksRefHandler());\n      }\n\n      function addHandler(handler) {\n        vm.refHandlers[handler.id] = handler;\n      }\n\n      function parseProperties(type, url) {\n        if (vm.refHandlers[type]) {\n          $scope.copy.properties = vm.refHandlers[type](url);\n        }\n\n        $scope.copyForm.url.$setValidity(type, $scope.copy.properties != null);\n      }\n    }\n  }\n\n  function HathiTrustRefHandler() {\n    function handle(url) {\n      var parsed = parseUrl(url);\n      if (!parsed) {\n        return null;\n      }\n\n      var id, seq;\n\n      switch (parsed.hostname) {\n        case 'babel.hathitrust.org':\n          id = parsed.query.id;\n          seq = parsed.query.seq;\n          break;\n\n        case 'hdl.handle.net':\n          id = parsed.path.substr(parsed.path.lastIndexOf('/') + 1);\n\n          if (!parsed.query.urlappend) {\n            break;\n          }\n\n          var subquery = parseQueryString(parsed.query.urlappend);\n          if (!subquery) {\n            break;\n          }\n          seq = subquery.seq;\n          break;\n      }\n\n      if (!id) {\n        return null;\n      }\n\n      return {\n        htid: id,\n        seq: seq\n      };\n    }\n\n    handle.id = 'hathitrust';\n    handle.display = 'HathiTrust';\n\n    return handle;\n  }\n\n  function GoogleBooksRefHandler() {\n    function handle(url) {\n      var parsed = parseUrl(url);\n      if (!parsed) {\n        return null;\n      }\n\n      switch (parsed.hostname) {\n        case 'books.google.com':\n          var id = parsed.query.id;\n          var section = parsed.query.printsec;\n          var page = parsed.query.pg;\n          break;\n      }\n\n      if (!id) {\n        return null;\n      }\n\n      return {\n        id: id,\n        section: section,\n        page: page\n      };\n    }\n\n    handle.id = 'googlebooks';\n    handle.display = 'Google Books';\n\n    return handle;\n  }\n\n  /**\n   * Parses a URL string into its components\n   *\n   * @param  {string} url\n   * @return {URL}\n   */\n  function parseUrl(url) {\n    if (!url) {\n      return null;\n    }\n\n    var parser = document.createElement('a');\n    parser.href = url;\n\n    return {\n      toString: function() {\n        return url;\n      },\n      protocol: parser.protocol,\n      host: parser.host,\n      hostname: parser.hostname,\n      port: parser.port,\n      path: parser.pathname,\n      query: parseQueryString(parser.search),\n      fragment: parser.hash\n    };\n  }\n\n  /**\n   * Parses a query string into key/value pairs\n   *\n   * @param {string} query\n   * @return {object.<string,any>}\n   */\n  function parseQueryString(query, sep) {\n    if (!query || !angular.isString(query)) {\n      return {};\n    }\n\n    // remove leading '?'\n    if (query[0] === '?') {\n      query = query.substr(1);\n    }\n\n    // attempt to auto-detect separator\n    if (!sep) {\n      // auto-detection \"bitmask\"\n      // 0 = none detected -- prefer '&'\n      // 1 = only ';' detected -- use it\n      // 2 = only '&' detected -- use it\n      // 3 = both detected -- prefer '&'\n      var flags = (query.indexOf(';') >= 0 ? 1 : 0) + (query.indexOf('&') >= 0 ? 2 : 0);\n      sep = flags === 1 ? ';' : '&';\n    }\n\n    var parsed = {};\n\n    var kvpairs = query.split(sep);\n    kvpairs.forEach(function (pair) {\n      var ix = pair.indexOf('=');\n      var key = pair;\n      var value = null;\n\n      if (!key) {\n        return;\n      }\n\n      if (ix >= 0) {\n        key = pair.substr(0, ix);\n        value = pair.substr(ix + 1);\n      }\n\n      try {\n        key = decodeURIComponent(key);\n        value = decodeURIComponent(value);\n      } catch (URIError) {\n        return;\n      }\n\n      // TODO: handle key array/map notation\n\n      if (parsed.hasOwnProperty(key)) {\n        // convert repeated keys into an array\n        if (angular.isArray(parsed[key])) {\n          parsed[key].push(value);\n        } else {\n          parsed[key] = [parsed[key], value];\n        }\n      } else {\n        parsed[key] = value;\n      }\n    });\n\n    return parsed;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('editionEditor', editionEditorDirective);\n\n  /** @ngInject */\n  function editionEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/edition-editor/edition-editor.html',\n      scope: {\n        edition: '=ngModel'\n      },\n      controller: EditionEditorController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function EditionEditorController($scope, worksRepo, _) {\n      var vm = this;\n\n      vm.volumes = [];\n\n      vm.createVolume = createVolume;\n      vm.deleteVolume = deleteVolume;\n\n      activate();\n\n      function activate() {\n        $scope.edition.volumes.forEach(function (volume) {\n          vm.volumes.push({\n            model: volume,\n            focused: false\n          });\n        });\n      }\n\n      function createVolume() {\n        var volume = worksRepo.createVolume();\n        volume.titles = _.cloneDeep($scope.edition.titles);\n        volume.authors = _.cloneDeep($scope.edition.authors);\n        volume.otherAuthors = _.cloneDeep($scope.edition.otherAuthors);\n        volume.publicationInfo = _.cloneDeep($scope.edition.publicationInfo);\n\n        $scope.edition.volumes.push(volume);\n        vm.volumes.push({\n          model: volume,\n          focused: true\n        });\n      }\n\n      function deleteVolume(ix) {\n        vm.volumes.splice(ix, 1);\n        $scope.edition.volumes.splice(ix, 1);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('authorRefEditor', authorRefEditorDirective);\n\n  /** @ngInject */\n  function authorRefEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/work/components/author-ref-editor/author-ref-editor.html',\n      scope: {\n        ref: '=ngModel'\n      },\n      controller: AuthorRefEditorController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function AuthorRefEditorController($scope, peopleRepo) {\n      var vm = this;\n\n      vm.linkAuthorSearchText = '';\n      vm.authorRoles = [\n        'author',\n        'editor',\n        'translator',\n        'other'\n      ];\n\n      vm.setLinkedAuthor = setLinkedAuthor;\n      vm.getResults = getResults;\n\n      activate();\n\n      function activate() {\n        if ($scope.ref.authorId) {\n          var author = peopleRepo.get($scope.ref.authorId);\n          author.$promise.then(function () {\n            vm.linkAuthorSearchText = author.name.label;\n          })\n        }\n      }\n\n      function setLinkedAuthor(person) {\n        $scope.ref.authorId = person.id;\n      }\n\n      function getResults(query) {\n        var resultSet = peopleRepo.search(query);\n        return resultSet.$promise.then(function () {\n          return resultSet.items;\n        });\n      }\n\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('workEditorItem', workEditorItemDirective);\n\n  /** @ngInject */\n  function workEditorItemDirective($log) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/task/components/work-editor/work-editor-item.html',\n      link: linkFunc,\n      scope: {\n        id: '=id'\n      },\n      controller: WorkEditorItemController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    function linkFunc($scope) {\n      if (!$scope.id) {\n        $log.error('missing required attribute \"id\"');\n      }\n    }\n\n    /** @ngInject */\n    function WorkEditorItemController($scope, worksRepo) {\n      var vm = this;\n\n      vm.loaded = false;\n\n      activate();\n\n      function activate() {\n        if ($scope.id) {\n          vm.work = worksRepo.get($scope.id);\n          vm.work.$promise.then(function () {\n            vm.loaded = true;\n          });\n        }\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('nameEditor', nameEditorDirective);\n\n  /** @ngInject */\n  function nameEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/person/components/name-editor/name-editor.html',\n      scope: {\n        name: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('eventEditor', eventEditorDirective);\n\n  /** @ngInject */\n  function eventEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/person/components/event-editor/event-editor.html',\n      scope: {\n        event: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('summaryEditor', summaryEditorDirective);\n\n  /** @ngInject */\n  function summaryEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/summary-editor/summary-editor.html',\n      scope: {\n        summary: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('SummaryEditDialogController', SummaryEditDialogController);\n\n  /** @ngInject */\n  function SummaryEditDialogController($mdDialog, summary) {\n    var vm = this;\n\n    vm.summary = summary;\n\n    vm.close = close;\n    vm.cancel = cancel;\n\n    function close() {\n      $mdDialog.hide(vm.summary);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .directive('dateEditor', dateEditorDirective);\n\n  /** @ngInject */\n  function dateEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/date-editor/date-editor.html',\n      scope: {\n        date: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('ShowWorkController', ShowWorkController);\n\n  /** @ngInject */\n  function ShowWorkController($state, $stateParams, worksRepo, $mdDialog, $mdToast) {\n    var vm = this;\n\n    vm.loading = true;\n    vm.work = null;\n    vm.title = null;\n\n    vm.editBibInfo = editBibInfo;\n    vm.editSummary = editSummary;\n    vm.addEdition = addEdition;\n    vm.deleteEdition = deleteEdition;\n    vm.addCopy = addCopy;\n    vm.editCopy = editCopy;\n    vm.deleteCopy = deleteCopy;\n\n    activate();\n\n    function activate() {\n      vm.work = worksRepo.get($stateParams.workId);\n\n      vm.work.$promise.then(function () {\n        vm.bcTitle = worksRepo.getTitle(vm.work.titles, ['short', 'canonical', 'bibliographic']);\n        vm.title = worksRepo.getTitle(vm.work.titles, ['canonical', 'bibliographic', 'short']);\n\n        vm.loading = false;\n      });\n    }\n\n    function editBibInfo($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/work-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          work: angular.copy(vm.work)\n        },\n        controller: 'WorkEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedWork) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        angular.extend(vm.work, updatedWork);\n\n        worksRepo.saveWork(vm.work).then(showSavedToast);\n      });\n    }\n\n    function editSummary($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/components/summary-edit-dialog/summary-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation (even if it is just a string)\n          summary: angular.copy(vm.work.summary)\n        },\n        controller: 'SummaryEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedSummary) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        vm.work.summary = updatedSummary;\n\n        worksRepo.saveWork(vm.work).then(showSavedToast);\n      });\n    }\n\n    function addEdition($event) {\n      var prompt = $mdDialog.prompt()\n        .targetEvent($event)\n        .title('Create Edition')\n        .textContent('Please provide a name for the new edition.')\n        .placeholder('edition name')\n        .ok('Create')\n        .cancel('Cancel');\n\n      var dialogPromise = $mdDialog.show(prompt);\n\n      var savePromise = dialogPromise.then(function (editionName) {\n        var edition = worksRepo.createEdition();\n        edition.editionName = editionName;\n        edition.titles = angular.copy(vm.work.titles);\n        edition.authors = angular.copy(vm.work.authors);\n        edition.otherAuthors = angular.copy(vm.work.otherAuthors);\n\n        vm.work.editions.push(edition);\n\n        // resolve to the created edition when save is successful\n        return worksRepo.saveEdition(vm.work.id, edition);\n      });\n\n      savePromise.then(showSavedToast);\n\n      savePromise.then(function (edition) {\n        $state.go('editor.edition', { workId: vm.work.id, editionId: edition.id });\n      });\n    }\n\n    function deleteEdition(edition, $event) {\n      var confirm = $mdDialog.confirm()\n        .targetEvent($event)\n        .title('Confirm Deletion')\n        .textContent('Are you sure you want to delete this edition?')\n        .ok('Yes')\n        .cancel('No');\n\n      $mdDialog.show(confirm)\n        .then(function () {\n          var ix = vm.work.editions.indexOf(edition);\n          if (ix >= 0) {\n            vm.work.editions.splice(ix, 1);\n            worksRepo.saveWork(vm.work).then(showSavedToast);\n          }\n        });\n    }\n\n    function addCopy($event) {\n      var copy = {};\n      editCopy(copy, $event).then(function () {\n        vm.work.copies.push(copy);\n      });\n    }\n\n    function editCopy(copy, $event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/copy-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          copy: angular.copy(copy)\n        },\n        controller: 'CopyEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedCopy) {\n        // copy updates back to original only after dialog is positively dismised (i.e. not canceled)\n        angular.extend(copy, updatedCopy);\n\n        worksRepo.saveWork(vm.work).then(showSavedToast);\n      });\n\n      return dialogPromise;\n    }\n\n    function deleteCopy(copy, $event) {\n      var confirm = $mdDialog.confirm()\n        .targetEvent($event)\n        .title('Confirm Deletion')\n        .textContent('Are you sure you want to delete this copy?')\n        .ok('Yes')\n        .cancel('No');\n\n      $mdDialog.show(confirm)\n        .then(function () {\n          var ix = vm.work.copies.indexOf(copy);\n          if (ix >= 0) {\n            vm.work.copies.splice(ix, 1);\n            worksRepo.saveWork(vm.work).then(showSavedToast);\n          }\n        });\n    }\n\n    function showSavedToast() {\n      var toast = $mdToast.simple()\n        .textContent('Saved')\n        .position('bottom right');\n\n      return $mdToast.show(toast);\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('WorkEditDialogController', WorkEditDialogController);\n\n  /** @ngInject */\n  function WorkEditDialogController($mdDialog, work) {\n    var vm = this;\n\n    vm.work = work;\n\n    vm.close = close;\n    vm.cancel = cancel;\n    vm.addAuthor = addAuthor;\n    vm.deleteAuthor = deleteAuthor;\n    vm.addTitle = addTitle;\n    vm.deleteTitle = deleteTitle;\n\n    function close() {\n      $mdDialog.hide(vm.work);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n\n    function addAuthor(field) {\n      // TODO delegate creation to worksRepo\n      var authorRef = {};\n      vm.work[field].push(authorRef);\n    }\n\n    function deleteAuthor(field, authorRef) {\n      var ix = vm.work[field].indexOf(authorRef);\n      if (ix >= 0) {\n        vm.work[field].splice(ix, 1);\n      }\n    }\n\n    function addTitle() {\n      // TODO delegate creation to worksRepo\n      var title = {};\n      vm.work.titles.push(title);\n    }\n\n    function deleteTitle(title) {\n      var ix = vm.work.titles.indexOf(title);\n      if (ix >= 0) {\n        vm.work.titles.splice(ix, 1);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('ShowVolumeController', ShowVolumeController);\n\n  /** @ngInject */\n  function ShowVolumeController($state, $stateParams, worksRepo, _, $mdDialog, $mdToast, $q) {\n    var vm = this;\n\n    vm.loading = true;\n    vm.work = null;\n    vm.workTitle = null;\n    vm.edition = null;\n    vm.volume = null;\n    vm.title = null;\n\n    vm.editBibInfo = editBibInfo;\n    vm.editSummary = editSummary;\n    vm.addCopy = addCopy;\n    vm.editCopy = editCopy;\n    vm.deleteCopy = deleteCopy;\n\n    activate();\n\n    function activate() {\n      vm.work = worksRepo.getWork($stateParams.workId);\n      vm.edition = worksRepo.getEdition($stateParams.workId, $stateParams.editionId);\n      vm.volume = worksRepo.getVolume($stateParams.workId, $stateParams.editionId, $stateParams.volumeId);\n\n      vm.work.$promise.then(function () {\n        vm.workTitle = worksRepo.getTitle(vm.work.titles, ['short', 'canonical', 'bibliographic']);\n      });\n\n      vm.volume.$promise.then(function () {\n        vm.title = worksRepo.getTitle(vm.volume.titles, ['canonical', 'bibliographic', 'short']);\n      });\n\n      $q.all([vm.work.$promise, vm.edition.$promise, vm.volume.$promise]).then(function () {\n        vm.loading = false;\n      });\n    }\n\n    function editBibInfo($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/volume-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          volume: angular.copy(vm.volume)\n        },\n        controller: 'VolumeEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedVolume) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        angular.extend(vm.volume, updatedVolume);\n\n        worksRepo.saveVolume(vm.work.id, vm.edition.id, vm.volume).then(showSavedToast);\n      });\n\n      return dialogPromise;\n    }\n\n    function editSummary($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/components/summary-edit-dialog/summary-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation (even if it is just a string)\n          summary: angular.copy(vm.volume.summary)\n        },\n        controller: 'SummaryEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedSummary) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        vm.volume.summary = updatedSummary;\n\n        worksRepo.saveVolume(vm.work.id, vm.edition.id, vm.volume).then(showSavedToast);\n      });\n    }\n\n    function addCopy($event) {\n      var copy = {};\n      editCopy(copy, $event).then(function () {\n        vm.volume.copies.push(copy);\n      });\n    }\n\n    function editCopy(copy, $event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/copy-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          copy: angular.copy(copy)\n        },\n        controller: 'CopyEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedCopy) {\n        // copy updates back to original only after dialog is positively dismised (i.e. not canceled)\n        angular.extend(copy, updatedCopy);\n\n        worksRepo.saveVolume(vm.work.id, vm.edition.id, vm.volume).then(showSavedToast);\n      });\n\n      return dialogPromise;\n    }\n\n    function deleteCopy(copy, $event) {\n      var confirm = $mdDialog.confirm()\n        .targetEvent($event)\n        .title('Confirm Deletion')\n        .textContent('Are you sure you want to delete this copy?')\n        .ok('Yes')\n        .cancel('No');\n\n      $mdDialog.show(confirm)\n        .then(function () {\n          var ix = vm.volume.copies.indexOf(copy);\n          if (ix >= 0) {\n            vm.volume.copies.splice(ix, 1);\n            worksRepo.saveVolume(vm.work.id, vm.edition.id, vm.volume).then(showSavedToast);\n          }\n        });\n    }\n\n    function showSavedToast() {\n      var toast = $mdToast.simple()\n        .textContent('Saved')\n        .position('bottom right');\n\n      return $mdToast.show(toast);\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('VolumeEditDialogController', VolumeEditDialogController);\n\n  /** @ngInject */\n  function VolumeEditDialogController($mdDialog, volume) {\n    var vm = this;\n\n    vm.volume = volume;\n\n    vm.close = close;\n    vm.cancel = cancel;\n    vm.addAuthor = addAuthor;\n    vm.deleteAuthor = deleteAuthor;\n    vm.addTitle = addTitle;\n    vm.deleteTitle = deleteTitle;\n\n    function close() {\n      $mdDialog.hide(vm.volume);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n\n    function addAuthor(field) {\n      // TODO delegate creation to worksRepo\n      var authorRef = {};\n      vm.volume[field].push(authorRef);\n    }\n\n    function deleteAuthor(field, authorRef) {\n      var ix = vm.volume[field].indexOf(authorRef);\n      if (ix >= 0) {\n        vm.volume[field].splice(ix, 1);\n      }\n    }\n\n    function addTitle() {\n      // TODO delegate creation to worksRepo\n      var title = {};\n      vm.volume.titles.push(title);\n    }\n\n    function deleteTitle(title) {\n      var ix = vm.volume.titles.indexOf(title);\n      if (ix >= 0) {\n        vm.volume.titles.splice(ix, 1);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('ShowEditionController', ShowEditionController);\n\n  /** @ngInject */\n  function ShowEditionController($state, $stateParams, worksRepo, _, $mdDialog, $mdToast, $q) {\n    var vm = this;\n\n    vm.loading = true;\n    vm.work = null;\n    vm.workTitle = null;\n    vm.edition = null;\n    vm.title = null;\n\n    vm.editBibInfo = editBibInfo;\n    vm.editSummary = editSummary;\n    vm.addVolume = addVolume;\n    vm.deleteVolume = deleteVolume;\n    vm.addCopy = addCopy;\n    vm.editCopy = editCopy;\n    vm.deleteCopy = deleteCopy;\n\n    activate();\n\n    function activate() {\n      vm.work = worksRepo.getWork($stateParams.workId);\n      vm.edition = worksRepo.getEdition($stateParams.workId, $stateParams.editionId);\n\n      vm.work.$promise.then(function () {\n        vm.workTitle = worksRepo.getTitle(vm.work.titles, ['short', 'canonical', 'bibliographic']);\n      });\n\n      vm.edition.$promise.then(function () {\n        vm.title = worksRepo.getTitle(vm.edition.titles, ['canonical', 'bibliographic', 'short']);\n      });\n\n      $q.all([vm.work.$promise, vm.edition.$promise]).then(function (){\n        vm.loading = false;\n      });\n    }\n\n    function editBibInfo($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/edition-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          edition: angular.copy(vm.edition)\n        },\n        controller: 'EditionEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedEdition) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        angular.extend(vm.edition, updatedEdition);\n\n        worksRepo.saveEdition(vm.work.id, vm.edition).then(showSavedToast);\n      });\n\n      return dialogPromise;\n    }\n\n    function editSummary($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/components/summary-edit-dialog/summary-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation (even if it is just a string)\n          summary: angular.copy(vm.edition.summary)\n        },\n        controller: 'SummaryEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedSummary) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        vm.edition.summary = updatedSummary;\n\n        worksRepo.saveEdition(vm.work.id, vm.edition).then(showSavedToast);\n      });\n    }\n\n    function addVolume($event) {\n      var prompt = $mdDialog.prompt()\n        .targetEvent($event)\n        .title('Create Volume')\n        .textContent('Please provide a number for the new volume.')\n        .placeholder('volume number')\n        .ok('Create')\n        .cancel('Cancel');\n\n      var dialogPromise = $mdDialog.show(prompt);\n\n      var savePromise = dialogPromise.then(function (volumeNumber) {\n        var volume = worksRepo.createVolume();\n        volume.volumeNumber = volumeNumber;\n        volume.titles = angular.copy(vm.edition.titles);\n        volume.authors = angular.copy(vm.edition.authors);\n        volume.otherAuthors = angular.copy(vm.edition.otherAuthors);\n        volume.publicationInfo = angular.copy(vm.edition.publicationInfo);\n\n        vm.edition.volumes.push(volume);\n\n        return worksRepo.saveVolume(vm.work.id, vm.edition.id, volume);\n      });\n\n      savePromise.then(showSavedToast);\n\n      savePromise.then(function (volume) {\n        $state.go('editor.volume', { workId: vm.work.id, editionId: vm.edition.id, volumeId: volume.id });\n      });\n    }\n\n    function deleteVolume(volume, $event) {\n      var confirm = $mdDialog.confirm()\n        .targetEvent($event)\n        .title('Confirm Deletion')\n        .textContent('Are you sure you want to delete this volume?')\n        .ok('Yes')\n        .cancel('No');\n\n      $mdDialog.show(confirm)\n        .then(function () {\n          var ix = vm.edition.volumes.indexOf(volume);\n          if (ix >= 0) {\n            vm.edition.volumes.splice(ix, 1);\n            worksRepo.saveEdition(vm.work.id, vm.edition).then(showSavedToast);\n          }\n        });\n    }\n\n    function addCopy($event) {\n      var copy = {};\n      editCopy(copy, $event).then(function () {\n        vm.edition.copies.push(copy);\n      });\n    }\n\n    function editCopy(copy, $event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/copy-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          copy: angular.copy(copy)\n        },\n        controller: 'CopyEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedCopy) {\n        // copy updates back to original only after dialog is positively dismised (i.e. not canceled)\n        angular.extend(copy, updatedCopy);\n\n        worksRepo.saveEdition(vm.work.id, vm.edition).then(showSavedToast);\n      });\n\n      return dialogPromise;\n    }\n\n    function deleteCopy(copy, $event) {\n      var confirm = $mdDialog.confirm()\n        .targetEvent($event)\n        .title('Confirm Deletion')\n        .textContent('Are you sure you want to delete this copy?')\n        .ok('Yes')\n        .cancel('No');\n\n      $mdDialog.show(confirm)\n        .then(function () {\n          var ix = vm.edition.copies.indexOf(copy);\n          if (ix >= 0) {\n            vm.edition.copies.splice(ix, 1);\n            worksRepo.saveEdition(vm.work.id, vm.edition).then(showSavedToast);\n          }\n        });\n    }\n\n    function showSavedToast() {\n      var toast = $mdToast.simple()\n        .textContent('Saved')\n        .position('bottom right');\n\n      return $mdToast.show(toast);\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('EditionEditDialogController', EditionEditDialogController);\n\n  /** @ngInject */\n  function EditionEditDialogController($mdDialog, edition) {\n    var vm = this;\n\n    vm.edition = edition;\n\n    vm.close = close;\n    vm.cancel = cancel;\n    vm.addAuthor = addAuthor;\n    vm.deleteAuthor = deleteAuthor;\n    vm.addTitle = addTitle;\n    vm.deleteTitle = deleteTitle;\n\n    function close() {\n      $mdDialog.hide(vm.edition);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n\n    function addAuthor(field) {\n      // TODO delegate creation to worksRepo\n      var authorRef = {};\n      vm.edition[field].push(authorRef);\n    }\n\n    function deleteAuthor(field, authorRef) {\n      var ix = vm.edition[field].indexOf(authorRef);\n      if (ix >= 0) {\n        vm.edition[field].splice(ix, 1);\n      }\n    }\n\n    function addTitle() {\n      // TODO delegate creation to worksRepo\n      var title = {};\n      vm.edition.titles.push(title);\n    }\n\n    function deleteTitle(title) {\n      var ix = vm.edition.titles.indexOf(title);\n      if (ix >= 0) {\n        vm.edition.titles.splice(ix, 1);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('CopyEditDialogController', CopyEditDialogController);\n\n  /** @ngInject */\n  function CopyEditDialogController($mdDialog, copy) {\n    var vm = this;\n\n    vm.copy = copy;\n\n    vm.close = close;\n    vm.cancel = cancel;\n\n    function close() {\n      $mdDialog.hide(vm.copy);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcWorks', [\n      'ngResource'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcWorks')\n    .provider('worksRepo', worksRepoProvider);\n\n  /**\n   * This functionality is already being implemented as a standalone trc-biblio module. The code is\n   * used here as an interim until the Bower build/dependency workflow has been finalized.\n   *\n   * @return {angular.provider}\n   */\n  function worksRepoProvider() {\n    var provider = {};\n    provider.url = '/api/works';\n    provider.$get = worksRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function worksRepoFactory($resource, _) {\n      var restResource = $resource(provider.url + '/:workId', { workId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var editionResource = $resource(provider.url + '/:workId/editions/:editionId', { editionId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var volumeResource = $resource(provider.url + '/:workId/editions/:editionId/volumes/:volumeId', { volumeId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var repo = {};\n      repo.getAll = findAll;\n      repo.search = search;\n      repo.get = getWork;\n      repo.getWork = getWork;\n      repo.getEdition = getEdition;\n      repo.getVolume = getVolume;\n      repo.create = createWork;\n      repo.createWork = createWork;\n      repo.createEdition = createEdition;\n      repo.createVolume = createVolume;\n      repo.save = save;\n      repo.saveWork = saveWork;\n      repo.saveEdition = saveEdition;\n      repo.saveVolume = saveVolume;\n      repo.delete = deleteWork;\n      repo.getTitle = getTitleByTypePreference;\n      return repo;\n\n      /**\n       * Retrieves a listing of all works\n       *\n       * @return {WorkProxy[]}\n       */\n      function findAll() {\n        return search('');\n      }\n\n      /**\n       * Search for works by query\n       *\n       * @return {SearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query, max: 50 });\n      }\n\n      /**\n       * Retrieves a work object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Work.$promise.\n       *\n       * @param {string} workId\n       * @return {Work}\n       */\n      function getWork(workId) {\n        if (angular.isUndefined(workId)) {\n          throw new TypeError('Invalid ID provided to getWork');\n        }\n\n        var work = restResource.get({ workId: workId });\n\n        work.$promise.then(adaptWork);\n\n        return work;\n      }\n\n      /**\n       * Retrieves an edition object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Edition.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @return {Edition}\n       */\n      function getEdition(workId, editionId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId)) {\n          throw new TypeError('Invalid IDs provided to getEdition');\n        }\n\n        var edition = editionResource.get({ workId: workId, editionId: editionId });\n\n        edition.$promise.then(adaptEdition);\n\n        return edition;\n      }\n\n      /**\n       * Retrieves a volume object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Volume.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @param {string} volumeId\n       * @return {Volume}\n       */\n      function getVolume(workId, editionId, volumeId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId) || angular.isUndefined(volumeId)) {\n          throw new TypeError('Invalid IDs provided to getVolume');\n        }\n\n        var volume = volumeResource.get({ workId: workId, editionId: editionId, volumeId: volumeId });\n\n        volume.$promise.then(adaptVolume);\n\n        return volume;\n      }\n\n      /**\n       * Creates a new work instance\n       *\n       * @return {Work}\n       */\n      function createWork() {\n        var work = new restResource();\n        adaptWork(work);\n        work.titles.push({});\n        work.authors.push({});\n        return work;\n      }\n\n      /**\n       * Creates a new edition instance\n       *\n       * @return {Edition}\n       */\n      function createEdition() {\n        var edition = new editionResource();\n        return adaptEdition(edition);\n      }\n\n      /**\n       * Creates a new volume instance\n       *\n       * @return {Volume}\n       */\n      function createVolume() {\n        var volume = new volumeResource();\n        return adaptVolume(volume);\n      }\n\n      /**\n       * Dispatch method for saving works, editions, and volumes\n       *\n       * @deprecated use saveWork, saveEdition, or saveVolume directly\n       * @return {Promise}\n       */\n      function save() {\n        switch (arguments.length) {\n          case 1: return saveWork.apply(null, arguments);\n          case 2: return saveEdition.apply(null, arguments);\n          case 3: return saveVolume.apply(null, arguments);\n        }\n        throw new TypeError('Unexpected arguments to worksRepo#save');\n      }\n\n      /**\n       * Saves a work instance back to the server\n       *\n       * @param {Work} work\n       * @return {Promise.<Work>}\n       */\n      function saveWork(work) {\n        if (!(work instanceof restResource)) {\n          throw new Error('work was not created by this repo');\n        }\n\n        // ngResource automatically updates the model to reflect any server changes (e.g. setting IDs for the work/edtions/volumes/copies).\n        return work.id\n          ? work.$update()\n          : work.$save();\n      }\n\n      /**\n       * Saves an edition instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {Edition} edition\n       * @return {Promise.<Edition>}\n       */\n      function saveEdition(workId, edition) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!(edition instanceof editionResource)) {\n          throw new Error('edition was not created by this repo');\n        }\n\n        return edition.id\n          ? edition.$update({ workId: workId })\n          : edition.$save({ workId: workId });\n      }\n\n      /**\n       * Saves a volume instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {string} editionId\n       * @param  {Volume} volume\n       * @return {Promise.<Volume>}\n       */\n      function saveVolume(workId, editionId, volume) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!editionId) {\n          throw new Error('no edition id provided');\n        }\n\n        if (!(volume instanceof volumeResource)) {\n          throw new Error('volume was not created by this repo');\n        }\n\n        return volume.id\n          ? volume.$update({ workId: workId, editionId: editionId })\n          : volume.$save({ workId: workId, editionId: editionId });\n      }\n\n      /**\n       * Deletes a work instance from the server\n       *\n       * @param  {string} id\n       */\n      function deleteWork(workId) {\n        var dataItem = restResource.delete({ id: workId });\n        return dataItem.$promise;\n      }\n\n      /**\n       * Ensure that aggregate fields common to all work/edition/volume entities exist and are formatted correctly\n       *\n       * @param  {Work|Edition|Volume} entity\n       * @return {Work|Edition|Volume}\n       */\n      function adaptCommon(entity) {\n        if (!entity.titles) {\n          entity.titles = [];\n        } else {\n          entity.titles.forEach(function (title) {\n            title.type = title.type.toLowerCase();\n          });\n        }\n\n        if (!entity.authors) {\n          entity.authors = [];\n        } else {\n          entity.authors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.otherAuthors) {\n          entity.otherAuthors = [];\n        } else {\n          entity.otherAuthors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.copies) {\n          entity.copies = [];\n        }\n\n        return entity;\n      }\n\n      /**\n       * Ensure that work aggregate fields exist and are formatted correctly\n       *\n       * @param  {Work} work\n       * @return {Work}\n       */\n      function adaptWork(work) {\n        adaptCommon(work);\n\n        if (!work.editions) {\n          work.editions = [];\n        } else {\n          work.editions.forEach(adaptEdition);\n        }\n\n        return work;\n      }\n\n      /**\n       * Ensure that edition aggregate fields exist and are formatted correctly\n       *\n       * @param  {Edition} edition\n       * @return {Edition}\n       */\n      function adaptEdition(edition) {\n        adaptCommon(edition);\n\n        if (!edition.volumes) {\n          edition.volumes = [];\n        } else {\n          edition.volumes.forEach(adaptVolume);\n        }\n\n        return edition;\n      }\n\n      /**\n       * Ensure that volume aggregate fields exist and are formatted correctly\n       *\n       * @param  {Volume} volume\n       * @return {Volume}\n       */\n      function adaptVolume(volume) {\n        adaptCommon(volume);\n\n        return volume;\n      }\n\n      /**\n       * Retrieves the first available title of the given type or falsey if no title can be found.\n       * If multiple types are given, returns the title corresponding to the first type for which a title is found.\n       *\n       * @param  {Title[]}         titles\n       * @param  {string|string[]} types\n       * @return {Title}\n       */\n      function getTitleByTypePreference(titles, types) {\n        if (!angular.isArray(types)) {\n          types = [types];\n        }\n\n        return types.reduce(function (found, type) {\n          return found || _.find(titles, { type: type });\n        }, null);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcTasks', [\n      'ngResource'\n    ]);\n\n})();\n\n/**\n * @typedef {object} Workflow\n * @property {string} id\n * @property {string} label\n * @property {string} description\n * @property {object.<string, WorkflowStage>} stages\n * @property {string} status\n */\n\n/**\n * @typedef {object} WorkflowStage\n * @property {string} id\n * @property {string} label\n * @property {string} description\n * @property {boolean} isFinal\n * @property {WorkflowStageTransition[]} transitions\n */\n\n/**\n * @typedef {object} WorkflowStageTransition\n * @property {string} sourceStage\n * @property {string} targetStage\n * @property {string} label\n */\n\n/**\n * @typedef {object} Worklist\n * @property {string} groupId\n * @property {string} label\n * @property {integer} itemCount\n * @property {integer} start\n * @property {integer} max\n * @property {WorkItem[]} items\n */\n\n/**\n * @typedef {object} WorkItem\n * @property {string} itemId\n * @property {string} type\n * @property {string} entityId\n * @property {string} label\n * @property {object.<string,string>} properties\n * @property {string} stage\n * @property {string} task\n */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcTasks')\n    .provider('tasksRepo', tasksRepoProvider);\n\n  /**\n   * @return {angular.provider}\n   */\n  function tasksRepoProvider() {\n    var provider = {};\n    provider.url = '/api/tasks';\n    provider.$get = tasksRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function tasksRepoFactory($resource) {\n      var workflowResource = $resource(provider.url + '/:taskId/workflow', { taskId: 'copies' });\n      var itemResource = $resource(provider.url + '/:taskId/items/:itemId', { taskId: 'copies', itemId: '@itemId' });\n\n      var repo = {};\n      repo.get = getTask;\n      repo.getItems = getItems;\n      repo.transition = transition;\n      return repo;\n\n      /**\n       * Retrieves a listing of all tasks\n       *\n       * @param  {string} [taskId=copies]\n       * @return {GroupedTaskList}\n       */\n      function getTask(taskId) {\n        taskId = taskId || 'copies';\n\n        var workflow = workflowResource.get({ taskId: taskId });\n\n        var task = {\n          $promise: workflow.$promise.then(function () {\n            return task;\n          }),\n          workflow: workflow,\n          getItems: function (stageId, options) {\n            return getItems(taskId, stageId, options);\n          }\n        };\n\n        return task;\n      }\n\n      /**\n       * Gets items from the task endpoint for a given stage\n       *\n       * @param  {string}  [taskId=copies]  Task ID\n       * @param  {string}  stageId          Workflow stage for which to get items\n       * @param  {object}  options\n       * @param  {integer} [options.start]  Starting index\n       * @param  {integer} [options.max]    Maximum number of items to fetch per page\n       * @return {Worklist}\n       */\n      function getItems(taskId, stageId, options) {\n        options = options || {};\n        return itemResource.get({\n          taskId: taskId,\n          stage: stageId,\n          start: options.start,\n          max: options.max\n        });\n      }\n\n      /**\n       * Transition an item from its current stage to a target stage\n       *\n       * @param  {WorkItem}                item   Work item instance\n       * @param  {WorkflowStageTransition} transition Target workflow stage\n       * @return {WorkItem}                       Updated work item instance\n       */\n      function transition(item, transition) {\n        if (item.stage !== transition.sourceStage) {\n          throw new Error('Transition (' + transition.sourceStage + ' -> ' + transition.targetStage + ') is not valid for item currently in stage ' + item.stage);\n        }\n\n        var result = itemResource.save({\n          itemId: item.itemId\n        }, {\n          stage: transition.targetStage,\n          // NOTE comments are not saved yet\n          comments: null\n        });\n\n        // propagate updates to the original item\n        result.$promise.then(function (resp) {\n          angular.extend(item, resp);\n        });\n\n        return result;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio', [\n      'ngResource'\n    ]);\n\n})();\n\n/**\n * Data model representing a person returned by the TRC REST API\n * @typedef Person\n * @type {object}\n * @property {string}           id       - a unique identifier for this person; assigned upon creation\n * @property {EntryMeta}        meta     - metadata about the record and its history in the system\n * @property {PersonName}       name     - primary name used to identify this person\n * @property {PersonName[]}     altNames - other names by which this person is known\n * @property {?HistoricalEvent} birth    - the date and location this person was born; may be null if unknown\n * @property {?HistoricalEvent} death    - the date and location this person was born; may be null if unknown or still alive\n * @property {string}           summary  - an HTML summary of the person and his or her significance\n */\n\n/**\n * Simplified, lightweight representation of a person for use in search results\n * @typedef Person\n * @type {object}\n * @property {string}     id             - a unique identifier for the person\n * @property {EntryMeta}  meta           - metadata about the record and its history in the system\n * @property {PersonName} name           - structured name representation\n * @property {string}     label          - formatted name to display\n * @property {string}     summaryExcerpt - a leading excerpt from the full summary\n */\n\n/**\n * Metadata about a TRC entry\n * @typedef EntryMeta\n * @type {object}\n * @property {string}                      slug         - a short, unique identifier intended to be more human-readable than the id\n * @property {integer}                     version      - a monotonically increasing version number incremented on each change\n * @property {object.<string, SimpleLink>} links        - links to related resources; keyed by link role\n * @property {string}                      lastModified - ISO 8601 timestamp of the last modification date\n */\n\n/**\n * Container for linking to related entities\n * @typedef SimpleLink\n * @type {object}\n * @property {string} uri  - a URI representing the linked item\n * @property {string} type - MIME type of the related linked item\n */\n\n/**\n * Structured form of a person's name\n * @typedef PersonName\n * @type {object}\n * @property {string} role        - clarifies the use of this name\n * @property {string} label       - a simple representation of this name for display purposes\n * @property {?string} title      - title of address\n * @property {?string} givenName  - given or first name\n * @property {?string} middleName - middle name\n * @property {?string} familyName - family or last name\n * @property {?string} suffix     - a suffix (e.g. 'Jr' or 'III')\n */\n\n/**\n * Event with a date/time, location, and descriptive information\n * @typedef HistoricalEvent\n * @type {object}\n * @property {string}          id          - a unique identifier for this event\n * @property {string}          title       - a brief title of the event for display purposes\n * @property {string}          description - a detailed summary of the event\n * @property {string}          location    - the location in which the event took place\n * @property {DateDescription} date        - the date the event took place\n */\n\n/**\n * Container for encapsulating human-readable and machine-readable forms of a date.\n * @typedef DateDescription\n * @type {object}\n * @property {string} calendar    - machine-readable ISO 8601 timestamp\n * @property {string} description - human-readable description of this date\n */\n\n/**\n * Container for search results\n * @typedef PersonSearchResultSet\n * @type {object}\n * @property {SimplePerson[]} items  - search results\n * @property {string}         qs     - query string that gives the current set of search results\n * @property {?string}        qsNext - query string that gives next set of search results or null if this is the last set\n * @property {?string}        qsPrev - query string that gives preceding set of search results or null if this is the first set\n */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .provider('peopleRepo', peopleRepoProvider);\n\n\n  function peopleRepoProvider() {\n    var provider = {};\n    provider.url = '/api/people';\n    provider.$get = peopleRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function peopleRepoFactory($q, $resource) {\n      var restResource = $resource(provider.url + '/:id', null, {\n        'update': { method: 'PUT' }\n      });\n\n      var repo = {};\n      repo.create = createPerson;\n      repo.createName = createName;\n      repo.createEvent = createEvent;\n      repo.get = findById;\n      repo.search = search;\n      repo.save = savePerson;\n      repo.delete = deletePerson;\n      return repo;\n\n      /**\n       * Creates a new empty person instance.\n       *\n       * @return {Person}\n       */\n      function createPerson() {\n        var person = new restResource();\n        return adaptPerson(person);\n      }\n\n      /**\n       * Creates a new empty entry metadata instance\n       *\n       * @return {EntryMeta}\n       */\n      function createMeta() {\n        var meta = {};\n        return adaptMeta(meta);\n      }\n\n      /**\n       * Creates a new empty name instance\n       *\n       * @return {PersonName}\n       */\n      function createName() {\n        var name = {};\n        return adaptName(name);\n      }\n\n      /**\n       * Creates a new historical event instance\n       *\n       * @return {HistoricalEvent}\n       */\n      function createEvent() {\n        var evt = {};\n        return adaptEvent(evt);\n      }\n\n      /**\n       * Creates a date/description instance\n       *\n       * @return {DateDescription}\n       */\n      function createDateDescription() {\n        var dateDescription = {};\n        return dateDescription;\n      }\n\n      /**\n       * Retrieves a person object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promise is available on Person.$promise.\n       *\n       * @param  {string} id\n       * @return {Person}\n       */\n      function findById(id) {\n        return restResource.get({ id: id });\n      }\n\n      /**\n       * Retrieves a serch result set of people who match the given query.\n       *\n       * @param {string} query\n       * @return {PersonSearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query });\n      }\n\n      /**\n       * Saves a person model to the REST API.\n       *\n       * If no ID is provided on the person model, the API will create save the model as a new\n       * person. Otherwise, the API will attempt to update the existing person model with that ID.\n       *\n       * @param {Person} person\n       * @return {Promise.<Person>} - resolves to the saved person on success\n       */\n      function savePerson(person) {\n        var response;\n        if (person.id) {\n          response = restResource.update({ id: person.id }, person);\n        } else {\n          response = restResource.save(null, person);\n        }\n\n        return response.$promise.then(function (personId) {\n          person.id = personId.id;\n          return person;\n        });\n      }\n\n      /**\n       * Deletes a person on the server via the REST API.\n       *\n       * @param {Person|string} idOrPerson\n       * @return {Promise} - resolves on success\n       */\n      function deletePerson(id) {\n        var response = restResource.delete({ id: id })\n        return response.$promise;\n      }\n\n      /**\n       * Populates a person with aggregate fields\n       *\n       * @param  {Person} person\n       * @return {Person}\n       */\n      function adaptPerson(person) {\n        if (!person.meta) {\n          person.meta = createMeta();\n        } else {\n          adaptMeta(person.meta);\n        }\n\n        if (!person.name) {\n          person.name = createName();\n        } else {\n          adaptName(person.name);\n        }\n\n        if (!person.altNames) {\n          person.altNames = [];\n        } else {\n          person.altNames.forEach(adaptName);\n        }\n\n        if (!person.birth) {\n          person.birth = createEvent();\n        } else {\n          adaptEvent(person.birth);\n        }\n\n        if (!person.death) {\n          person.death = createEvent();\n        } else {\n          adaptEvent(person.death);\n        }\n\n        return person\n      }\n\n      /**\n       * Ensure that entry metadata aggregate fields exist and are formatted correctly.\n       *\n       * @param  {EntryMeta} meta\n       * @return {EntryMeta}\n       */\n      function adaptMeta(meta) {\n        if (!meta.links) {\n          meta.links = {};\n        }\n\n        return meta;\n      }\n\n      /**\n       * Ensure that name aggregate fields exist and are formatted correctly\n       * @param  {PersonName} name\n       * @return {PersonName}\n       */\n      function adaptName(name) {\n        // no aggregate fields yet...\n        return name;\n      }\n\n      /**\n       * Ensure that event aggregate fields exist and are formatted correctly.\n       *\n       * @param  {HistoricalEvent} evt\n       * @return {HistoricalEvent}\n       */\n      function adaptEvent(evt) {\n        if (!evt.date) {\n          evt.date = createDateDescription();\n        }\n\n        return evt;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcPersonEditor', trcPersonEditorDirective);\n\n  /** @ngInject */\n  function trcPersonEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/person-editor.html',\n      scope: {\n        person: '=ngModel'\n      },\n      controller: PersonEditorController,\n      controllerAs: 'personEditor'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function PersonEditorController($scope, peopleRepo) {\n      var vm = this;\n\n      vm.addName = addName;\n      vm.removeName = removeName;\n      vm.addEvent = addEvent;\n      vm.removeEvent = removeEvent;\n\n      /**\n       * Adds a name to the current person model.\n       */\n      function addName() {\n        var newName = peopleRepo.createName();\n        $scope.person.altNames.push(newName);\n      }\n\n      /**\n       * Removes the name at the specified index from the current person model.\n       *\n       * @param {integer} ix\n       */\n      function removeName(ix) {\n        $scope.person.altNames.splice(ix, 1);\n      }\n\n      /**\n       * Adds an event to the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function addEvent(key) {\n        var newEvent = peopleRepo.createEvent();\n        $scope.person[key] = newEvent;\n      }\n\n      /**\n       * Removes the event from the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function removeEvent(key) {\n        $scope.person[key] = null;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcNameEditor', trcNameEditorDirective);\n\n  /** @ngInject */\n  function trcNameEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/name-editor.html',\n      scope: {\n        name: '=ngModel'\n      },\n      controller: NameEditorController,\n      controllerAs: 'nameEditor'\n    };\n\n    return directive;\n\n    function NameEditorController() {\n      var vm = this;\n\n      vm.roles = [\n        { value: 'canonical', label: 'Canonical Name' },\n        { value: 'pseudonym', label: 'Pseudonym' },\n        { value: 'maiden', label: 'Maiden Name' },\n        { value: 'designation', label: 'Honorary Designation' },\n        { value: 'nickname', label: 'Nickname' },\n        { value: 'phonetic', label: 'Phonetic Name' }\n      ];\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcEventEditor', trcEventEditorDirective);\n\n  /** @ngInject */\n  function trcEventEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/event-editor.html',\n      scope: {\n        event: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('TaskController', TaskController);\n\n  /** @ngInject */\n  function TaskController($state, $mdSidenav, tasksRepo, $q) {\n    var vm = this;\n\n    // HACK this will eventually be made available on the workflow data model itself.\n    vm.stageOrder = [\n      'pinned',\n      'review',\n      'inprogress',\n      'pending',\n      'deferred'\n    ];\n\n    vm.loading = true;\n    vm.worklists = {};\n    vm.task = null;\n\n    vm.openMenu = openMenu;\n    vm.focusItem = focusItem;\n    vm.transition = transitionItem;\n\n    activate();\n\n    function activate() {\n      vm.task = tasksRepo.get();\n\n      vm.task.$promise.then(function (task) {\n        var worklistPromises = [];\n\n        angular.forEach(task.workflow.stages, function (stage) {\n          var worklistPromise = fetchStage(task, stage.id);\n          worklistPromises.push(worklistPromise);\n        });\n\n        $q.all(worklistPromises).then(function () {\n          vm.loading = false;\n        });\n      });\n    }\n\n    function openMenu() {\n      $mdSidenav('left').toggle();\n    }\n\n    function focusItem(item, $event) {\n      $event.stopImmediatePropagation();\n\n      // TODO resolve handler based on item.type\n      $state.go('editor.work', { workId: item.entityId });\n    }\n\n    function transitionItem(item, transition, $event) {\n      $event.stopImmediatePropagation();\n\n      var updatedItem = tasksRepo.transition(item, transition);\n      updatedItem.$promise.then(function () {\n        fetchStage(vm.task, transition.sourceStage);\n        fetchStage(vm.task, transition.targetStage);\n      });\n    }\n\n    function fetchStage(task, stageId) {\n      var group = task.getItems(stageId, { max: 9999 });\n\n      group.$promise.then(function () {\n        vm.worklists[stageId] = group.items.length > 0 ? group : null;\n      });\n\n      return group.$promise;\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('slideToggle', []);\n\n})();\n\n(function () {\n   'use strict';\n\n   angular\n      .module('slideToggle')\n      .directive('slideToggle', slideToggle);\n\n   /** @ngInject */\n   function slideToggle() {\n      var directive = {\n         restrict: 'A',\n         scope: {\n            active: '=slideToggle'\n         },\n         link: linkFunc\n      };\n\n      return directive;\n\n      function linkFunc(scope, el, attr) {\n         var duration = parseInt(attr.slideToggleDuration) || 200;\n         scope.$watch('active', function (active) {\n            if (active) {\n               el.stop().slideDown(duration);\n            } else {\n               el.stop().slideUp(duration);\n            }\n         })\n      }\n   }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('ShowPersonController', ShowPersonController);\n\n  /** @ngInject */\n  function ShowPersonController(peopleRepo, $stateParams, $mdDialog, $mdToast) {\n    var vm = this;\n\n    vm.loading = true;\n    vm.person = null;\n\n    vm.editBioInfo = editBioInfo;\n    vm.editEvent = editEvent;\n    vm.editSummary = editSummary;\n\n    activate();\n\n    function activate() {\n      vm.person = peopleRepo.get($stateParams.id);\n    }\n\n    function editBioInfo($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/person/person-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          person: angular.copy(vm.person)\n        },\n        controller: 'PersonEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedPerson) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        angular.extend(vm.person, updatedPerson);\n\n        peopleRepo.save(vm.person).then(showSavedToast);\n      });\n    }\n\n    function editEvent(field, $event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/person/event-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation\n          event: angular.copy(vm.person[field])\n        },\n        controller: 'EventEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedEvent) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        angular.extend(vm.person[field], updatedEvent);\n\n        peopleRepo.save(vm.person).then(showSavedToast);\n      });\n    }\n\n    function editSummary($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/components/summary-edit-dialog/summary-edit-dialog.html',\n        locals: {\n          // create a copy for manipulation (even if it is just a string)\n          summary: angular.copy(vm.person.summary)\n        },\n        controller: 'SummaryEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      dialogPromise.then(function (updatedSummary) {\n        // copy updates back to original only after dialog is positively dismissed (i.e. not canceled)\n        vm.person.summary = updatedSummary;\n\n        peopleRepo.save(vm.person).then(showSavedToast);\n      });\n    }\n\n    function showSavedToast() {\n      var toast = $mdToast.simple()\n        .textContent('Saved')\n        .position('bottom right');\n\n      return $mdToast.show(toast);\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('PersonEditDialogController', PersonEditDialogController);\n\n  /** @ngInject */\n  function PersonEditDialogController(peopleRepo, $mdDialog, person) {\n    var vm = this;\n\n    vm.person = person;\n    vm.nameRoles = [\n        // { value: 'canonical', label: 'Canonical Name' },\n        { value: 'pseudonym', label: 'Pseudonym' },\n        { value: 'maiden', label: 'Maiden Name' },\n        { value: 'designation', label: 'Honorary Designation' },\n        { value: 'nickname', label: 'Nickname' },\n        { value: 'phonetic', label: 'Phonetic Name' }\n    ]\n\n    vm.close = close;\n    vm.cancel = cancel;\n    vm.addName = addName;\n    vm.deleteName = deleteName;\n\n    function close() {\n      $mdDialog.hide(vm.person);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n\n    function addName() {\n      var name = peopleRepo.createName();\n      vm.person.altNames.push(name);\n    }\n\n    function deleteName(name) {\n      var ix = vm.person.altNames.indexOf(name);\n      if (ix >= 0) {\n        vm.person.altNames.splice(ix, 1);\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('EventEditDialogController', EventEditDialogController);\n\n  /** @ngInject */\n  function EventEditDialogController($mdDialog, event) {\n    var vm = this;\n\n    vm.event = event;\n\n    vm.close = close;\n    vm.cancel = cancel;\n\n    function close() {\n      $mdDialog.hide(vm.event);\n    }\n\n    function cancel() {\n      $mdDialog.cancel();\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(worksRepo, peopleRepo, $state, $stateParams, $mdSidenav, _, $q, $mdDialog, $mdToast) {\n    var vm = this;\n\n    vm.loading = false;\n    vm.searchQuery = '';\n\n    vm.openMenu = openMenu;\n    vm.createPerson = createPerson;\n    vm.createWork = createWork;\n    vm.search = _.debounce(search, 300);\n\n    activate();\n\n    function activate() {\n      if ($stateParams.q) {\n        vm.searchQuery = $stateParams.q;\n        search(vm.searchQuery);\n      }\n    }\n\n    function openMenu() {\n      $mdSidenav('left').toggle();\n    }\n\n    function search(query) {\n      vm.loading = true;\n\n      vm.peopleResults = peopleRepo.search(query);\n      vm.worksResults = worksRepo.search(query);\n\n      $q.all([\n        vm.peopleResults.$promise,\n        vm.worksResults.$promise\n      ])\n        .then(function () {\n          vm.loading = false;\n        });\n    }\n\n    function createPerson($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/person/person-edit-dialog.html',\n        locals: {\n          person: peopleRepo.create()\n        },\n        controller: 'PersonEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      var savePromise = dialogPromise.then(function (person) {\n        return peopleRepo.save(person);\n      });\n\n      savePromise.then(showSavedToast);\n\n      savePromise.then(function (person) {\n        $state.go('editor.person', { id: person.id });\n      });\n    }\n\n    function createWork($event) {\n      var dialog = {\n        targetEvent: $event,\n        templateUrl: 'app/work/work-edit-dialog.html',\n        locals: {\n          work: worksRepo.createWork()\n        },\n        controller: 'WorkEditDialogController',\n        controllerAs: 'vm'\n      };\n\n      var dialogPromise = $mdDialog.show(dialog);\n\n      var savePromise = dialogPromise.then(function (work) {\n        return worksRepo.saveWork(work);\n      });\n\n      savePromise.then(showSavedToast);\n\n      savePromise.then(function (work) {\n        $state.go('editor.work', { workId: work.id });\n      });\n    }\n\n    function showSavedToast() {\n      var toast = $mdToast.simple()\n        .textContent('Saved')\n        .position('bottom right');\n\n      return $mdToast.show(toast);\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log) {\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('editor', {\n        url: '/?q',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'vm'\n      })\n\n      .state('editor.person', {\n        url: 'people/:id',\n        views: {\n          main: {\n            templateUrl: 'app/person/person.html',\n            controller: 'ShowPersonController',\n            controllerAs: 'vm'\n          }\n        }\n      })\n\n      .state('editor.work', {\n        url: 'works/:workId',\n        views: {\n          main: {\n            templateUrl: 'app/work/work.html',\n            controller: 'ShowWorkController',\n            controllerAs: 'vm'\n          }\n        }\n      })\n      .state('editor.edition', {\n        url: 'works/:workId/editions/:editionId',\n        views: {\n          main: {\n            templateUrl: 'app/work/edition.html',\n            controller: 'ShowEditionController',\n            controllerAs: 'vm'\n          }\n        }\n      })\n      .state('editor.volume', {\n        url: 'works/:workId/editions/:editionId/volumes/:volumeId',\n        views: {\n          main: {\n            templateUrl: 'app/work/volume.html',\n            controller: 'ShowVolumeController',\n            controllerAs: 'vm'\n          }\n        }\n      })\n\n      .state('task', {\n        url: '/task',\n        templateUrl: 'app/task/task.html',\n        controller: 'TaskController',\n        controllerAs: 'vm'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global _:false, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .constant('_', _)\n    .constant('moment', moment);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sdaAdminWeb')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, /* toastrConfig, */ $mdThemingProvider, tasksRepoProvider, worksRepoProvider, peopleRepoProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    $mdThemingProvider.definePalette('darkBrown', {\n      '50': '#595c59',\n      '100': '#4c4f4c',\n      '200': '#404240',\n      '300': '#333533',\n      '400': '#272827',\n      '500': '#1a1b1a',\n      '600': '#0d0e0d',\n      '700': '#010101',\n      '800': '#000000',\n      '900': '#000000',\n      'A100': '#e0f0e0',\n      'A200': '#565956',\n      'A400': '#7e837e',\n      'A700': '#000000',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['A100']\n    });\n\n    $mdThemingProvider.definePalette('copper', {\n      '50': '#d4b190',\n      '100': '#cca47e',\n      '200': '#c5976b',\n      '300': '#be8a59',\n      '400': '#b67e47',\n      '500': '#a47140',\n      '600': '#926439',\n      '700': '#7f5832',\n      '800': '#6d4b2b',\n      '900': '#5b3e23',\n      'A100': '#dcc3ab',\n      'A200': '#a47140',\n      'A400': '#48321c',\n      'A700': '#272927',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['50', '100', '200', 'A100']\n    });\n\n    $mdThemingProvider.theme('default')\n      .primaryPalette('darkBrown')\n      .accentPalette('copper');\n\n\n    tasksRepoProvider.url = '/api/catalog/v1/tasks';\n    worksRepoProvider.url = '/api/catalog/works';\n    peopleRepoProvider.url = '/api/catalog/people';\n  }\n\n})();\n\nangular.module(\"sdaAdminWeb\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<md-content flex layout=column><md-toolbar><div class=md-toolbar-tools><md-button class=\\\"md-accent md-icon-button\\\" ng-click=vm.openMenu() title=\\\"toggle menu\\\" hide-gt-sm><md-icon>menu</md-icon></md-button><img class=logo src=assets/images/sda-logo-light.png><h2><span>Catalog Entry Editor</span></h2><span flex></span> <img class=ox-brand src=assets/images/ox-brand-rect.png alt=\\\"University of Oxford\\\" hide-xs></div></md-toolbar><md-content flex layout=row><md-sidenav md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\" ui-view=sidebar layout=column><form layout=row flex=none><md-input-container flex><label for=searchQuery>Search</label><md-icon>search</md-icon><input type=search name=searchQuery id=searchQuery ng-model=vm.searchQuery ng-change=vm.search(vm.searchQuery) required></md-input-container></form><md-content flex><div ng-if=vm.loading layout=row layout-align=center><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if=\\\"!vm.loading &amp;&amp; vm.peopleResults &amp;&amp; vm.peopleResults.items.length > 0\\\"><md-subheader>People</md-subheader><md-list><md-list-item ng-repeat=\\\"person in vm.peopleResults.items\\\" ui-sref=\\\"editor.person({id: person.id})\\\"><div class=md-list-item-text><span>{{person.label}}</span></div></md-list-item></md-list></div><div ng-if=\\\"!vm.loading &amp;&amp; vm.worksResults &amp;&amp; vm.worksResults.items.length > 0\\\"><md-subheader>Works</md-subheader><md-list><md-list-item ng-repeat=\\\"work in vm.worksResults.items\\\" ui-sref=\\\"editor.work({workId: work.id})\\\"><div class=md-list-item-text><span>{{work.label}}</span></div></md-list-item></md-list></div></md-content></md-sidenav><md-fab-speed-dial md-direction=up class=\\\"md-scale md-fab-bottom-right\\\"><md-fab-trigger><md-button aria-label=New... class=md-fab><md-icon>add</md-icon></md-button></md-fab-trigger><md-fab-actions><md-button aria-label=\\\"New Person\\\" class=\\\"md-fab md-mini\\\" ng-click=vm.createPerson($event)><md-icon>person</md-icon></md-button><md-button aria-label=\\\"New Work\\\" class=\\\"md-fab md-mini\\\" ng-click=vm.createWork($event)><md-icon>book</md-icon></md-button></md-fab-actions></md-fab-speed-dial><md-content flex layout=column ui-view=main></md-content></md-content></md-content>\");\n$templateCache.put(\"app/person/event-edit-dialog.html\",\"<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Event Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><event-editor ng-model=vm.event flex></event-editor></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/person/person-edit-dialog.html\",\"<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Biographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><section class=name layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Canonical Name</h2></div></md-toolbar><div class=name><name-editor ng-model=vm.person.name flex></name-editor></div></section><section class=alt-names layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Alternate Names</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addName()><md-icon>add</md-icon></md-button></div></md-toolbar><div class=name layout=row ng-repeat=\\\"name in vm.person.altNames\\\"><md-input-container><label>role</label><md-select ng-model=name.role><md-option ng-repeat=\\\"role in vm.nameRoles\\\" value={{role.value}}>{{role.label}}</md-option></md-select></md-input-container><name-editor ng-model=name flex></name-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=vm.deleteName(name)><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/person/person.html\",\"<div layout=row layout-padding><div flex=60><section class=\\\"content names\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h1 class=content-heading>{{vm.person.name.label}}</h1><span flex></span><md-button class=md-icon-button ng-click=vm.editBioInfo($event)><md-icon>edit</md-icon></md-button></div><div ng-if=\\\"vm.person.altNames && vm.person.altNames.length > 0\\\"><p>Other names:</p><ul><li ng-repeat=\\\"name in vm.person.altNames\\\">{{name.label}}</li></ul></div></section><section class=\\\"content summary\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.person.summary ng-bind-html=vm.person.summary></p></section></div><div flex=40><section class=\\\"content birth\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Birth</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.editEvent(\\'birth\\', $event)\\\"><md-icon>edit</md-icon></md-button></div><p><span class=description ng-if=vm.person.birth.date.description>{{vm.person.birth.date.description}}</span> <span class=location ng-if=vm.person.birth.location>in {{vm.person.birth.location}}</span></p><p ng-bind-html=vm.person.birth.description ng-if=vm.person.birth.description></p></section><section class=\\\"content death\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Death</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.editEvent(\\'death\\', $event)\\\"><md-icon>edit</md-icon></md-button></div><p><span class=description ng-if=vm.person.death.date.description>{{vm.person.death.date.description}}</span> <span class=location ng-if=vm.person.death.location>in {{vm.person.death.location}}</span></p><p ng-bind-html=vm.person.death.description ng-if=vm.person.death.description></p></section></div></div>\");\n$templateCache.put(\"app/task/task.html\",\"<md-content flex layout=column><md-toolbar><div class=md-toolbar-tools><md-button class=\\\"md-accent md-icon-button\\\" ng-click=vm.openMenu() title=\\\"toggle menu\\\" hide-gt-sm><md-icon>menu</md-icon></md-button><img class=logo src=assets/images/sda-logo-light.png><h2><span>Task Management Dashboard</span></h2><span flex></span> <img class=ox-brand src=assets/images/ox-brand-rect.png alt=\\\"University of Oxford\\\" hide-xs></div></md-toolbar><md-content flex layout=row><md-sidenav md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\">Left Sidebar</md-sidenav><md-content flex layout=column><md-content flex layout=column><md-input-container><label>Search</label><md-icon>search</md-icon><input type=search ng-model=filter ng-change=vm.search(filter)></md-input-container><md-content flex><div layout=row layout-align=\\\"center center\\\" ng-if=vm.loading><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-repeat=\\\"stageId in vm.stageOrder\\\" ng-if=vm.worklists[stageId]><md-subheader>{{vm.task.workflow.stages[stageId].label}}</md-subheader><md-list><md-list-item ng-repeat=\\\"item in vm.worklists[stageId].items | filter : filter | limitTo : 20\\\" ng-mouseover=\\\"item.hover = true\\\" ng-mouseout=\\\"item.hover = false\\\" ng-click=\\\"vm.focusItem(item, $event)\\\"><span ng-bind-html=item.label></span> <span flex></span><md-button class=md-exclude ng-repeat=\\\"transition in vm.task.workflow.stages[stageId].transitions\\\" ng-click=\\\"vm.transition(item, transition, $event)\\\" ng-show=item.hover><span>{{transition.label}}</span></md-button></md-list-item></md-list></div></md-content></md-content></md-content></md-content></md-content>\");\n$templateCache.put(\"app/trc-bio/event-editor.html\",\"<div class=form-group><label class=control-label for=event-title>Title</label><input type=text id=event-title name=event-title class=\\\"form-control event-title\\\" ng-model=event.title></div><div class=form-group><label class=control-label for=event-description>Description</label><textarea id=event-description name=event-description class=\\\"form-control event-description\\\" ng-model=event.description></textarea></div><div class=form-group><label class=control-label for=event-location>Location</label><input type=text id=event-location name=event-location class=\\\"form-control event-location\\\" ng-model=event.location></div><div class=form-group><label class=control-label for=event-date>Date</label><input type=text id=event-date name=event-date class=\\\"form-control event-date\\\" ng-model=event.date.description><!-- TODO add datepicker --></div>\");\n$templateCache.put(\"app/trc-bio/name-editor.html\",\"<div class=form-group class=name-role><label class=control-label for=name-role>Role</label><select id=name-role name=name-role class=\\\"form-control name-role\\\" ng-model=name.role><option ng-repeat=\\\"role in nameEditor.roles\\\" value={{role.value}}>{{role.label}}</option></select></div><div class=form-group class=name-structure><label class=control-label>Structured Name</label><input type=text class=name-title placeholder=title ng-model=name.title> <input type=text class=name-given placeholder=given ng-model=name.givenName> <input type=text class=name-middle placeholder=middle ng-model=name.middleName> <input type=text class=name-family placeholder=family ng-model=name.familyName> <input type=text class=name-suffix placeholder=suffix ng-model=name.suffix></div><div class=form-group class=name-label><label for=label>Display Label</label><input type=text placeholder=label ng-model=name.label></div>\");\n$templateCache.put(\"app/trc-bio/person-editor.html\",\"<div class=form-group><label for=person-name>Primary Name</label><trc-name-editor id=person-name ng-model=person.name></trc-name-editor></div><div class=form-group><label for=person-altnames>Alternate Names</label><div ng-repeat=\\\"name in person.altNames\\\"><trc-name-editor id=person-altnames ng-model=name></trc-name-editor><button ng-click=personEditor.removeName($index)>&minus;</button></div><button ng-click=personEditor.addName()>+</button></div><div class=form-group><label for=person-birth>Birth</label><div ng-if=person.birth><trc-event-editor id=person-birth ng-model=person.birth></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'birth\\')\\\">&minus;</button></div><div ng-if=!person.birth><button ng-click=\\\"personEditor.addEvent(\\'birth\\')\\\">+</button></div></div><div class=form-group><label for=person-death>Death</label><div ng-if=person.death><trc-event-editor id=person-death ng-model=person.death></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'death\\')\\\">&minus;</button></div><div ng-if=!person.death><button ng-click=\\\"personEditor.addEvent(\\'death\\')\\\">+</button></div></div><div class=form-group><label class=control-label for=person-summary>Summary</label><textarea id=person-summary name=person-summary class=\\\"form-control person-summary\\\" ng-model=person.summary></textarea></div>\");\n$templateCache.put(\"app/work/copy-edit-dialog.html\",\"<md-dialog flex=50><md-toolbar><div class=md-toolbar-tools><h3>Digital Copy Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><copy-editor ng-model=vm.copy></copy-editor></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/work/edition-edit-dialog.html\",\"<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><div layout=row><md-input-container flex><label>edition name</label><input type=text ng-model=vm.edition.editionName required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=vm.edition.publicationInfo flex></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat=\\\"title in vm.edition.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteTitle(title, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'authors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat=\\\"author in vm.edition.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'authors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'otherAuthors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in vm.edition.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'otherAuthors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/work/edition.html\",\"<nav layout=row layout-padding><ol class=breadcrumbs flex><li><a ui-sref=\\\"editor.work({workId: vm.work.id})\\\">{{vm.workTitle.title}}{{vm.workTitle.title && vm.workTitle.subtitle ? \\': \\' : \\'\\'}}{{vm.workTitle.subTitle}}</a></li><li>{{vm.edition.editionName}}</li></ol></nav><div layout=row layout-padding><div layout=column flex=60><section class=\\\"content citation\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if=\\\"vm.edition.authors && vm.edition.authors.length > 0\\\"><span class=author ng-repeat=\\\"author in vm.edition.authors\\\"><span ng-if=author.authorId><a ui-sref=\\\"editor.person({id: author.authorId})\\\">{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \\': \\' : \\'\\'}}{{vm.title.subtitle}}. </span><span class=publication ng-if=vm.edition.publicationInfo><span ng-if=vm.edition.publicationInfo.place><span class=place>{{vm.edition.publicationInfo.place}}</span>: </span><span ng-if=vm.edition.publicationInfo.publisher><span class=publisher>{{vm.edition.publicationInfo.publisher}}</span>, </span><span ng-if=vm.edition.publicationInfo.date><time class=date datetime={{vm.edition.publicationInfo.date.calendar}}>{{vm.edition.publicationInfo.date.description}}</time>.</span></span></p></section><section class=\\\"content summary\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.edition.summary ng-bind-html=vm.edition.summary></p></section><section class=\\\"content volumes\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Volumes</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addVolume($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat=\\\"volume in vm.edition.volumes\\\" ui-sref=\\\"editor.volume({workId: vm.work.id, editionId: vm.edition.id, volumeId: volume.id})\\\"><span>Volume {{volume.volumeNumber}}</span><md-button class=\\\"md-secondary md-icon-button md-warn\\\" ng-click=\\\"vm.deleteVolume(volume, $event)\\\"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div><div layout=column flex=40><section class=\\\"content references\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>References</h2></div><p>Coming soon</p></section><section class=\\\"content copies\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat=\\\"copy in vm.edition.copies\\\" ng-click=\\\"vm.editCopy(copy, $event)\\\"><span>{{copy.title}}</span><md-button class=\\\"md-secondary md-icon-button md-warn\\\" ng-click=\\\"vm.deleteCopy(copy, $event)\\\"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div>\");\n$templateCache.put(\"app/work/volume-edit-dialog.html\",\"<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><div layout=row><md-input-container flex><label>volume number</label><input type=text ng-model=vm.volume.volumeNumber required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=vm.volume.publicationInfo></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat=\\\"title in vm.volume.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteTitle(title, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'authors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat=\\\"author in vm.volume.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'authors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'otherAuthors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in vm.volume.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'otherAuthors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/work/volume.html\",\"<nav layout=row layout-padding><ol class=breadcrumbs flex><li><a ui-sref=\\\"editor.work({workId: vm.work.id})\\\">{{vm.workTitle.title}}{{vm.workTitle.title && vm.workTitle.subtitle ? \\': \\' : \\'\\'}}{{vm.workTitle.subTitle}}</a></li><li><a ui-sref=\\\"editor.edition({workId: vm.work.id, editionId: vm.edition.id})\\\">{{vm.edition.editionName}}</a></li><li>Volume {{vm.volume.volumeNumber}}</li></ol></nav><div layout=row layout-padding><div layout=column flex=60><section class=\\\"content citation\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if=\\\"vm.volume.authors && vm.volume.authors.length > 0\\\"><span class=author ng-repeat=\\\"author in vm.volume.authors\\\"><span ng-if=author.authorId><a ui-sref=\\\"editor.person({id: author.authorId})\\\">{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \\': \\' : \\'\\'}}{{vm.title.subtitle}}. </span><span class=publication ng-if=vm.volume.publicationInfo><span ng-if=vm.volume.publicationInfo.place><span class=place>{{vm.volume.publicationInfo.place}}</span>: </span><span ng-if=vm.volume.publicationInfo.publisher><span class=publisher>{{vm.volume.publicationInfo.publisher}}</span>, </span><span ng-if=vm.volume.publicationInfo.date><time class=date datetime={{vm.volume.publicationInfo.date.calendar}}>{{vm.volume.publicationInfo.date.description}}</time>.</span></span></p></section><section class=\\\"content summary\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.volume.summary ng-bind-html=vm.volume.summary></p></section></div><div layout=column flex=40><section class=\\\"content references\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>References</h2></div><p>Coming soon</p></section><section class=\\\"content copies\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat=\\\"copy in vm.volume.copies\\\" ng-click=\\\"vm.editCopy(copy, $event)\\\"><span>{{copy.title}}</span><md-button class=\\\"md-secondary md-icon-button md-warn\\\" ng-click=\\\"vm.deleteCopy(copy, $event)\\\"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div>\");\n$templateCache.put(\"app/work/work-edit-dialog.html\",\"<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat=\\\"title in vm.work.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteTitle(title, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'authors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat=\\\"author in vm.work.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'authors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"vm.addAuthor(\\'otherAuthors\\', $event)\\\"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in vm.work.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"vm.deleteAuthor(\\'otherAuthors\\', author, $event)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/work/work.html\",\"<nav layout=row layout-padding><ol class=breadcrumbs flex><li>{{vm.bcTitle.title}}{{vm.bcTitle && vm.bcTitle.subtitle ? \\': \\' : \\'\\'}}{{vm.bcTitle.subTitle}}</li></ol></nav><div layout=row layout-padding><div layout=column flex=60><section class=\\\"content citation\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if=\\\"vm.work.authors && vm.work.authors.length > 0\\\"><span class=author ng-repeat=\\\"author in vm.work.authors\\\"><span ng-if=author.authorId><a ui-sref=\\\"editor.person({id: author.authorId})\\\">{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \\', \\' : \\'\\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \\': \\' : \\'\\'}}{{vm.title.subtitle}}.</span></p></section><section class=\\\"content summary\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.work.summary ng-bind-html=vm.work.summary></p></section><section class=\\\"content editions\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Editions</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addEdition($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat=\\\"edition in vm.work.editions\\\" ui-sref=\\\"editor.edition({workId: vm.work.id, editionId: edition.id})\\\"><span>{{edition.editionName}}</span><md-button class=\\\"md-secondary md-icon-button md-warn\\\" ng-click=\\\"vm.deleteEdition(edition, $event)\\\"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div><div layout=column flex=40><section class=\\\"content references\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Relationships</h2></div><p>Coming soon</p></section><section class=\\\"content copies\\\"><div class=toolbar layout=row layout-align=\\\"start center\\\"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat=\\\"copy in vm.work.copies\\\" ng-click=\\\"vm.editCopy(copy, $event)\\\"><span>{{copy.title}}</span><md-button class=\\\"md-secondary md-icon-button md-warn\\\" ng-click=\\\"vm.deleteCopy(copy, $event)\\\"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div>\");\n$templateCache.put(\"app/components/date-editor/date-editor.html\",\"<div layout=row><md-input-container flex><label>date</label><input type=text ng-model=date.description></md-input-container><md-input-container flex><label>ISO-8601 date</label><input type=datetime ng-model=date.calendar></md-input-container></div>\");\n$templateCache.put(\"app/components/summary-edit-dialog/summary-edit-dialog.html\",\"<md-dialog flex=50><md-toolbar><div class=md-toolbar-tools><h3>Summary Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><!-- material-compliant padding not used since WYSIWYG text editor *is* the UI --><summary-editor ng-model=vm.summary></summary-editor></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/components/summary-editor/summary-editor.html\",\"<div ckeditor ng-model=summary></div>\");\n$templateCache.put(\"app/person/components/event-editor/event-editor.html\",\"<div layout=column><div layout=row><md-input-container flex><label>location</label><input type=text ng-model=event.location></md-input-container><date-editor ng-model=event.date flex></date-editor></div><div layout=row layout-padding><div flex><h2>Description</h2><div flex ckeditor ng-model=event.description></div></div></div></div>\");\n$templateCache.put(\"app/person/components/name-editor/name-editor.html\",\"<div layout=column><div layout=row><md-input-container flex=10><label>title</label><input type=text ng-model=name.title></md-input-container><md-input-container flex=30><label>given</label><input type=text ng-model=name.givenName></md-input-container><md-input-container flex=20><label>middle</label><input type=text ng-model=name.middleName></md-input-container><md-input-container flex=30><label>family</label><input type=text ng-model=name.familyName></md-input-container><md-input-container flex=10><label>suffix</label><input type=text ng-model=name.suffix></md-input-container></div><md-input-container><label>display label</label><input type=text ng-model=name.label required></md-input-container></div>\");\n$templateCache.put(\"app/task/components/work-editor/work-editor-item.html\",\"<div layout=row layout-align=\\\"center center\\\" ng-if=!vm.loaded><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if=vm.loaded><work-editor ng-model=vm.work></work-editor></div>\");\n$templateCache.put(\"app/work/components/author-ref-editor/author-ref-editor.html\",\"<div layout=column><div layout=row><md-autocomplete required md-items=\\\"item in vm.authorRoles\\\" md-item-text=role md-min-length=0 md-search-text=ref.role md-selected-item-change=\\\"ref.role = item\\\" md-floating-label=role><md-item-template><span md-highlight-text=ref.role>{{item}}</span></md-item-template></md-autocomplete><md-input-container flex><label>first name</label><input type=text ng-model=ref.firstName></md-input-container><md-input-container flex><label>last name</label><input type=text ng-model=ref.lastName></md-input-container></div><div layout=row><md-autocomplete flex md-items=\\\"person in vm.getResults(vm.linkAuthorSearchText)\\\" md-item-text=person.label md-search-text=vm.linkAuthorSearchText md-search-text-change=vm.searchPeople(vm.linkAuthorSearchText) md-selected-item-change=vm.setLinkedAuthor(person) md-floating-label=\\\"linked author\\\"><span md-highlight-text=vm.linkAuthorSearchText>{{person.label}}</span></md-autocomplete></div></div>\");\n$templateCache.put(\"app/work/components/copy-editor/copy-editor.html\",\"<ng-form name=copyForm layout=column flex><md-input-container><label for=title>Title</label><input type=text name=title id=title ng-model=copy.title></md-input-container><div layout=row><md-input-container><label for=type>Type</label><md-select name=type id=type ng-model=copy.type required ng-change=\\\"vm.setProperties(copy.type, copyUrl)\\\"><md-option ng-repeat=\\\"handler in vm.refHandlers\\\" value={{handler.id}}>{{handler.display}}</md-option></md-select></md-input-container><md-input-container flex><label for=url>URL</label><input type=url name=url id=url ng-model=copyUrl ng-change=\\\"vm.setProperties(copy.type, copyUrl)\\\"></md-input-container></div><ul class=\\\"properties properties-inline\\\"><li ng-repeat=\\\"(key, value) in copy.properties\\\"><span class=label>{{key}}</span> <span class=value>{{value}}</span></li></ul><md-input-container><label for=rights>Description of Rights</label><input type=text name=rights id=rights ng-model=copy.rights></md-input-container><h3>Summary</h3><summary-editor ng-model=copy.summary flex></summary-editor></ng-form>\");\n$templateCache.put(\"app/work/components/edition-editor/edition-editor.html\",\"<div layout=row><md-input-container flex><label>edition name</label><input type=text ng-model=edition.editionName required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=edition.publicationInfo flex></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=edition.titles.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat=\\\"title in edition.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"edition.titles.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=edition.authors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat=\\\"author in edition.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"edition.authors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=edition.otherAuthors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in edition.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"edition.otherAuthors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><h2>Summary</h2><summary-editor ng-model=edition.summary flex></summary-editor></section><section class=volumes><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Volumes</h2><span flex></span><md-button class=md-icon-button ng-click=vm.createVolume()><md-icon>add</md-icon></md-button></div></md-toolbar><md-whiteframe class=volume layout=column layout-margin ng-repeat=\\\"volume in vm.volumes\\\" ng-class=\\\"{\\'md-whiteframe-2dp\\': !volume.focused, \\'md-whiteframe-8dp\\': volume.focused}\\\"><h3 layout=row><div flex layout=row layout-align=\\\"start center\\\" ng-click=\\\"volume.focused = !volume.focused\\\"><md-icon>{{ edition.focused ? \\'expand_less\\' : \\'expand_more\\'}}</md-icon><span>Volume {{volume.model.volumeNumber}}</span> <span flex></span></div><md-button class=\\\"md-icon-button md-warn\\\" ng-click=vm.deleteVolume($index)><md-icon>delete</md-icon></md-button></h3><div slide-toggle=volume.focused><volume-editor ng-model=volume.model flex></volume-editor></div></md-whiteframe></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=edition.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat=\\\"copy in edition.copies\\\"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"edition.copies.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></div></div></section>\");\n$templateCache.put(\"app/work/components/publication-info-editor/publication-info-editor.html\",\"<div layout=row><md-input-container flex><label>publisher</label><input type=text ng-model=pubInfo.publisher></md-input-container><md-input-container flex><label>location</label><input type=text ng-model=pubInfo.place></md-input-container><date-editor ng-model=pubInfo.date flex></date-editor></div>\");\n$templateCache.put(\"app/work/components/title-editor/title-editor.html\",\"<div layout=row><md-input-container><label>type</label><md-select ng-model=title.type required><md-option value=bibliographic>bibliographic</md-option><md-option value=canonical>canonical</md-option><md-option value=short>short</md-option></md-select></md-input-container><md-input-container flex><label>title</label><input type=text ng-model=title.title required><div ng-switch=title.type><small ng-switch-when=bibliographic>the full title as published on the work</small> <small ng-switch-when=canonical>title by which the work is commonly known in the academic realm</small> <small ng-switch-when=short>shortened title coloquially used by the public</small></div></md-input-container><md-input-container flex><label>subtitle</label><input type=text ng-model=title.subtitle></md-input-container></div>\");\n$templateCache.put(\"app/work/components/volume-editor/volume-editor.html\",\"<div layout=row><md-input-container flex><label>volume number</label><input type=text ng-model=volume.volumeNumber required></md-input-container></div><section class=publication layout=column><h2>Publication Information</h2><publication-info-editor ng-model=volume.publicationInfo></publication-info-editor></section><section class=titles layout=column><h2 layout=row><span flex>Titles</span><md-button class=md-icon-button ng-click=volume.titles.push({})><md-icon>add</md-icon></md-button></h2><div class=title layout=row ng-repeat=\\\"title in volume.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"volume.titles.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><h2 layout=row><span flex>Authors</span><md-button class=md-icon-button ng-click=volume.authors.push({})><md-icon>add</md-icon></md-button></h2><div class=author layout=row ng-repeat=\\\"author in volume.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"volume.authors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=volume.otherAuthors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in volume.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"volume.otherAuthors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><h2>Summary</h2><summary-editor ng-model=volume.summary flex></summary-editor></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=volume.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat=\\\"copy in volume.copies\\\"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"volume.copies.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></div></div></section>\");\n$templateCache.put(\"app/work/components/work-editor/work-editor.html\",\"<section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=work.titles.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat=\\\"title in work.titles\\\"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"work.titles.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=work.authors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat=\\\"author in work.authors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"work.authors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=\\\"authors other-authors\\\" layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Other Authors</h2><span flex></span><md-button class=md-icon-button ng-click=work.otherAuthors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=\\\"author other-author\\\" layout=row ng-repeat=\\\"author in work.otherAuthors\\\"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"work.otherAuthors.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Summary</h2></div></md-toolbar><summary-editor ng-model=work.summary flex></summary-editor></section><section class=editions><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Editions</h2><span flex></span><md-button class=md-icon-button ng-click=vm.createEdition()><md-icon>add</md-icon></md-button></div></md-toolbar><md-whiteframe class=edition layout=column layout-margin ng-repeat=\\\"edition in vm.editions\\\" ng-class=\\\"{ \\'md-whiteframe-2dp\\': !edition.focused, \\'md-whiteframe-8dp\\': edition.focused }\\\"><h3 layout=row><div flex layout=row layout-align=\\\"start center\\\" ng-click=\\\"edition.focused = !edition.focused\\\"><md-icon>{{ edition.focused ? \\'expand_less\\' : \\'expand_more\\'}}</md-icon><span>{{edition.model.editionName}}</span> <span flex></span></div><md-button class=\\\"md-icon-button md-warn\\\" ng-click=vm.deleteEdition($index)><md-icon>delete</md-icon></md-button></h3><div slide-toggle=edition.focused><edition-editor ng-model=edition.model flex></edition-editor></div></md-whiteframe></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=work.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat=\\\"copy in work.copies\\\"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class=\\\"md-icon-button md-warn\\\" ng-click=\\\"work.copies.splice($index, 1)\\\"><md-icon>delete</md-icon></md-button></div></div></section>\");}]);"],"sourceRoot":"/source/"}