!function(){"use strict";angular.module("trcBio",["ngResource"])}(),function(){"use strict";function e(){function e(e,n){function r(){var e=new h;return f(e)}function o(){var e={};return p(e)}function a(){var e={};return m(e)}function i(){var e={};return g(e)}function l(){var e={};return e}function d(e){return h.get({id:e})}function c(e){return h.get({q:e})}function u(e){var t;return t=e.id?h.update({id:e.id},e):h.save(null,e),t.$promise.then(function(t){return e.id=t.id,e})}function s(e){var t=h["delete"]({id:e});return t.$promise}function f(e){return e.meta?p(e.meta):e.meta=o(),e.name?m(e.name):e.name=a(),e.altNames?e.altNames.forEach(m):e.altNames=[],e.birth?g(e.birth):e.birth=i(),e.death?g(e.death):e.death=i(),e}function p(e){return e.links||(e.links={}),e}function m(e){return e}function g(e){return e.date||(e.date=l()),e}var h=n(t.url+"/:id",null,{update:{method:"PUT"}}),v={};return v.create=r,v.createName=a,v.createEvent=i,v.get=d,v.search=c,v.save=u,v["delete"]=s,v}e.$inject=["$q","$resource"];var t={};return t.url="/api/people",t.$get=e,t}angular.module("trcBio").provider("peopleRepo",e)}(),function(){"use strict";function e(){function e(e,t){function n(){var n=t.createName();e.person.altNames.push(n)}function r(t){e.person.altNames.splice(t,1)}function o(n){var r=t.createEvent();e.person[n]=r}function a(t){e.person[t]=null}var i=this;i.addName=n,i.removeName=r,i.addEvent=o,i.removeEvent=a}e.$inject=["$scope","peopleRepo"];var t={restrict:"E",templateUrl:"app/trc-bio/person-editor.html",scope:{person:"=ngModel"},controller:e,controllerAs:"personEditor"};return t}angular.module("trcBio").directive("trcPersonEditor",e)}(),function(){"use strict";function e(){function e(){var e=this;e.roles=[{value:"canonical",label:"Canonical Name"},{value:"pseudonym",label:"Pseudonym"},{value:"maiden",label:"Maiden Name"},{value:"designation",label:"Honorary Designation"},{value:"nickname",label:"Nickname"},{value:"phonetic",label:"Phonetic Name"}]}var t={restrict:"E",templateUrl:"app/trc-bio/name-editor.html",scope:{name:"=ngModel"},controller:e,controllerAs:"nameEditor"};return t}angular.module("trcBio").directive("trcNameEditor",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/trc-bio/event-editor.html",scope:{event:"=ngModel"}};return e}angular.module("trcBio").directive("trcEventEditor",e)}(),function(){"use strict";angular.module("trcGraph",["ngResource"])}(),function(){"use strict";function e(){function e(e){function n(e){return r.get({type:e})}var r=e(t.url+"/:type"),o={};return o.get=n,o}e.$inject=["$resource"];var t={};return t.url="/api/graph",t.$get=e,t}angular.module("trcGraph").provider("graphRepo",e)}(),function(){"use strict";angular.module("sda.concept-browser",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ngMaterial","trcBiblio","trcBio","trcGraph"])}(),function(){"use strict";function e(e,t,n,r,o,a,i,l,d){function c(){var e="people",n=a.type||e;f.graphLoading=!1,s(n)["catch"](function(){return r.showSimple('Unable to load the "'+n+'"graph type. Falling back to "'+e+'".'),s(e)}).then(function(e){f.graphLoading=!1,f.graph=e.graph},function(){f.graphLoading=!0,r.showSimple("Unable to load graph data.")}),t.$watch("main.activeNode",function(e){e?(f.loaded=!1,u(e).then(function(){f.loaded=!0},function(){r.showSimple("Unable to load data.")})):f.person=null})}function u(e){function t(e){var t={id:e.id,directed:e.directed};return e.directed?(t.out={label:e.title,nodes:[]},t["in"]={label:e.reverseTitle,nodes:[]}):t.none={label:e.title,nodes:[]},t}function r(e){return c.hasOwnProperty(e.id)||(c[e.id]=t(e)),c[e.id]}f.person=i.get(e.id);var o=l.searchByAuthor(e.id),a=o.$promise.then(function(){if(!o.items)throw new Error("unable to load items");return f.works=o.items,f.works}),d={"uk.ac.ox.bodleian.sda.relationships.influence":{id:"uk.ac.ox.bodleian.sda.relationships.influence",title:"Influenced",reverseTitle:"Influenced By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.provoked":{id:"uk.ac.ox.bodleian.sda.relationships.provoked",title:"Provoked",reverseTitle:"Provoked By",directed:!0},"uk.ac.ox.bodleian.sda.relationships.consonance":{id:"uk.ac.ox.bodleian.sda.relationships.consonance",title:"Consonance",directed:!1},"uk.ac.ox.bodleian.sda.relationships.patternmatch":{id:"uk.ac.ox.bodleian.sda.relationships.patternmatch",title:"Possible Pattern Match",directed:!1}},c={};e.outEdges.map(function(e){var t=d[e.relation];if(t){var n=r(t);n[t.directed?"out":"none"].nodes.push(e.target)}}),e.inEdges.map(function(e){var t=d[e.relation];if(t){var n=r(t);n[t.directed?"in":"none"].nodes.push(e.source)}}),f.related=[];for(var u in c)c.hasOwnProperty(u)&&f.related.push(c[u]);return n.all([f.person.$promise,a])}function s(e){var t=d.get(e);return t.$promise.then(function(){var e={};return t.graph.nodes.forEach(function(t){t.inEdges=[],t.outEdges=[],e[t.id]=t}),t.graph.edges.forEach(function(t){var n=e[t.source],r=e[t.target];t.source=r,r.outEdges.push(t),t.target=n,n.inEdges.push(t)}),t})}var f=this;f.graph=null,f.activeNode=null,f.person=null,f.works=null,f.related=null,f.loaded=!0,f.graphLoading=!0,c()}e.$inject=["$http","$scope","$q","$mdToast","$location","$stateParams","peopleRepo","worksRepo","graphRepo"],angular.module("sda.concept-browser").controller("MainController",e)}(),function(){"use strict";angular.module("trcBiblio",["ngResource"])}(),function(){"use strict";function e(){function e(e){function n(){return r("")}function r(e){return x.get({q:e,max:50})}function o(e){return x.get({aid:e,max:50})}function a(e){if(angular.isUndefined(e))throw new TypeError("Invalid ID provided to getWork");var t=x.get({workId:e});return t.$promise.then(v),t}function i(e,t){if(angular.isUndefined(e)||angular.isUndefined(t))throw new TypeError("Invalid IDs provided to getEdition");var n=k.get({workId:e,editionId:t});return n.$promise.then(b),n}function l(e,t,n){if(angular.isUndefined(e)||angular.isUndefined(t)||angular.isUndefined(n))throw new TypeError("Invalid IDs provided to getVolume");var r=E.get({workId:e,editionId:t,volumeId:n});return r.$promise.then(y),r}function d(){var e=new x;return v(e),e.titles.push({}),e.authors.push({}),e}function c(){var e=new k;return b(e)}function u(){var e=new E;return y(e)}function s(){switch(arguments.length){case 1:return f.apply(null,arguments);case 2:return p.apply(null,arguments);case 3:return m.apply(null,arguments)}throw new TypeError("Unexpected arguments to worksRepo#save")}function f(e){if(!(e instanceof x))throw new Error("work was not created by this repo");return e.id?e.$update():e.$save()}function p(e,t){if(!e)throw new Error("no work id provided");if(!(t instanceof k))throw new Error("edition was not created by this repo");return t.id?t.$update({workId:e}):t.$save({workId:e})}function m(e,t,n){if(!e)throw new Error("no work id provided");if(!t)throw new Error("no edition id provided");if(!(n instanceof E))throw new Error("volume was not created by this repo");return n.id?n.$update({workId:e,editionId:t}):n.$save({workId:e,editionId:t})}function g(e){var t=x["delete"]({id:e});return t.$promise}function h(e){return e.titles?e.titles.forEach(function(e){e.type=e.type.toLowerCase()}):e.titles=[],e.authors?e.authors.forEach(function(e){e.role=e.role.toLowerCase()}):e.authors=[],e.otherAuthors?e.otherAuthors.forEach(function(e){e.role=e.role.toLowerCase()}):e.otherAuthors=[],e.copies||(e.copies=[]),e}function v(e){return h(e),e.editions?e.editions.forEach(b):e.editions=[],e}function b(e){return h(e),e.volumes?e.volumes.forEach(y):e.volumes=[],e}function y(e){return h(e),e}function w(e,t){return angular.isArray(t)||(t=[t]),t.reduce(function(t,n){if(t)return t;for(var r=0;r<e.length;r++)if(e[r].type===n)return e[r];return null},null)}var x=e(t.url+"/:workId",{workId:"@id"},{update:{method:"PUT"}}),k=e(t.url+"/:workId/editions/:editionId",{editionId:"@id"},{update:{method:"PUT"}}),E=e(t.url+"/:workId/editions/:editionId/volumes/:volumeId",{volumeId:"@id"},{update:{method:"PUT"}}),$={};return $.getAll=n,$.search=r,$.searchByAuthor=o,$.get=a,$.getWork=a,$.getEdition=i,$.getVolume=l,$.create=d,$.createWork=d,$.createEdition=c,$.createVolume=u,$.save=s,$.saveWork=f,$.saveEdition=p,$.saveVolume=m,$["delete"]=g,$.getTitle=w,$}e.$inject=["$resource"];var t={};return t.url="/api/works",t.$get=e,t}angular.module("trcBiblio").provider("worksRepo",e)}(),function(){"use strict";function e(e,t){function n(n,r){var o=n.width,a=!1,i=n.height,l=!1,d=n.layout,c=r.get(0);t(function(){o||(o=r.width(),a=!0),i||(i=r.height(),l=!0);var t=ConceptBrowser(c,d).size([o,i]);n.graph&&(t.data(n.graph.nodes,n.graph.edges),t.refresh()),angular.element(e).on("resize",function(){if(a||l){var e=o,n=i;a&&(o=r.width()),l&&(i=r.height()),(e!==o||n!==i)&&(t.size([o,i]),t.refresh())}});var u=!1;t.on("activate",function(e){u||n.$apply(function(){n.activeNode=e.node})}),n.$watchGroup(["width","height","graph","activeNode"],function(e,n){var r=!1;if(e[0]&&e[0]!==n[0]&&(o=e[0],t.size([o,i]),e[2]&&(r=!0)),e[1]&&e[1]!==n[1]&&(i=e[1],t.size([o,i]),e[2]&&(r=!0)),e[2]&&e[2]!==n[2]){var a=angular.copy(e[2]);t.data(a.nodes,a.edges),r=!0}e[3]&&e[3]!==n[3]&&(u=!0,t.activate(e[3]),u=!1),r&&t.refresh()})})}var r={restrict:"E",scope:{graph:"=ngModel",width:"=",height:"=",padding:"=",layout:"@",activeNode:"="},link:n};return r}e.$inject=["$window","$timeout"],angular.module("sda.concept-browser").directive("conceptBrowser",e)}(),function(){"use strict";function e(e){e.debug("runBlock end")}e.$inject=["$log"],angular.module("sda.concept-browser").run(e)}(),function(){"use strict";function e(e,t){e.state("home",{url:"/{type}",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("sda.concept-browser").config(e)}(),function(){"use strict";angular.module("sda.concept-browser").constant("d3",d3).constant("moment",moment)}(),function(){"use strict";function e(e,t,n,r,o){e.debugEnabled(!0),t.definePalette("darkBrown",{50:"#595c59",100:"#4c4f4c",200:"#404240",300:"#333533",400:"#272827",500:"#1a1b1a",600:"#0d0e0d",700:"#010101",800:"#000000",900:"#000000",A100:"#e0f0e0",A200:"#565956",A400:"#7e837e",A700:"#000000",contrastDefaultColor:"light",contrastDarkColors:["A100"]}),t.definePalette("copper",{50:"#d4b190",100:"#cca47e",200:"#c5976b",300:"#be8a59",400:"#b67e47",500:"#a47140",600:"#926439",700:"#7f5832",800:"#6d4b2b",900:"#5b3e23",A100:"#dcc3ab",A200:"#a47140",A400:"#48321c",A700:"#272927",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"]}),t.theme("default").primaryPalette("darkBrown").accentPalette("copper"),n.url="/api/catalog/people",r.url="/api/catalog/works",o.url="/api/catalog/graph"}e.$inject=["$logProvider","$mdThemingProvider","peopleRepoProvider","worksRepoProvider","graphRepoProvider"],angular.module("sda.concept-browser").config(e)}(),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.EventDispatcher=t()}(this,function(){"use strict";function e(){function e(e,t){o[e]&&o[e].forEach(function(e){try{e(t)}catch(n){console.error(n)}}),a.forEach(function(n){try{n(e,t)}catch(r){console.error(r)}})}function t(e){return a.push(e),function(){var t=a.indexOf(e);t>=0&&a.splice(t,1)}}function n(e,t){return o[e]||(o[e]=[]),o[e].push(t),function(){var n=o[e].indexOf(t);n>=0&&o[e].splice(n,1)}}function r(e,t){var r=n(e,function(e){try{t(e)}catch(n){console.error(n)}finally{r()}});return r}var o={},a=[],i={};return i.all=t,i.on=n,i.once=r,i.trigger=e,i}return e}),function(e,t){"function"==typeof define&&define.amd?define(["d3"],t):"object"==typeof module&&module.exports?module.exports=t(require("d3")):t(d3)}(this,function(e){"use strict";function t(e){e.fixed|=2}function n(e){e.fixed&=-7}function r(e){e.fixed|=4,e.px=e.x,e.py=e.y}function o(e){e.fixed&=-5}function a(e,t,n){var r=0,o=0;if(e.charge=0,!e.leaf)for(var i,l=e.nodes,d=l.length,c=-1;++c<d;)i=l[c],i&&(a(i,t,n),e.charge+=i.charge,r+=i.charge*i.cx,o+=i.charge*i.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var u=t*n[e.point.index];e.charge+=e.pointCharge=u,r+=u*e.point.x,o+=u*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}function i(e){return"function"==typeof e}function l(e){return"number"==typeof e}var d=20,c=1,u=1/0;e.layout.force.cylindrical=function(){function s(e,t){return 2*Math.abs(e)>t&&(0>e?e+=t:e-=t),e}function f(e){return function(t,n,r,o){if(t.point!==e){var a=x[0],i=s(t.cx-e.x,a),l=t.cy-e.y,d=o-n,c=i*i+l*l,u=0;if(c>d*d/I)return M>c&&(u=t.charge/c,e.px-=i*u,e.py-=l*u),!0;t.point&&c&&M>c&&(u=t.pointCharge/c,e.px-=i*u,e.py-=l*u)}return!t.charge}}function p(t){t.px=e.event.x,t.py=e.event.y,y.resume()}var m,g,h,v,b,y={},w=e.dispatch("start","tick","end"),x=[1,1],k=.9,E=d,$=c,N=-30,M=u,A=.1,I=.64,P=[],B=[];return y.tick=function(){if((g*=.99)<.005)return w.end({type:"end",alpha:g=0}),!0;var t,n,r,o,i,l,d,c,u,p=P.length,m=B.length;for(n=0;m>n;++n)r=B[n],o=r.source,i=r.target,c=s(i.x-o.x,x[0]),u=i.y-o.y,l=c*c+u*u,0!==l&&(l=g*v[n]*((l=Math.sqrt(l))-h[n])/l,c*=l,u*=l,i.x-=c*(d=o.weight/(i.weight+o.weight)),i.y-=u*d,o.x+=c*(d=1-d),o.y+=u*d);if(d=g*A,0!==d&&(c=x[0]/2,u=x[1]/2,n=-1,d))for(;++n<p;)r=P[n],r.y+=(u-r.y)*d;if(N)for(a(t=e.geom.quadtree(P),g,b),n=-1;++n<p;)(r=P[n]).fixed||t.visit(f(r));for(n=-1;++n<p;)r=P[n],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*k,r.y-=(r.py-(r.py=r.y))*k);n=-1;for(var y=x[0];++n<p;){r=P[n];var E=r.px-r.x;r.x%=y,r.x<0&&(r.x+=y),r.px=r.x+E}w.tick({type:"tick",alpha:g})},y.nodes=function(e){return arguments.length?(P=e,y):P},y.links=function(e){return arguments.length?(B=e,y):B},y.size=function(e){return arguments.length?(x=e,y):x},y.linkDistance=function(e){return arguments.length?(E=i(e)?e:+e,y):E},y.linkStrength=function(e){return arguments.length?($=i(e)?e:+e,y):$},y.friction=function(e){return arguments.length?(k=+e,y):k},y.charge=function(e){return arguments.length?(N=i(e)?e:+e,y):N},y.chargeDistance=function(e){return arguments.length?(M=e*e,y):Math.sqrt(M)},y.gravity=function(e){return arguments.length?(A=+e,y):A},y.theta=function(e){return arguments.length?(I=e*e,y):Math.sqrt(I)},y.alpha=function(t){return arguments.length?(t=+t,g?g=t>0?t:0:t>0&&(w.start({type:"start",alpha:g=t}),e.timer(y.tick)),y):g},y.start=function(){function e(e,r){if(!n){for(n=new Array(o),c=0;o>c;++c)n[c]=[];for(c=0;a>c;++c){var i=B[c];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var l,d=n[t],c=-1,u=d.length;++c<u;)if(!isNaN(l=d[c][e]))return l;return Math.random()*r}var t,n,r,o=P.length,a=B.length,d=x[0],c=x[1];for(t=0;o>t;++t)(r=P[t]).index=t,r.weight=0;for(t=0;a>t;++t)r=B[t],l(r.source)&&(r.source=P[r.source]),l(r.target)&&(r.target=P[r.target]),++r.source.weight,++r.target.weight;for(t=0;o>t;++t)r=P[t],isNaN(r.x)&&(r.x=e("x",d)),isNaN(r.y)&&(r.y=e("y",c)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(h=[],i(E))for(t=0;a>t;++t)h[t]=+E.call(this,B[t],t);else for(t=0;a>t;++t)h[t]=E;if(v=[],i($))for(t=0;a>t;++t)v[t]=+$.call(this,B[t],t);else for(t=0;a>t;++t)v[t]=$;if(b=[],i(N))for(t=0;o>t;++t)b[t]=+N.call(this,P[t],t);else for(t=0;o>t;++t)b[t]=N;return y.resume()},y.resume=function(){return y.alpha(.1)},y.stop=function(){return y.alpha(0)},y.drag=function(){return m||(m=e.behavior.drag().origin(function(e){return e}).on("dragstart.force",t).on("drag.force",p).on("dragend.force",n)),arguments.length?void this.on("mouseover.force",r).on("mouseout.force",o).call(m):m},y.edgePath=function(){var e=x[0],t=function(e){return e[0][0]},n=function(e){return e[0][1]},r=function(e){return e[1][0]},o=function(e){return e[1][1]},a=function(a){a.attr("d",function(a){var i=t(a),l=n(a),d=r(a),c=o(a);return 2*Math.abs(i-d)<e?"M "+i+" "+l+" L "+d+" "+c:d>i?"M "+i+" "+l+" L "+(d-e)+" "+c+" M "+d+" "+c+" L "+(i+e)+" "+l:"M "+i+" "+l+" L "+(d+e)+" "+c+" M "+d+" "+c+" L "+(i-e)+" "+l})};return a.x1=function(e){return t=e,a},a.y1=function(e){return n=e,a},a.x2=function(e){return r=e,a},a.y2=function(e){return o=e,a},a},e.rebind(y,w,"on")}}),function(e,t){"function"==typeof define&&define.amd?define(["d3","event-dispatcher","d3-force-cylindrical"],t):"object"==typeof module&&module.exports?(require("d3-force-cylindrical"),module.exports=t(require("d3"),require("event-dispatcher"))):e.ConceptBrowser=t(e.d3,e.EventDispatcher)}(this,function(e,t){"use strict";function n(n,d,c){function u(e){return T=e[0],z=e[1],Q&&(j.attr("width",T).attr("height",z),W.range([0,T]),V.size([T,z])),Z}function s(e,t){return H=e,_=t,H.forEach(function(e){e.x=(e.x||Math.random())*T,e.y=(e.y||Math.random())*z}),Z}function f(e){if(H.indexOf(e)<0)throw new Error("node to be activated is not a member of the graph");k(e),M(),$(e)}function p(){return g(),V.nodes(H).links(_).start(),b(),y(),Z}function m(e){return 1-1/Math.pow(1+e,700)}function g(){if(!Q){if(Q=!0,!T||!z)throw new Error("No width/height set. Use size([width, height]) to set size before initializing");j=e.select(n).append("svg").attr("width",T).attr("height",z);var t=_.reduce(function(e,t){return e.indexOf(t.relation)<0&&e.push(t.relation),e},[]);C(j,t,["","activated","selected","focused"]);var l=j.append("g").attr("class","concept-browser");O=l.append("g").attr("class","edges"),q=l.append("g").attr("class","nodes"),S=l.append("rect").attr("class","progress").attr("x",0).attr("y",0).attr("height",2),W=e.scale.linear().domain([Math.log(.1),Math.log(.005)]).range([0,T]),G=function(e){return r+(o-r)*m(e)},V=a[d||"planar"]().size([T,z]).on("tick",v),h(V),V.edgePath&&(Y=V.edgePath().x1(function(e){return e.source.x}).y1(function(e){return e.source.y}).x2(function(e){return e.target.x}).y2(function(e){return e.target.y})),e.tip&&(J=e.tip().attr("class",i).direction(D).offset(L).html(function(e){return e.label}),R.on("focus",function(e){A(e.node)}),R.on("blur",function(e){I(e.node)})),R.on("focus",P),R.on("blur",P),R.on("select",P),R.on("deselect",P)}}function h(e){e.gravity(.1).linkDistance(50).linkStrength(function(e){var t=U(e.target);return m(t)}).charge(function(e){var t=[-50,-300],n=[0,1],r=U(e);return t[0]+(t[1]-t[0])/(n[1]-n[0])*(m(r)-n[0])}).friction(.9)}function v(e){if(B(),e.alpha>.0051){if(S.attr("width",W(Math.log(e.alpha))),Math.random()<.95)return}else S.attr("width",0);q.selectAll(".node").transition().duration(500).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),O.selectAll(".edge").transition().duration(500).call(Y)}function b(){var t=q.selectAll(".node").data(H,function(e){return e.id}),n=t.enter().append("g").attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).on("mouseover",w).on("mouseout",x).on("dblclick",k).on("click",function(t){e.event.ctrlKey?F.indexOf(t)<0?$(t):N(t):(M(),$(t))});n.append("circle").attr("r",function(e){var t=U(e);return G(t)}),t.exit().remove(),J&&q.call(J)}function y(){var e=O.selectAll(".edge").data(_,function(e){return e.source.id+","+e.target.id});e.enter().append("path").attr("class",function(e){return"edge "+e.relation}).attr("marker-end",function(e){return"url(#arrowhead-"+e.relation+")"}).style("stroke-width",function(e){var t=e.metadata&&e.metadata.multiplicity||1;return t+"pt"}).call(Y),e.exit().remove()}function w(e){x(),K=e,R.trigger("focus",{node:K,selection:F})}function x(e){if(e=e||K){if(K!==e)throw new Error("tried to blur a node that was not focused");K=null,R.trigger("blur",{node:e,selection:F})}}function k(e){X!==e&&(E(),X=e,R.trigger("activate",{node:X,selection:F}))}function E(e){if(e=e||X){if(X!==e)throw new Error("tried to deactivate a node that was not activated");X=null,R.trigger("deactivate",{node:e,selection:F})}}function $(e){if(!e)throw new Error("no node provided");if(!(F.indexOf(e)<0))throw new Error("tried to select a node that is already selected");F.push(e),R.trigger("select",{node:e,selection:F})}function N(e){if(!e)throw new Error("no node provided to deselect");var t=F.indexOf(e);if(0>t)throw new Error("tried to deselect a node that was not selected");F.splice(t,1),R.trigger("deselect",{node:e,selection:F})}function M(){F.forEach(function(e){R.trigger("deselect",{node:e,selection:[]})}),F=[]}function A(e){J&&J.attr("class",i).show(e)}function I(e){J&&J.attr("class",i).hide(e)}function P(){function e(e){return X===e}function t(e){return F.indexOf(e)>=0}function n(e){return K===e}function r(t){return e(t.source)||e(t.target)}function o(e){return t(e.source)||t(e.target)}function a(e){return n(e.source)||n(e.target)}q.selectAll(".node").classed("activated",function(t){return e(t)||t.outEdges.some(r)||t.inEdges.some(r)}).classed("selected",function(e){return t(e)||e.outEdges.some(o)||e.inEdges.some(o)}).classed("focused",function(e){return n(e)||e.outEdges.some(a)||e.inEdges.some(a)}),O.selectAll(".edge").classed("activated",r).classed("selected",o).classed("focused",a).attr("marker-end",function(e){var t="";return r(e)?t="-activated":o(e)?t="-selected":a(e)&&(t="-focused"),"url(#arrowhead-"+e.relation+t+")"})}function B(){H.forEach(function(e){e.x=Math.max(Math.min(e.x,T),0),e.y=Math.max(Math.min(e.y,z),0)})}function D(e){var t="";return e.y>z-l.bottom?t+="n":e.y<l.top&&(t+="s"),e.x>T-l.right?t+="w":e.x<l.left&&(t+="e"),""===t&&(t="n"),t}function L(e){var t=U(e),n=G(t),r=[0,0];return e.y>z-l.bottom?r[0]-=n:e.y<l.top&&(r[0]+=n),e.x>T-l.left_right?r[1]-=n:e.x<l.left_right&&(r[1]+=n),0===r[1]&&0===r[0]&&(r[0]-=n),r}function U(e){return e.metadata&&e.metadata.pagerank||(H&&H.length>0?1/H.length:1)}function C(e,t,n){var r=[];t.forEach(function(e){n.forEach(function(t){r.push("arrowhead-"+e+(t?"-"+t:""))})}),e.append("defs").selectAll("marker").data(r).enter().append("marker").attr("id",function(e){return e}).attr("viewBox","0 -4 10 8").attr("refX",25).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0,-4 L 10,0 L 0,4")}d=d||"planar",c=c||{};var R=t();c.debug&&R.all(function(e,t){console.log(e,t.node?t.node.id:t)});var T,z,j,q,O,S,W,G,V,H=[],_=[],F=[],K=null,X=null,Y=function(e){e.attr("d",function(e){var t=e.source.x,n=e.source.y,r=e.target.x,o=e.target.y;return"M "+t+" "+n+" L "+r+" "+o})},J=null,Q=!1,Z={};return Z.size=u,Z.data=s,Z.activate=f,Z.refresh=p,Z.on=R.on,Z}var r=4,o=10,a={planar:e.layout.force,cylindrical:e.layout.force.cylindrical},i="d3-tip",l={left:200,right:200,top:100,bottom:100};return e.tip||console.warn("d3.tip is not available; tooltips will not display properly."),n}),angular.module("sda.concept-browser").run(["$templateCache",function(e){e.put("app/main/main.html",'<md-sidenav md-component-id=right class=md-sidenav-right md-is-open=main.activeNode md-disable-backdrop md-whiteframe=4 layout=column><md-toolbar><div class=md-toolbar-tools><h2>Node Information</h2><span flex></span><md-button class=md-icon-button ng-click="main.activeNode = null"><md-icon>close</md-icon></md-button></div></md-toolbar><div flex layout=column layout-align="center center" ng-if=!main.loaded><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class=node-info flex layout=column ng-if=main.loaded><h3 class=name><span class=given>{{main.person.name.givenName}}</span> <span class=family>{{main.person.name.familyName}}</span></h3><md-tabs flex><md-tab><md-tab-label><md-icon>person</md-icon></md-tab-label><md-tab-body><div class=summary ng-if=main.person.summary ng-bind-html=main.person.summary></div><div class=books ng-if="main.works && main.works.length > 0"><h4>Books ({{main.works.length}})</h4><md-list><md-list-item ng-repeat="work in main.works" ng-href=../#/library/books/{{work.id}}>{{work.label}}</md-list-item></md-list></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body><md-list class=relationships ng-if="main.related && main.related.length > 0"><div ng-repeat="group in main.related"><div ng-if=group.directed><div ng-if="group.out.nodes.length > 0"><md-subheader class=md-no-sticky>{{group.out.label}}</md-subheader><md-list-item ng-repeat="node in group.out.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div><div ng-if="group.in.nodes.length > 0"><md-subheader class=md-no-sticky>{{group.in.label}}</md-subheader><md-list-item ng-repeat="node in group.in.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div></div><div ng-if=!group.directed><div ng-if="group.none.nodes.length > 0"><md-subheader class=md-no-sticky>{{group.none.label}}</md-subheader><md-list-item ng-repeat="node in group.none.nodes track by node.id" ng-click="main.activeNode = node">{{node.label}}</md-list-item></div></div></div></md-list></md-tab-body></md-tab></md-tabs></div></md-sidenav><md-toolbar><div class=md-toolbar-tools><img class=logo src=assets/images/sda-logo-light.png alt=SDA><h1>Concept Browser</h1><span flex></span></div></md-toolbar><div style="overflow: hidden" flex layout=column><concept-browser flex ng-if=main.graph ng-model=main.graph active-node=main.activeNode></concept-browser><div ng-if="!main.graph && vm.graphLoading" flex layout=column layout-align="center center" layout-padding><md-progress-circular md-mode=indeterminate></md-progress-circular><div class="text-center md-headline md-secondary">Loading graph data&hellip;<br>This may take a while.</div></div></div>'),e.put("app/trc-bio/event-editor.html",'<div class=form-group><label class=control-label for=event-title>Title</label><input type=text id=event-title name=event-title class="form-control event-title" ng-model=event.title></div><div class=form-group><label class=control-label for=event-description>Description</label><textarea id=event-description name=event-description class="form-control event-description" ng-model=event.description></textarea></div><div class=form-group><label class=control-label for=event-location>Location</label><input type=text id=event-location name=event-location class="form-control event-location" ng-model=event.location></div><div class=form-group><label class=control-label for=event-date>Date</label><input type=text id=event-date name=event-date class="form-control event-date" ng-model=event.date.description><!-- TODO add datepicker --></div>'),e.put("app/trc-bio/name-editor.html",'<div class=form-group class=name-role><label class=control-label for=name-role>Role</label><select id=name-role name=name-role class="form-control name-role" ng-model=name.role><option ng-repeat="role in nameEditor.roles" value={{role.value}}>{{role.label}}</option></select></div><div class=form-group class=name-structure><label class=control-label>Structured Name</label><input type=text class=name-title placeholder=title ng-model=name.title> <input type=text class=name-given placeholder=given ng-model=name.givenName> <input type=text class=name-middle placeholder=middle ng-model=name.middleName> <input type=text class=name-family placeholder=family ng-model=name.familyName> <input type=text class=name-suffix placeholder=suffix ng-model=name.suffix></div><div class=form-group class=name-label><label for=label>Display Label</label><input type=text placeholder=label ng-model=name.label></div>'),e.put("app/trc-bio/person-editor.html",'<div class=form-group><label for=person-name>Primary Name</label><trc-name-editor id=person-name ng-model=person.name></trc-name-editor></div><div class=form-group><label for=person-altnames>Alternate Names</label><div ng-repeat="name in person.altNames"><trc-name-editor id=person-altnames ng-model=name></trc-name-editor><button ng-click=personEditor.removeName($index)>&minus;</button></div><button ng-click=personEditor.addName()>+</button></div><div class=form-group><label for=person-birth>Birth</label><div ng-if=person.birth><trc-event-editor id=person-birth ng-model=person.birth></trc-event-editor><button ng-click="personEditor.removeEvent(\'birth\')">&minus;</button></div><div ng-if=!person.birth><button ng-click="personEditor.addEvent(\'birth\')">+</button></div></div><div class=form-group><label for=person-death>Death</label><div ng-if=person.death><trc-event-editor id=person-death ng-model=person.death></trc-event-editor><button ng-click="personEditor.removeEvent(\'death\')">&minus;</button></div><div ng-if=!person.death><button ng-click="personEditor.addEvent(\'death\')">+</button></div></div><div class=form-group><label class=control-label for=person-summary>Summary</label><textarea id=person-summary name=person-summary class="form-control person-summary" ng-model=person.summary></textarea></div>')}]);
//# sourceMappingURL=../maps/scripts/app-77e506adb0.js.map
