!function(){"use strict";angular.module("sdaAdminWeb",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ckeditor","ngMaterial","ngDragDrop","pouchdb","slideToggle","trcCore","trcWorks","trcTasks","trcBio","trcReln","trcRefs","trcArticles","vwise","zotero"])}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/work/components/title-editor/title-editor.html",scope:{title:"=ngModel"}};return t}angular.module("sdaAdminWeb").directive("titleEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/work/components/publication-info-editor/publication-info-editor.html",scope:{pubInfo:"=ngModel"}};return t}angular.module("sdaAdminWeb").directive("publicationInfoEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/work/components/copy-editor/copy-editor.html",scope:{copy:"=ngModel"},controller:e,controllerAs:"vm"};return t}function e(t){function e(){r(o()),r(i()),r(n())}function r(t){l.refHandlers[t.id]=t}function a(e,n){l.refHandlers[e]&&(t.copy.properties=l.refHandlers[e](n)),t.copyForm.url.$setValidity(e,null!=t.copy.properties)}var l=this;l.refHandlers={},l.setProperties=a,e()}function n(){function t(t){var n=r(t);if(!n)return null;var o,i;if("/stream/"===n.path.substr(0,8)){o=n.path.substr(8);var a=n.fragment.match(/page\/([^\/]+)/);a&&a.length>=2&&(i=a[1])}return e(t,o,i)}function e(t,e,n){return e?{src:t,id:e,seq:n}:null}return t.id="internetarchive",t.display="Internet Archive",t}function o(){function t(t){var e=r(t);if(!e)return null;var n,o;switch(e.hostname){case"babel.hathitrust.org":n=e.query.id,o=e.query.seq;break;case"hdl.handle.net":if(n=e.path.substr(e.path.lastIndexOf("/")+1),!e.query.urlappend)break;var i=a(e.query.urlappend);if(!i)break;o=i.seq}return n?{src:t,htid:n,seq:o}:null}return t.id="hathitrust",t.display="HathiTrust",t}function i(){function t(t){var e=r(t);if(!e)return null;switch(e.hostname){case"books.google.com":var n=e.query.id,o=e.query.printsec,i=e.query.pg}return n?{src:t,id:n,section:o,page:i}:null}return t.id="googlebooks",t.display="Google Books",t}function r(t){if(!t)return null;var e=document.createElement("a");return e.href=t,{toString:function(){return t},protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,path:e.pathname,query:a(e.search),fragment:e.hash}}function a(t,e){if(!t||!angular.isString(t))return{};if("?"===t[0]&&(t=t.substr(1)),!e){var n=(t.indexOf(";")>=0?1:0)+(t.indexOf("&")>=0?2:0);e=1===n?";":"&"}var o={},i=t.split(e);return i.forEach(function(t){var e=t.indexOf("="),n=t,i=null;if(n){e>=0&&(n=t.substr(0,e),i=t.substr(e+1));try{n=decodeURIComponent(n),i=decodeURIComponent(i)}catch(r){return}o.hasOwnProperty(n)?angular.isArray(o[n])?o[n].push(i):o[n]=[o[n],i]:o[n]=i}}),o}e.$inject=["$scope"],angular.module("sdaAdminWeb").directive("copyEditor",t)}(),function(){"use strict";function t(){function t(t,e){function n(){if(t.ref.authorId){var n=e.get(t.ref.authorId);n.$promise.then(function(){r.linkAuthorSearchText=n.name.label})}}function o(e){t.ref.authorId=e.id}function i(t){var n=e.search(t);return n.$promise.then(function(){return n.items})}var r=this;r.linkAuthorSearchText="",r.authorRoles=["author","editor","translator","other"],r.setLinkedAuthor=o,r.getResults=i,n()}t.$inject=["$scope","peopleRepo"];var e={restrict:"E",templateUrl:"app/work/components/author-ref-editor/author-ref-editor.html",scope:{ref:"=ngModel"},controller:t,controllerAs:"vm"};return e}angular.module("sdaAdminWeb").directive("authorRefEditor",t)}(),function(){"use strict";angular.module("vwise",["ngSanitize","google.books","cfp.hotkeys","trcWorks","trcBio"])}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/vwise/components/workspace/workspace.html",scope:{workspace:"="},controller:e,controllerAs:"vm"};return t}function e(t,e){function n(n,o){var i=o.draggable.scope(),r=i.item;if(r){var a=angular.element(n.target).offset(),l={xPosition:o.position.left-a.left,yPosition:o.position.top-a.top,width:600,height:400,background:"#ffffff"},d=e.findContentMediators(r,l),s=d.length>0?d[0]:null;if(s){var c=s.initPanelData(r,l);c.then(function(e){return t.workspace.createPanel(s,e,l)})}}}function o(n,o){var i={note:""},r={xPosition:n,yPosition:o},a=e.findContentMediators(i,r),l=a.length>0?a[0]:null;t.workspace.createPanel(l,i,r)}function i(t){if(t.ctrlKey){var e=angular.element(t.target).offset();o(t.clientX-e.left,t.clientY-e.top)}}var r=this;r.thingDropped=n,r.workspaceClicked=i}e.$inject=["$scope","panelContentMediatorRegistry"],angular.module("vwise").directive("vwiseWorkspace",t)}(),function(){"use strict";function t(t){function n(t,e,n,r){var a=r(i.db);return new o(t,a,n)}n.$inject=["panelContentMediatorRegistry","$http","$q","pouchDB"];var o=e(t),i={db:{name:"vwise"},$get:n};return i}function e(t){function e(e,n,o){t.WorkspaceRepository.call(this,e),this.$q=o,this.db=n,this.workspaces=new t.Cache,this.panels=new t.Cache}return e.prototype=Object.create(t.WorkspaceRepository.prototype),e.prototype.listWorkspaceIds=function(){return this.db.allDocs({include_docs:!0}).then(function(t){return t.rows.filter(function(t){return t.doc&&"workspace"===t.doc.type}).map(function(t){return t.id})})},e.prototype.createWorkspace=function(e){var n=t.UUID.uuid4(),o=new t.Workspace(n,this);return e&&(o.title=e),this.saveWorkspace(o)},e.prototype.saveWorkspace=function(e){if(!(e instanceof t.Workspace))throw new TypeError("expected instance of Workspace");var n={_id:e._id||e.id,_rev:e._rev,type:"workspace",workspace:this.marshallWorkspace(e)};return this.db.put(n).then(function(t){if(!t.ok)throw new Error("unable to save workspace");return e._id=t.id,e._rev=t.rev,e})},e.prototype.getWorkspace=function(t){if(!t)return this.$q.reject(new Error("no id provided"));var e=this;return this.workspaces.fetch(t,function(){return e.db.get(t).then(function(t){return e.unmarshallWorkspace(t.workspace).then(function(e){return e._id=t._id,e._rev=t._rev,e})})})},e.prototype.removeWorkspace=function(t){return this.db.remove(t)},e.prototype.createPanel=function(e,n,o,i){var r=t.UUID.uuid4(),a=this,l=new t.Panel(r,e,n,o,i,function(t){a.savePanel(t)});return this.savePanel(l)},e.prototype.savePanel=function(e){if(!(e instanceof t.Panel))throw new TypeError("expected instance of Panel");var n={_id:e._id||e.id,_rev:e._rev,type:"panel",panel:this.marshallPanel(e)};return this.db.put(n).then(function(t){if(!t.ok)throw new Error("unable to save panel");return e._id=t.id,e._rev=t.rev,e})},e.prototype.getPanel=function(t,e){if(!t)return this.$q.reject(new Error("no id provided"));var n=this;return this.panels.fetch(t,function(){return n.db.get(t).then(function(t){return n.unmarshallPanel(t.panel,e).then(function(e){return e._id=t._id,e._rev=t._rev,e})})})},e.prototype.removePanel=function(t,e){return e&&e.removePanel(t),this.db.remove(t)},e}t.$inject=["vwise"],angular.module("vwise").provider("workspaceRepository",t)}(),function(){"use strict";function t(t){function e(e,n,o,i){function r(){function t(){"expand_less"===r.icon?(o.width=e.vprops.width,o.height=e.vprops.height,e.vprops.width=i.outerWidth()+1,e.vprops.height=i.outerHeight(),r.label="expand",r.icon="expand_more"):(e.vprops.width=o.width,e.vprops.height=o.height,r.label="collapse",r.icon="expand_less")}var o={width:e.vprops.width,height:e.vprops.height},i=n.find(".panel-label"),r={label:"collapse",icon:"expand_less",handler:t};return r}i.addActionButton(r()),e.title=t.getTitle(e.work.titles),e.work.editions.forEach(function(t){t.type="edition",t.workId=e.work.id})}var n={restrict:"E",require:"^^vwisePanel",templateUrl:"app/vwise/components/work-panel/work-panel.html",scope:{work:"=",relationships:"=",vprops:"="},link:e};return n}t.$inject=["worksRepo"],angular.module("vwise").directive("workPanel",t)}(),function(){"use strict";function t(t){function e(e){e.title=t.getTitle(e.volume.titles),e.edition=t.getEdition(e.workId,e.editionId)}var n={restrict:"E",templateUrl:"app/vwise/components/work-panel/volume-panel.html",scope:{volume:"=",workId:"@",editionId:"@"},link:e};return n}t.$inject=["worksRepo"],angular.module("vwise").directive("volumePanel",t)}(),function(){"use strict";function t(t){function e(e){e.title=t.getTitle(e.edition.titles),e.edition.volumes.forEach(function(t){t.type="volume",t.workId=e.workId,t.editionId=e.edition.id})}var n={restrict:"E",templateUrl:"app/vwise/components/work-panel/edition-panel.html",scope:{edition:"=",workId:"@"},link:e};return n}t.$inject=["worksRepo"],angular.module("vwise").directive("editionPanel",t)}(),function(){"use strict";function t(t){function n(n,o,i,r){function a(){function t(){"expand_less"===r.icon?(e.width=n.vprops.width,e.height=n.vprops.height,n.vprops.width=i.outerWidth()+10,n.vprops.height=i.outerHeight(),r.label="expand",r.icon="expand_more"):(n.vprops.width=e.width,n.vprops.height=e.height,r.label="collapse",r.icon="expand_less")}var e={width:n.vprops.width,height:n.vprops.height},i=o.find(".panel-label"),r={label:"collapse",icon:"expand_less",handler:t};return r}r.addActionButton(a());var l=n.person.name;n.name=l.label||t.at(l,e).map(function(t){return t.trim()}).filter(t.identity).join(" ")}function o(e,n,o,i,r){function a(){var t=e.person.id,n=l(t);n.then(function(t){c.works=t});var o=n.then(function(t){return d(t)});o.then(function(t){c.relatedPeople=t})}function l(t){var e=o.searchByAuthor(t);return e.$promise.then(function(){return e.items.forEach(function(t){t.type="work"}),e.items})}function d(e){var o=e.map(function(t){return s(t.id)}),r=n.all(o).then(function(e){return t.chain(e).flatten().groupBy(function(t){return t.type.identifier+"-"+(t.reverse?"rev":"fwd")}).map(function(e){var n=t.clone(e[0]);return n.relationships=t.flatMap(e,"relationships"),n}).value()}),a=r.then(function(e){var o=e.map(function(e){var o=t.chain(e.relationships).flatMap("entities").map("entity").map(function(e){return e.$promise.then(function(e){var n=t.map(e.authors,"authorId");return n})}).value(),r=n.all(o).then(function(e){return t.chain(e).flatten().filter().uniq().value()});return e.relationships=r.then(function(t){var e=t.map(function(t){var e=i.get(t);return e.$promise.then(function(){e.type="person"}),e.$promise});return n.all(e)}),n.all(e)});return n.all(o)});return a}function s(t){var e="works/"+t,n=r.search(e),i=n.$promise.then(function(t){var n=r.normalizeRelationships(t,e,o);return n.$promise});return i}var c=this;c.works=[],a()}o.$inject=["$scope","$q","worksRepo","peopleRepo","relationshipsRepo"];var i={restrict:"E",require:"^^vwisePanel",templateUrl:"app/vwise/components/person-panel/person-panel.html",scope:{person:"=",vprops:"="},link:n,controller:o,controllerAs:"panel"};return i}t.$inject=["_"],angular.module("vwise").directive("personPanel",t);var e=["title","givenName","middleName","familyName","suffix"]}(),function(){"use strict";function t(t,e,n,o){function i(){e.PanelContentMediator.call(this,"works","Works Content Mediator")}function r(t){var e=n.get(t);return e.$promise}function a(t){var e="works/"+t,i=o.search(e);return i.$promise.then(function(){var t=o.normalizeRelationships(i,e,n);return t.$promise.then(function(){return t.forEach(function(t){t.relationships.forEach(function(t){t.entities.forEach(function(t){switch(t.entity.$promise.then(function(){t.title=n.getTitle(t.entity.titles)}),t.type){case"work":t.id=t.refParams.workId;break;case"edition":t.workId=t.refParams.workId,t.id=t.refParams.editionId;break;case"volume":t.workId=t.refParams.workId,t.editionId=t.refParams.editionId,t.id=t.refParams.volumeId}})})}),t})})}return i.prototype=Object.create(e.PanelContentMediator.prototype),i.prototype.matches=function(t){return t.type&&"work"===t.type&&t.id},i.prototype.initPanelData=function(e){return t.all({id:e.id,work:r(e.id),relationships:a(e.id)})},i.prototype.unmarshall=function(e){return t.all({id:e.id,work:r(e.id),relationships:a(e.id)})},i.prototype.marshall=function(t){var e={type:"work",id:t.id};return e},i.prototype.getTemplate=function(){return'<work-panel work="content.work" relationships="content.relationships" vprops="vprops" flex layout="column"></work-panel>'},new i}t.$inject=["$q","vwise","worksRepo","relationshipsRepo"],angular.module("vwise").factory("worksContentMediator",t)}(),function(){"use strict";function t(t,e){function n(){t.PanelContentMediator.call(this,"volumes","Volumes Content Mediator")}function o(t,n,o){var i=e.getVolume(t,n,o);return i.$promise.then(function(){return i.workId=t,i.editionId=n,i})}return n.prototype=Object.create(t.PanelContentMediator.prototype),n.prototype.matches=function(t){return t.type&&"volume"===t.type&&t.id&&t.workId&&t.editionId},n.prototype.initPanelData=function(t){return o(t.workId,t.editionId,t.id)},n.prototype.unmarshall=function(t){return o(t.workId,t.editionId,t.id)},n.prototype.marshall=function(t){var e={type:"volume",id:t.id,workId:t.workId,editionId:t.editionId};return e},n.prototype.getTemplate=function(){return'<volume-panel volume="content" edition-id="{{content.editionId}}" work-id="{{content.workId}}" flex layout="column"></volume-panel>'},new n}t.$inject=["vwise","worksRepo"],angular.module("vwise").factory("volumesContentMediator",t)}(),function(){"use strict";function t(t,e){function n(){t.PanelContentMediator.call(this,"people","People Content Mediator")}function o(t){var n=e.get(t);return n.$promise}return n.prototype=Object.create(t.PanelContentMediator.prototype),n.prototype.matches=function(t){return t.type&&"person"===t.type&&t.id},n.prototype.initPanelData=function(t){return o(t.id)},n.prototype.unmarshall=function(t){return o(t.id)},n.prototype.marshall=function(t){var e={type:"person",id:t.id};return e},n.prototype.getTemplate=function(){return'<person-panel person="content" vprops="vprops" flex layout="column"></person-panel>'},new n}t.$inject=["vwise","peopleRepo"],angular.module("vwise").factory("peopleContentMediator",t)}(),function(){"use strict";function t(t){function e(){t.PanelContentMediator.call(this,"passthru","Pass-Through Debug Mediator")}return e.prototype=Object.create(t.PanelContentMediator.prototype),e.prototype.matches=function(){return!0},new e}t.$inject=["vwise"],angular.module("vwise").factory("passthruContentMediator",t)}(),function(){"use strict";function t(t){return new t.PanelContentMediatorRegistry}t.$inject=["vwise"],angular.module("vwise").factory("panelContentMediatorRegistry",t)}(),function(){"use strict";function t(t){function e(){t.PanelContentMediator.call(this,"notes","Note Content Mediator")}return e.prototype=Object.create(t.PanelContentMediator.prototype),e.prototype.matches=function(t){return t.hasOwnProperty("note")},e.prototype.getTemplate=function(){return'<div ng-model="content.note" contenteditable flex></div>'},new e}t.$inject=["vwise"],angular.module("vwise").factory("noteContentMediator",t)}(),function(){"use strict";function t(t,e){function n(){t.PanelContentMediator.call(this,"editions","Editions Content Mediator")}function o(t,n){var o=e.getEdition(t,n);return o.$promise.then(function(){return o.workId=t,o})}return n.prototype=Object.create(t.PanelContentMediator.prototype),n.prototype.matches=function(t){return t.type&&"edition"===t.type&&t.id&&t.workId},n.prototype.initPanelData=function(t){return o(t.workId,t.id)},n.prototype.unmarshall=function(t){return o(t.workId,t.id)},n.prototype.marshall=function(t){var e={type:"edition",id:t.id,workId:t.workId};return e},n.prototype.getTemplate=function(){return'<edition-panel edition="content" work-id="{{content.workId}}" flex layout="column"></edition-panel>'},new n}t.$inject=["vwise","worksRepo"],angular.module("vwise").factory("editionsContentMediator",t)}(),function(){"use strict";function t(t){function e(){t.PanelContentMediator.call(this,"ia-reader","Internet Archive Digital Copy mediator")}return e.prototype=Object.create(t.PanelContentMediator.prototype),e.prototype.matches=function(t){return t.type&&"internetarchive"===t.type},e.prototype.getTemplate=function(){return'<ia-reader properties="content.properties" flex></ia-reader>'},new e}t.$inject=["vwise"],angular.module("vwise").factory("internetArchiveContentMediator",t)}(),function(){"use strict";function t(t){function e(){t.PanelContentMediator.call(this,"ht-reader","HathiTrust Digital Copy mediator")}return e.prototype=Object.create(t.PanelContentMediator.prototype),e.prototype.matches=function(t){return t.type&&"hathitrust"===t.type},e.prototype.getTemplate=function(){return'<hathitrust-reader properties="content.properties" flex></hathitrust-reader>'},new e}t.$inject=["vwise"],angular.module("vwise").factory("hathitrustContentMediator",t)}(),function(){"use strict";function t(t){function e(){t.PanelContentMediator.call(this,"gb-reader","Google Books Digital Copy mediator")}return e.prototype=Object.create(t.PanelContentMediator.prototype),e.prototype.matches=function(t){return t.type&&"googlebooks"===t.type},e.prototype.getTemplate=function(){return'<google-book-reader properties="content.properties" flex></google-book-reader>'},new e}t.$inject=["vwise"],angular.module("vwise").factory("googleBooksContentMediator",t)}(),function(){"use strict";function t(t){function i(e,i,r,a){var l=a[1];l.getInfoArea=function(){return i.find(".panel-area-left")},l.getStatusArea=function(){return i.find(".panel-area-bottom")};var d=l.panel;e.vp=d.vprops;var s=e.$new(!0);s.content=d.content,s.vprops=d.vprops,s.$watch("vprops.background",function(t){var e=n(t);d.vprops.foreground=o(e)}),s.$watch("content",function(){d.save()},!0);var c=d.contentMediator.getTemplate(),m=i.find(".content");m.html(c),t(m.contents())(s)}var r={restrict:"E",require:["^^vwiseWorkspace","vwisePanel"],templateUrl:"app/vwise/components/panel/panel.html",replace:!0,scope:{panel:"="},link:i,controller:e,controllerAs:"vm"};return r}function e(t){function e(t){return c.actionButtons.push(t),function(){var e=c.actionButtons.indexOf(t);e>=0&&c.actionButtons.splice(e,1)}}function n(t){return c.propertyButtons.push(t),function(){var e=c.propertyButtons.indexOf(t);e>=0&&c.propertyButtons.splice(e,1)}}function o(){c.panel.remove()}function i(t,e){c.panel.vprops.xPosition=e.position.left,c.panel.vprops.yPosition=Math.max(0,e.position.top)}function r(t,e){var n=Math.max(0,e.position.top);c.panel.setPosition(e.position.left,n),s()}function a(){c.resizing=!0}function l(e,n){var o=n.position.left,i=n.position.top;t.$apply(function(){c.panel.vprops.width=Math.max(0,o),c.panel.vprops.height=Math.max(0,i)})}function d(e,n){c.resizing=!1;var o=n.position.left,i=n.position.top;t.$apply(function(){c.panel.setSize(Math.max(0,o),Math.max(0,i))})}function s(t){c.panel.activate(),t&&t.stopPropagation&&t.stopPropagation()}var c=this;c.resizing=!1,c.actionButtons=[],c.propertyButtons=[],c.panel=t.panel,c.addActionButton=e,c.addPropertyButton=n,c.closePanel=o,c.startResize=a,c.resizePanel=l,c.stopResize=d,c.movePanel=i,c.stopMove=r,c.activatePanel=s}function n(t){var e=t.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(e)return{r:parseInt(e[1],16)/255,g:parseInt(e[2],16)/255,b:parseInt(e[3],16)/255}}function o(t){var e=t.r<=.03928?t.r/12.92:Math.pow((t.r+.055)/1.055,2.4),n=t.g<=.03928?t.g/12.92:Math.pow((t.g+.055)/1.055,2.4),o=t.b<=.03928?t.b/12.92:Math.pow((t.b+.055)/1.055,2.4),i=.2126*e+.7152*n+.0722*o;return i>.215?"rgba(0,0,0,0.87)":"rgba(255,255,255,0.87)"}t.$inject=["$compile"],e.$inject=["$scope"],angular.module("vwise").directive("vwisePanel",t)}(),function(){"use strict";function t(t){function e(e){e.$watch("properties",function(n){e.src=t.trustAsResourceUrl("https://archive.org/stream/"+n.id+"?ui=embed#mode/2up")})}var n={restrict:"E",template:'<iframe ng-src="{{src}}">',replace:!0,link:e,scope:{properties:"="}};return n}t.$inject=["$sce"],angular.module("vwise").directive("iaReader",t)}(),function(){"use strict";function t(t,n){function o(o){o.$watch("properties",function(i){var r={id:i.htid,ui:"embed"};i.seq&&(r.seq=i.seq);var a=n.map(r,function(t,e){return e+"="+t}).join(";"),l=e+"?"+a;o.src=t.trustAsResourceUrl(l)})}var i={restrict:"E",template:'<iframe ng-src="{{src}}">',replace:!0,link:o,scope:{properties:"="}};return i}t.$inject=["$sce","_"];var e="https://babel.hathitrust.org/cgi/pt";angular.module("vwise").directive("hathitrustReader",t)}(),function(){"use strict";function t(t){function e(e,n,o,i){i&&(i.$render=function(){n.html(t.getTrustedHtml(i.$viewValue||""))},n.on("blur keyup change",function(){e.$apply(function(){i.$setViewValue(n.html())})}))}var n={restrict:"A",require:"?ngModel",link:e};return n}t.$inject=["$sce"],angular.module("vwise").directive("contenteditable",t)}(),function(){"use strict";function t(t){function e(e){e.id||t.error('missing required attribute "id"')}function n(t,e){function n(){t.id&&(o.work=e.get(t.id),o.work.$promise.then(function(){o.loaded=!0}))}var o=this;o.loaded=!1,n()}n.$inject=["$scope","worksRepo"];var o={restrict:"E",templateUrl:"app/task/components/work-editor-item/work-editor-item.html",link:e,scope:{id:"=id"},controller:n,controllerAs:"vm"};return o}t.$inject=["$log"],angular.module("sdaAdminWeb").directive("workEditorItem",t)}(),function(){"use strict";function t(){function t(t,e,n){function o(){t.work.editions.forEach(function(t){a.editions.push({model:t,focused:!1})})}function i(){var o=e.createEdition();o.titles=n.cloneDeep(t.work.titles),o.authors=n.cloneDeep(t.work.authors),t.work.editions.push(o),a.editions.push({model:o,focused:!0})}function r(e){a.editions.splice(e,1),t.work.editions.splice(e,1)}var a=this;a.editions=[],a.createEdition=i,a.deleteEdition=r,o()}t.$inject=["$scope","worksRepo","_"];var e={restrict:"E",templateUrl:"app/work/components/work-editor/work-editor.html",scope:{work:"=ngModel"},controller:t,controllerAs:"vm"};return e}angular.module("sdaAdminWeb").directive("workEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/work/components/volume-editor/volume-editor.html",scope:{volume:"=ngModel"}};return t}angular.module("sdaAdminWeb").directive("volumeEditor",t)}(),function(){"use strict";function t(){function t(t,e,n){function o(){t.edition.volumes.forEach(function(t){a.volumes.push({model:t,focused:!1})})}function i(){var o=e.createVolume();o.titles=n.cloneDeep(t.edition.titles),o.authors=n.cloneDeep(t.edition.authors),o.publicationInfo=n.cloneDeep(t.edition.publicationInfo),t.edition.volumes.push(o),a.volumes.push({model:o,focused:!0})}function r(e){a.volumes.splice(e,1),t.edition.volumes.splice(e,1)}var a=this;a.volumes=[],a.createVolume=i,a.deleteVolume=r,o()}t.$inject=["$scope","worksRepo","_"];var e={restrict:"E",templateUrl:"app/work/components/edition-editor/edition-editor.html",scope:{edition:"=ngModel"},controller:t,controllerAs:"vm"};return e}angular.module("sdaAdminWeb").directive("editionEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/person/components/name-editor/name-editor.html",scope:{name:"=ngModel"}};return t}angular.module("sdaAdminWeb").directive("nameEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/person/components/event-editor/event-editor.html",scope:{event:"=ngModel"}};return t}angular.module("sdaAdminWeb").directive("eventEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/admin/editors/articles/thematic-overview.html",scope:{scopeId:"@",scheme:"@"},controller:e,controllerAs:"vm"};return t}function e(t,e,n,o,i,r,a,l){function d(){e.info("Loading article editor",a),v=l.getScopedRepo(t.scopeId),p.overviews=v.get(t.scheme)}function s(t,n){function o(t){var e=v.nodes.link(n,t.reference);return e.$promise}function l(t){i.go("article.edit",{id:t.article.id})}e.info("creating article");var d=n.label,s=a.create("overviews",d),c=a.save(s),m=c.then(o);r.all({article:c,ref:m}).then(l)}function c(t,n){e.info("Removing entry",n)}function m(t,o){function i(t){e.info("Creating category "+t),v.nodes.create(o,t)}e.info(o);var r=n.prompt({title:"Enter Category Label",placeholder:"new category",ok:"Create",cancel:"Cancel",targetEvent:t});n.show(r).then(i)}function u(t,i,r){e.info(i);var a="Delete category '"+i.label+"'",l="<p>This will delete the selected category, "+i.label+", its sub-categories and all associated articles.<em>This action cannot be undone.</em></p><p>Permanently delete this category?</p>",d=n.confirm({title:a,htmlContent:l,ok:"Delete",cancel:"Cancel",targetEvent:t});n.show(d).then(function(){v.nodes.remove(i,!0,r).then(function(){return"category deleted"},function(){return"unable to delete category"}).then(function(t){o.showSimple(t)})})}var p=this,v=null;p.handleAssociateEntry=s,p.handleRemoveEntry=c,p.handleCreateChild=m,p.handleDeleteNode=u,d()}e.$inject=["$scope","$log","$mdDialog","$mdToast","$state","$q","articlesRepo","categorizationService"],angular.module("sdaAdminWeb").directive("treeCategorizationEditor",t)}(),function(){"use strict";function t(t,e,n){function o(){e.info("Loading article editor",t)}o()}t.$inject=["articlesRepo","$log","categorizationService"],angular.module("sdaAdminWeb").controller("ArticleEditorSectionController",t)}(),function(){"use strict";function t(t,n,o,i,r,a,l){function d(){n.info("Loading article editor",a),h.article=a.get(o.id),h.references=f.get(),t.all([h.article.$promise,h.references.$promise]).then(function(){i.$watch("vm.article.body",p),i.$watchCollection("vm.article.footnotes",u)})}function s(){a.save(h.article),f.save(h.references)}function c(){alert("cancel")}function m(t,e){var n=angular.copy(e),o=l.createRefCollection(),i={templateUrl:"app/components/ckeditor-footnotes/footnote-edit-dialog.html",controller:"FootnoteEditDialogController",controllerAs:"vm",clickOutsideToClose:!1,locals:{footnote:n,references:o}},a=r.show(i);a.then(function(){h.article.footnotes[n.id]=n;var t=l.merge(h.references,l.compact(o));angular.merge(h.references,t)})}function u(t){t&&(a.cleanReferences(h.article,h.references),h.references=f.compact(h.references))}function p(t){t&&(a.cleanFootnotes(h.article,h.article.footnotes),u(t))}var v=a.getReferencesEndpoint(o.id),f=l.getRepo(v),h=this;h.save=s,h.cancel=c,h.body="test",h.abstractEditor={config:angular.extend({},e,{removeButtons:["Styles","Format","Subscript","Superscript","Cut","Copy","HorizontalRule","Maximize","Source"].join(",")})},h.editor={config:angular.extend({},e,{removeButtons:["Styles","Subscript","Superscript","Cut","Copy","Source"].join(",")})},h.editFootnote=m,d()}t.$inject=["$q","$log","$stateParams","$scope","$mdBottomSheet","articlesRepo","refsRepoFactory"],angular.module("sdaAdminWeb").controller("ArticleEditorController",t);var e={toolbarGroups:[{name:"styles",groups:["styles"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi","paragraph"]},{name:"colors",groups:["colors"]},{name:"links",groups:["links"]},{name:"insert",groups:["insert"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"forms",groups:["forms"]},{name:"editing",groups:["find","selection","spellchecker","editing"]},{name:"tools",groups:["tools"]},{name:"document",groups:["mode","document","doctools"]},{name:"others",groups:["others"]}],format_tags:"p;h1;h2;h3;h4;h5;h6;pre;address",extraPlugins:"mathjax",mathJaxLib:"//cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-MML-AM_CHTML"}}(),function(){"use strict";angular.module("zotero",["ngAnimate","ngAria","ngMaterial","ngResource"])}(),function(){"use strict";function t(){var t=this;t.item={},t.types=[]}angular.module("zotero").controller("ZoteroTestController",t)}(),function(){"use strict";angular.module("trcCore",["ngResource"])}(),function(){"use strict";function t(){function t(t,n,o){function i(t){return new r(t)}function r(t){function e(e){return l.get({scopeId:t,key:e})}function n(t,e,n,o){}function o(t){}function i(t,e){}function r(t){}function a(e,n,o){var i={scopeId:t,schemeId:e.schemeId,nodeId:e.id},r={label:n,description:o},a=s.save(i,r);return a.$promise.then(function(t){e.childIds.push(t.id),e.children.push(t)}),a}function m(e,n,o){var i=d["delete"]({scopeId:t,schemeId:e.schemeId,nodeId:e.id,remove_refs:!!n});return o&&i.$promise.then(function(){var t=o.children.indexOf(e);t>=0&&o.children.splice(t,1)}),i.$promise}function u(){}function p(){}function v(e,n){var o={scopeId:t,schemeId:e.schemeId,nodeId:e.id},i=c.update(o,n);return i.$promise.then(function(t){e.entryRef=t}),i}function f(){var e={scopeId:t,schemeId:node.schemeId,nodeId:node.id},n=c["delete"](e);return n.$promise.then(function(){node.entryRef=null}),n}this.get=e,this.create=n,this.remove=o,this.nodes={get:i,getChildren:r,create:a,move:u,remove:m,update:p,link:v,unlink:f}}var a={getScopedRepo:i},l=n(e.url+"/:scopeId/:key",{key:"@key"}),d=n(e.url+"/:scopeId/:schemeId/nodes/:nodeId",{schemeId:"@schemeId",nodeId:"@nodeId"}),s=n(e.url+"/:scopeId/:schemeId/nodes/:nodeId/children",{schemeId:"@schemeId",nodeId:"@nodeId"}),c=n(e.url+"/:scopeId/:schemeId/nodes/:nodeId/entryRef",{schemeId:"@schemeId",nodeId:"@nodeId"},{update:{method:"PUT"}});return a}t.$inject=["$q","$resource","$http"];var e={};return e.url="/api/categorizations",e.$get=t,e}angular.module("trcCore").provider("categorizationService",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(i.summary)}function o(){t.cancel()}var i=this;i.summary=e,i.close=n,i.cancel=o}t.$inject=["$mdDialog","summary"],angular.module("sdaAdminWeb").controller("SummaryEditDialogController",t)}(),function(){"use strict";function t(){function t(t){t.config={toolbarGroups:[{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi","paragraph"]},{name:"links",groups:["links"]},{name:"editing",groups:["find","selection","spellchecker","editing"]}],removeButtons:"Subscript,Superscript,About,Cut,Copy,Maximize,Styles"}}var e={restrict:"E",templateUrl:"app/components/summary-editor/summary-editor.html",scope:{summary:"=ngModel"},link:t};return e}angular.module("sdaAdminWeb").directive("summaryEditor",t)}(),function(){"use strict";function t(){return e}function e(t){return t?String(t).replace(/<[^>]+>/gm,""):""}angular.module("sdaAdminWeb").filter("stripTags",t)}(),function(){"use strict";function t(t){function e(){}function n(e){t(e).toggle()}var o=this;o.toggleSidenav=n,e()}t.$inject=["$mdSidenav"],angular.module("sdaAdminWeb").component("navbar",{templateUrl:"app/components/navbar/navbar.html",bindings:{title:"@",sidenavId:"@?"},controller:t})}(),function(){"use strict";function t(t){function n(n){return t(n,e)}return n}t.$inject=["moment"];var e=["YYYY","MMMM-YYYY","MMM-YYYY","MM-YYYY","M-YYYY","YYYY-MMMM","YYYY-MMM","YYYY-MM","YYYY-M","MMMM-DD-YYYY","MMM-DD-YYYY","MM-DD-YYYY","M-DD-YYYY","MMMM-D-YYYY","MMM-D-YYYY","MM-D-YYYY","M-D-YYYY","DD-MMMM-YYYY","DD-MMM-YYYY","DD-MM-YYYY","DD-M-YYYY","D-MMMM-YYYY","D-MMM-YYYY","D-MM-YYYY","D-M-YYYY","YYYY-MM-DD","YYYY-M-D"];angular.module("sdaAdminWeb").factory("guessDate",t)}(),function(){"use strict";function t(t){function e(e){e.calendarAutoSet=!1,e.$watch("date.description",function(n){!n||e.date.calendar&&!e.calendarAutoSet||(e.date.calendar=t(n).format("YYYY-MM-DD"),e.calendarAutoSet=!0)})}var n={restrict:"E",templateUrl:"app/components/date-editor/date-editor.html",scope:{date:"=ngModel"},link:e};return n}t.$inject=["guessDate"],angular.module("sdaAdminWeb").directive("dateEditor",t)}(),function(){"use strict";function t(){function t(t){function e(){var e=o.indexOf(t);e>=0&&o.splice(e,1)}return o.push(t),t(n.value),e}function e(t){n.value!==t&&(n.value=t,o.forEach(function(e){e(t)}))}var n=this,o=[];n.watch=t,n.set=e,n.value=null}angular.module("sdaAdminWeb").controller("DataContainerController",t)}(),function(){"use strict";function t(t,e,n){function o(){t.hide()}function i(){t.cancel()}var r=this;r.footnote=e,r.references=n,r.done=o,r.cancel=i}t.$inject=["$mdBottomSheet","footnote","references"],angular.module("sdaAdminWeb").controller("FootnoteEditDialogController",t)}(),
function(){"use strict";function t(t,e,n,o){function i(t,i,r,a){function l(t){function i(){t.fire("afterCommandExec",{name:v,command:r})}var r=this,a=n.createFootnote();a.backlinkId=d+a.id;var l=m?o.createRefCollection():null,s={templateUrl:"app/components/ckeditor-footnotes/footnote-edit-dialog.html",controller:"FootnoteEditDialogController",controllerAs:"vm",clickOutsideToClose:!1,locals:{footnote:a,references:l}},u=e.show(s);u.then(function(){if(c.value[a.id]=a,l&&m){var e=o.merge(m.value,o.compact(l));angular.merge(m.value,e)}t.insertHtml('<sup contenteditable="false" class="footnote" id="'+a.backlinkId+'" data-footnote="'+a.id+'">#</a>'),i()},function(){i()})}var d=r.ckeditorFootnotesAnchorIdPrefix||"fn_anchor_",s=a[0],c=a[1],m=a[2],u=s.instance,p=r.ckeditorFootnotes;c.set(t.$eval(p)),t.$watch(p,function(t){c.value!==t&&c.set(t)});var v="insertFootnote";u.addCommand(v,{async:!0,allowedContent:"sup[id,data-footnote,contenteditable](footnote)",requiredContent:"sup[id,data-footnote,contenteditable](footnote)",exec:l}),u.ui.addButton("Footnote",{label:"Insert Footnote",command:v,toolbar:"insert"})}var r={restrict:"A",require:["ckeditor","ckeditorFootnotes","?ckeditorBibliography"],link:i,controller:"DataContainerController"};return r}t.$inject=["$document","$mdBottomSheet","articlesRepo","refsRepoFactory"],angular.module("sdaAdminWeb").directive("ckeditorFootnotes",t)}(),function(){"use strict";function t(t,e,n,o,i){function r(t,e,r,a){function l(t){function e(){t.fire("afterCommandExec",{name:u,command:r})}var r=this,a=n.createRefCollection(),l=n.createCitation();a.citations[l.id]=l,i.show(a).then(function(){var i=n.merge(s.value,n.compact(a));angular.merge(s.value,i),o.render("modern-language-association",a).then(function(n){var o=n.citations[l.id];t.insertHtml('<cite id="'+l.id+'" contenteditable="false">'+o+"</cite>"),e()})},function(){e()})}var d=a[0],s=a[1],c=d.instance,m=r.ckeditorBibliography;s.set(t.$eval(m)),t.$watch(m,function(t){s.value!==t&&s.set(t)});var u="insertCitation";c.addCommand(u,{async:!0,allowedContent:"cite[id,contenteditable]",requiredContent:"cite[id,contenteditable]",exec:l}),c.ui.addButton("Citation",{label:"Insert Citation",command:u,toolbar:"insert"})}var a={restrict:"A",require:["ckeditor","ckeditorBibliography"],link:r,controller:"DataContainerController"};return a}t.$inject=["$mdDialog","$document","refsRepoFactory","refsRenderer","citationEditDialog"],angular.module("sdaAdminWeb").directive("ckeditorBibliography",t)}(),function(){"use strict";function t(t,r,a,l,d,s,c,m){function u(){var t=d.getUserAccount(n,o),e=r.when(t.getGroup(i));if(C.groupLibraryP=e.then(function(e){return r.when(t.getLibrary(e))}),!C.citation)throw new Error("no citation provided");C.references.citations[C.citation.id]?C.references.citations[C.citation.id]!==C.citation&&(a.warn("provided citation does not match citation in reference collection. Overriding..."),C.references.citations[C.citation.id]=C.citation):(a.warn("Citation is not a member of the provided reference collection. Adding to collection..."),C.references.citations[C.citation.id]=C.citation)}function p(t){return C.groupLibraryP.then(function(e){var n=r.when(e.searchItems(t));return n.then(function(t){return r.all(t.map(v).map(h))})})}function v(t){var e="zotero/"+t.library.id+"/"+t.id,n=c.createBiblioItem(e);return n.type=t.type,n.creators=t.properties.creators.map(f),n.meta=angular.extend(s.pick(t.meta,["creatorSummary","parsedDate"]),s.pick(t.properties,["key","dateAdded","dateModified"])),n.fields=s.omit(t.properties,["creators","itemType","key","dateAdded","dateModified","version","collections","tags","relations"]),n}function f(t){return{role:t.creatorType,firstName:t.firstName,lastName:t.lastName,name:t.name}}function h(t){var e=m.renderBiblioItem("modern-language-association",t);return e.then(function(e){return{id:t.id,label:e,item:t}})}function g(t){C.citation.items.indexOf(t)<0&&C.citation.items.push(t);var e=C.references.bibliography[t.id];k(t,e).then(function(e){t.label=e}),w()}function b(t){t?(C.activeCitationItem.id=t.id,C.references.bibliography[t.id]=t.item):C.activeCitationItem.id=null}function y(t){var e=C.references.bibliography[t.id];return h(e).then(function(e){C.activeCitationItem=t,C.selectedBiblioItem=e,C.searchText=E(C.selectedBiblioItem.label)})}function w(){C.activeCitationItem={},C.searchText="",C.selectedBiblioItem=null}function k(t,e){var n=c.createCitation();n.items.push(t);var o=c.createRefCollection();o.citations[n.id]=n,o.bibliography[t.id]=e;var i=m.render("modern-language-association",o);return i.then(function(t){return t.citations[n.id]})}function $(){C.zoteroItem={}}function x(){C.zoteroItem=null}function I(t,e){var n=C.groupLibraryP.then(function(t){return r.when(t.saveItem(e))}),o=n.then(v),i=o.then(h);i.then(function(t){C.selectedBiblioItem=t,b(t),C.searchText=E(t.label),C.zoteroItem=null})}var C=this;C.selectedBiblioItem=null,C.searchText="",C.locatorTypes=e,C.activeCitationItem={},C.groupLibraryP=null,C.zoteroItem=null,C.search=p,C.addCitationItem=g,C.selectBiblioItem=b,C.edit=y,C.createZoteroItem=$,C.cancelZoteroItem=x,C.saveZoteroItem=I;var E=t("stripTags");u()}t.$inject=["$filter","$q","$log","$mdDialog","zotero","_","refsRepoFactory","refsRenderer"];var e=["book","chapter","column","figure","folio","issue","line","note","opus","page","paragraph","part","section","sub verbo","verse","volume"],n="2536190",o="3A4q05BNg0h0bHKJkpoCi1Oa",i="381134";angular.module("sdaAdminWeb").component("citationEditor",{templateUrl:"app/components/citation-edit-dialog/citation-editor.html",controller:t,bindings:{references:"=",citation:"="}})}(),function(){"use strict";function t(t,e,n){function o(o,i,r){if(i)angular.isString(i)&&(i=o.citations[i]);else{var a=e.values(o.citations);0===a.length?(i=n.createCitation(),o.citations[i.id]=i):i=a[0]}if(!i)throw new Error("Unable to find a suitable citation. Please pass one explicitly or check that the reference collection is not malformed");var l={targetEvent:r,templateUrl:"app/components/citation-edit-dialog/citation-edit-dialog.html",controller:"CitationEditDialogController",controllerAs:"vm",clickOutsideToClose:!1,locals:{references:o,citation:i}};return t.show(l).then(function(){return o})}return{show:o}}t.$inject=["$mdDialog","_","refsRepoFactory"],angular.module("sdaAdminWeb").factory("citationEditDialog",t)}(),function(){"use strict";function t(t,e,n){function o(){t.hide()}function i(){t.cancel()}var r=this;r.references=e,r.citation=n,r.done=o,r.cancel=i}t.$inject=["$mdDialog","references","citation"],angular.module("sdaAdminWeb").controller("CitationEditDialogController",t)}(),function(){"use strict";function t(t){function e(e,n){function o(o){o&&t.render("modern-language-association",e.collection).then(function(t){n.html(t.bibliography.html)})}e.$watch("collection",o,!0)}var n={restrict:"E",scope:{collection:"="},link:e};return n}t.$inject=["refsRenderer"],angular.module("sdaAdminWeb").directive("bibliography",t)}(),function(){"use strict";function t(t){function e(){t.getItemTypes().then(function(t){o.types=o.typeFilter&&o.typeFilter.length>0?t.filter(function(t){return o.typeFilter.indexOf(t.id)>=0}):t}),o.item.creators||(o.item.creators=[{}]),0===o.item.creators.length&&o.item.creators.push({})}function n(t){return t?(o.item.itemType=t.id,t.getFields().then(function(t){o.fields=t}),void t.getCreatorRoles().then(function(t){o.roles=t})):(o.item.itemType=null,o.fields=[],void(o.roles=[]))}var o=this;o.itemTypeSearchText="",o.itemType=null,o.types=[],o.fields=[],o.roles=[],o.selectType=n,e()}t.$inject=["zotero"],angular.module("zotero").component("zoteroEditor",{templateUrl:"app/zotero/editor.html",controller:t,bindings:{item:"=",typeFilter:"<types"}})}(),function(){"use strict";function t(){}angular.module("zotero").component("zoteroCreatorField",{templateUrl:"app/zotero/creator-field.html",controller:t,bindings:{creator:"=",roles:"<"}})}(),function(){"use strict";function t(){return new zotero(zotero.getDefaultBaseUrl(),angular.toJson)}angular.module("zotero").factory("zotero",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d,s){function c(){var t=e.workId;R.work=n.get(t),R.work.$promise.then(function(){R.bcTitle=n.getTitle(R.work.titles,["short","canonical","bibliographic"]),R.title=n.getTitle(R.work.titles,["canonical","bibliographic","short"])});var o=u(),r=n.getReferencesEndpoint(t);E=i.getRepo(r),R.references=E.get(),l.all([R.work.$promise,o,R.references.$promise]).then(function(){R.loading=!1})}function m(){var t=e.workId;return"works/"+t}function u(){R.relationships=[];var t=m(),e=o.search(t);return e.$promise.then(function(){R.relationships=o.normalizeRelationships(e,t,n)})}function p(t){var e={targetEvent:t,templateUrl:"app/work/work-edit-dialog.html",locals:{work:angular.copy(R.work)},controller:"WorkEditDialogController",controllerAs:"vm"},o=r.show(e);o.then(function(t){angular.extend(R.work,t),n.saveWork(R.work).then(C)})}function v(t){var e={targetEvent:t,templateUrl:"app/components/summary-edit-dialog/summary-edit-dialog.html",locals:{summary:angular.copy(R.work.summary)},controller:"SummaryEditDialogController",controllerAs:"vm"},o=r.show(e);o.then(function(t){R.work.summary=t,n.saveWork(R.work).then(C)})}function f(t){s.show(R.references,null,t).then(function(){E.save(R.references).then(C)})}function h(e){var o=r.prompt().targetEvent(e).title("Create Edition").textContent("Please provide a name for the new edition.").placeholder("edition name").ok("Create").cancel("Cancel"),i=r.show(o),a=i.then(function(t){var e=n.createEdition();return e.editionName=t,e.titles=angular.copy(R.work.titles),e.authors=angular.copy(R.work.authors),R.work.editions.push(e),n.saveEdition(R.work.id,e)});a.then(C),a.then(function(e){t.go("editor.edition",{workId:R.work.id,editionId:e.id})})}function g(t,e){var o=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this edition?").ok("Yes").cancel("No");r.show(o).then(function(){var e=R.work.editions.indexOf(t);e>=0&&(R.work.editions.splice(e,1),n.saveWork(R.work).then(C))})}function b(t){var e={};y(e,t).then(function(){R.work.copies.push(e)})}function y(t,e){var o={targetEvent:e,templateUrl:"app/work/copy-edit-dialog.html",locals:{copy:angular.copy(t)},controller:"CopyEditDialogController",controllerAs:"vm"},i=r.show(o);return i.then(function(e){angular.extend(t,e),n.saveWork(R.work).then(C)}),i}function w(t,e){var o=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this copy?").ok("Yes").cancel("No");r.show(o).then(function(){var e=R.work.copies.indexOf(t);e>=0&&(R.work.copies.splice(e,1),n.saveWork(R.work).then(C))})}function k(e){var n=e.entities[0];t.go("editor."+n.type,n.refParams)}function $(t){var e=o.createRelationship(),n={targetEvent:t,templateUrl:"app/work/relationship-edit-dialog.html",locals:{relationship:angular.copy(e),currentUri:m()},controller:"RelationshipEditDialogController",controllerAs:"vm"},i=r.show(n),a=i.then(function(t){return angular.extend(e,t),o.save(e)});a.then(C),a.then(function(){d(u,1e3)})}function x(t,e){var n=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this relationship?").ok("Yes").cancel("No"),i=r.show(n),a=i.then(function(){return o["delete"](t.id)});a.then(C),a.then(function(){d(u,1e3)})}function I(e,o){function i(){var e=s+" has been deleted.",n=a.simple().textContent(e).position("bottom right");return t.go("editor"),a.show(n)}function l(){var t=a.simple().textContent("Unable to delete "+s).position("bottom right");return a.show(t)}var d=n.getTitle(R.work.titles),s=d?'"'+d.title+(d.subtitle?": "+d.subtitle:"")+'"':"this work",c=r.confirm({targetEvent:e,title:"Confirm Deletion",textContent:"Are you sure you want to delete "+s+"?",ok:"Yes",cancel:"No"}),m=r.show(c);return m.then(function(){return n["delete"](o).then(i,l)})}function C(){var t=a.simple().textContent("Saved").position("bottom right");return a.show(t)}var E=null,R=this;R.loading=!0,R.work=null,R.title=null,R.relationships=null,R.editBibInfo=p,R.editSummary=v,R.editBibliography=f,R.addEdition=h,R.deleteEdition=g,R.addCopy=b,R.editCopy=y,R.deleteCopy=w,R.openRelationship=k,R.addRelationship=$,R.deleteRelationship=x,R.deleteWork=I,c()}t.$inject=["$state","$stateParams","worksRepo","relationshipsRepo","refsRepoFactory","$mdDialog","$mdToast","$q","$timeout","citationEditDialog"],angular.module("sdaAdminWeb").controller("ShowWorkController",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(d.work)}function o(){t.cancel()}function i(t){var e={};d.work[t].push(e)}function r(t,e){var n=d.work[t].indexOf(e);n>=0&&d.work[t].splice(n,1)}function a(){var t={};d.work.titles.push(t)}function l(t){var e=d.work.titles.indexOf(t);e>=0&&d.work.titles.splice(e,1)}var d=this;d.work=e,d.close=n,d.cancel=o,d.addAuthor=i,d.deleteAuthor=r,d.addTitle=a,d.deleteTitle=l}t.$inject=["$mdDialog","work"],angular.module("sdaAdminWeb").controller("WorkEditDialogController",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d){function s(){var t=e.workId,o=e.editionId,i=e.volumeId;$.work=n.getWork(t),$.edition=n.getEdition(t,o),$.volume=n.getVolume(t,o,i),$.work.$promise.then(function(){$.workTitle=n.getTitle($.work.titles,["short","canonical","bibliographic"])}),$.volume.$promise.then(function(){$.title=n.getTitle($.volume.titles,["canonical","bibliographic","short"])});var r=m();l.all([$.work.$promise,$.edition.$promise,$.volume.$promise,r]).then(function(){$.loading=!1})}function c(){var t=e.workId,n=e.editionId,o=e.volumeId;return"works/"+t+"/editions/"+n+"/volumes/"+o}function m(){$.relationships=[];var t=c(),e=o.search(t);e.$promise.then(function(){$.relationships=o.normalizeRelationships(e,t,n)})}function u(t){var e={targetEvent:t,templateUrl:"app/work/volume-edit-dialog.html",locals:{volume:angular.copy($.volume)},controller:"VolumeEditDialogController",controllerAs:"vm"},o=r.show(e);return o.then(function(t){angular.extend($.volume,t),n.saveVolume($.work.id,$.edition.id,$.volume).then(k)}),o}function p(t){var e={targetEvent:t,templateUrl:"app/components/summary-edit-dialog/summary-edit-dialog.html",locals:{summary:angular.copy($.volume.summary)},controller:"SummaryEditDialogController",controllerAs:"vm"},o=r.show(e);o.then(function(t){$.volume.summary=t,n.saveVolume($.work.id,$.edition.id,$.volume).then(k)})}function v(t){var e={};f(e,t).then(function(){$.volume.copies.push(e)})}function f(t,e){var o={targetEvent:e,templateUrl:"app/work/copy-edit-dialog.html",locals:{copy:angular.copy(t)},controller:"CopyEditDialogController",controllerAs:"vm"},i=r.show(o);return i.then(function(e){angular.extend(t,e),n.saveVolume($.work.id,$.edition.id,$.volume).then(k)}),i}function h(t,e){var o=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this copy?").ok("Yes").cancel("No");r.show(o).then(function(){var e=$.volume.copies.indexOf(t);e>=0&&($.volume.copies.splice(e,1),n.saveVolume($.work.id,$.edition.id,$.volume).then(k))})}function g(t){var e=angular.copy(t);e.id=null;var o=n.getEdition($.work.id,$.edition.id);o.$promise.then(function(){return o.copies.push(e),n.saveEdition($.work.id,o)}).then(k)}function b(e){var n=e.entities[0];t.go("editor."+n.type,n.refParams)}function y(t){var e=o.createRelationship(),n={targetEvent:t,templateUrl:"app/work/relationship-edit-dialog.html",locals:{relationship:angular.copy(e),currentUri:c()},controller:"RelationshipEditDialogController",controllerAs:"vm"},i=r.show(n),a=i.then(function(t){return angular.extend(e,t),o.save(e)});a.then(k),a.then(function(){d(m,1e3)})}function w(t,e){var n=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this relationship?").ok("Yes").cancel("No"),i=r.show(n),a=i.then(function(){return o["delete"](t.id)});a.then(k),a.then(function(){d(m,1e3)})}function k(){var t=a.simple().textContent("Saved").position("bottom right");return a.show(t)}var $=this;$.loading=!0,$.work=null,$.workTitle=null,$.edition=null,$.volume=null,$.title=null,$.editBibInfo=u,$.editSummary=p,$.addCopy=v,$.editCopy=f,$.deleteCopy=h,$.copyToEdition=g,$.openRelationship=b,$.addRelationship=y,$.deleteRelationship=w,s()}t.$inject=["$state","$stateParams","worksRepo","relationshipsRepo","_","$mdDialog","$mdToast","$q","$timeout"],angular.module("sdaAdminWeb").controller("ShowVolumeController",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(d.volume)}function o(){t.cancel()}function i(t){var e={};d.volume[t].push(e)}function r(t,e){var n=d.volume[t].indexOf(e);n>=0&&d.volume[t].splice(n,1)}function a(){var t={};d.volume.titles.push(t)}function l(t){var e=d.volume.titles.indexOf(t);e>=0&&d.volume.titles.splice(e,1)}var d=this;d.volume=e,d.close=n,d.cancel=o,d.addAuthor=i,d.deleteAuthor=r,d.addTitle=a,d.deleteTitle=l}t.$inject=["$mdDialog","volume"],angular.module("sdaAdminWeb").controller("VolumeEditDialogController",t)}(),function(){"use strict";function t(t,e,n,o,i){function r(){p.types=a(),p.target=n.createAnchor(),p.relationship.targetEntities=[p.target];var t=n.createAnchor();t.entryUris=[o],p.relationship.relatedEntities=[t],p.relationship.descriptionMimeType="text/html"}function a(){var t=n.getTypes(),e=[];return Object.defineProperty(e,"$promise",{value:t.$promise}),t.$promise.then(function(){angular.forEach(t,function(t){e.push({id:t.identifier,label:t.title,reverse:!1}),t.isDirected&&e.push({id:t.identifier,label:t.reverseTitle,reverse:!0})})}),e}function l(t){var n=e.search(t);return n.$promise.then(function(){return n.items})}function d(t){if(p.relationship.typeId=t.id,p.isReverse&&!t.reverse||!p.isReverse&&t.reverse){var e=p.relationship.relatedEntities;p.relationship.relatedEntities=p.relationship.targetEntities,p.relationship.targetEntities=e}p.isReverse=t.reverse}function s(t){if(p.targets=[],t){var n=e.getWork(t.id);n.$promise.then(function(){var t="works/"+n.id,o=e.getTitle(n.titles,["short","canonical","bibliographic"]);p.targets.push({uri:t,label:o.title+(o.subtitle?": "+o.subtitle:"")}),n.editions.forEach(function(n){var o=t+"/editions/"+n.id,i=e.getTitle(n.titles,["short","canonical","bibliographic"]);p.targets.push({uri:o,label:i.title+(i.subtitle?": "+i.subtitle:"")+". "+n.editionName}),n.volumes.forEach(function(t){var i=o+"/volumes/"+t.id,r=e.getTitle(t.titles,["short","canonical","bibliographic"]);p.targets.push({uri:i,label:r.title+(r.subtitle?": "+r.subtitle:"")+". "+n.editionName+". Volume "+t.volumeNumber})})}),p.selectedTarget=p.targets[0],c(p.selectedTarget)})}}function c(t){p.target.entryUris=t&&t.uri?[t.uri]:[]}function m(){t.hide(p.relationship)}function u(){t.cancel()}var p=this;p.relationship=i,p.types=[],p.selectedType=null,p.targets=[],p.selectedTarget=null,p.searchText="",p.isReverse=!1,p.getResults=l,p.selectWork=s,p.setType=d,p.setTarget=c,p.close=m,p.cancel=u,r()}t.$inject=["$mdDialog","worksRepo","relationshipsRepo","currentUri","relationship"],angular.module("sdaAdminWeb").controller("RelationshipEditDialogController",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d){function s(){var t=e.workId,o=e.editionId;I.work=n.getWork(t),I.edition=n.getEdition(t,o),I.work.$promise.then(function(){I.workTitle=n.getTitle(I.work.titles,["short","canonical","bibliographic"])}),I.edition.$promise.then(function(){I.title=n.getTitle(I.edition.titles,["canonical","bibliographic","short"])});var i=m();l.all([I.work.$promise,I.edition.$promise,i]).then(function(){I.loading=!1})}function c(){var t=e.workId,n=e.editionId;return"works/"+t+"/editions/"+n}function m(){I.relationships=[];var t=c(),e=o.search(t);e.$promise.then(function(){I.relationships=o.normalizeRelationships(e,t,n)})}function u(t){var e={targetEvent:t,templateUrl:"app/work/edition-edit-dialog.html",locals:{edition:angular.copy(I.edition)},controller:"EditionEditDialogController",controllerAs:"vm"},o=r.show(e);return o.then(function(t){angular.extend(I.edition,t),n.saveEdition(I.work.id,I.edition).then(x)}),o}function p(t){var e={targetEvent:t,templateUrl:"app/components/summary-edit-dialog/summary-edit-dialog.html",locals:{summary:angular.copy(I.edition.summary)},controller:"SummaryEditDialogController",controllerAs:"vm"},o=r.show(e);o.then(function(t){I.edition.summary=t,n.saveEdition(I.work.id,I.edition).then(x)})}function v(e){var o=r.prompt().targetEvent(e).title("Create Volume").textContent("Please provide a number for the new volume.").placeholder("volume number").ok("Create").cancel("Cancel"),i=r.show(o),a=i.then(function(t){var e=n.createVolume();return e.volumeNumber=t,e.titles=angular.copy(I.edition.titles),e.authors=angular.copy(I.edition.authors),e.publicationInfo=angular.copy(I.edition.publicationInfo),I.edition.volumes.push(e),n.saveVolume(I.work.id,I.edition.id,e)});a.then(x),a.then(function(e){t.go("editor.volume",{workId:I.work.id,editionId:I.edition.id,volumeId:e.id})})}function f(t,e){var o=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this volume?").ok("Yes").cancel("No");r.show(o).then(function(){var e=I.edition.volumes.indexOf(t);e>=0&&(I.edition.volumes.splice(e,1),n.saveEdition(I.work.id,I.edition).then(x))})}function h(t){var e={};g(e,t).then(function(){I.edition.copies.push(e)})}function g(t,e){var o={targetEvent:e,templateUrl:"app/work/copy-edit-dialog.html",locals:{copy:angular.copy(t)},controller:"CopyEditDialogController",controllerAs:"vm"},i=r.show(o);return i.then(function(e){angular.extend(t,e),n.saveEdition(I.work.id,I.edition).then(x)}),i}function b(t,e){var o=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this copy?").ok("Yes").cancel("No");r.show(o).then(function(){var e=I.edition.copies.indexOf(t);e>=0&&(I.edition.copies.splice(e,1),n.saveEdition(I.work.id,I.edition).then(x))})}function y(t){var e=angular.copy(t);e.id=null;var o=n.getWork(I.work.id);o.$promise.then(function(){return o.copies.push(e),n.saveWork(o)}).then(x)}function w(e){var n=e.entities[0];t.go("editor."+n.type,n.refParams)}function k(t){var e=o.createRelationship(),n={targetEvent:t,templateUrl:"app/work/relationship-edit-dialog.html",locals:{relationship:angular.copy(e),currentUri:c()},controller:"RelationshipEditDialogController",controllerAs:"vm"},i=r.show(n),a=i.then(function(t){return angular.extend(e,t),o.save(e)});a.then(x),a.then(function(){d(m,1e3)})}function $(t,e){var n=r.confirm().targetEvent(e).title("Confirm Deletion").textContent("Are you sure you want to delete this relationship?").ok("Yes").cancel("No"),i=r.show(n),a=i.then(function(){return o["delete"](t.id)});a.then(x),a.then(function(){d(m,1e3)})}function x(){var t=a.simple().textContent("Saved").position("bottom right");return a.show(t)}var I=this;I.loading=!0,I.work=null,I.workTitle=null,I.edition=null,I.title=null,I.editBibInfo=u,I.editSummary=p,I.addVolume=v,I.deleteVolume=f,I.addCopy=h,I.editCopy=g,I.deleteCopy=b,I.copyToWork=y,I.openRelationship=w,I.addRelationship=k,I.deleteRelationship=$,s()}t.$inject=["$state","$stateParams","worksRepo","relationshipsRepo","_","$mdDialog","$mdToast","$q","$timeout"],angular.module("sdaAdminWeb").controller("ShowEditionController",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(d.edition)}function o(){t.cancel()}function i(t){var e={};d.edition[t].push(e)}function r(t,e){var n=d.edition[t].indexOf(e);n>=0&&d.edition[t].splice(n,1)}function a(){var t={};d.edition.titles.push(t)}function l(t){var e=d.edition.titles.indexOf(t);e>=0&&d.edition.titles.splice(e,1)}var d=this;d.edition=e,d.close=n,d.cancel=o,d.addAuthor=i,d.deleteAuthor=r,d.addTitle=a,d.deleteTitle=l}t.$inject=["$mdDialog","edition"],angular.module("sdaAdminWeb").controller("EditionEditDialogController",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(i.copy)}function o(){t.cancel()}var i=this;i.copy=e,i.close=n,i.cancel=o}t.$inject=["$mdDialog","copy"],angular.module("sdaAdminWeb").controller("CopyEditDialogController",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d,s,c,m,u){function p(){var t=n.workspaceId?c.when(n.workspaceId):e.listWorkspaceIds().then(function(t){return t.length>0?t[0]:null}),o=t.then(function(t){return e.getWorkspace(t)})["catch"](function(){return e.createWorkspace()});o.then(function(t){h.workspace=t}),d.bindTo(i).add({combo:"ctrl+\\",description:"Toggle Sidebar",callback:function(){h.sidebarFocused=!h.sidebarFocused}}).add({combo:"/",description:"Search",callback:function(){h.searchQuery="",h.sidebarFocused?r(function(){angular.element("#searchQuery").focus()}):a("left").toggle()}}).add({combo:"n",description:"Create a new note panel",callback:function(){f(100,100)}})}function v(t){function e(t,e){return function(n){return n.forEach(function(n){n[t]=e}),n}}h.loading=!0,h.peopleResults=m.search(t),h.worksResults=u.search(t),c.all([h.peopleResults.$promise.then(s.property("items")).then(e("type","person")),h.worksResults.$promise.then(s.property("items")).then(e("type","work"))]).then(function(){h.loading=!1},function(){l.showSimple("Unable to load search results")})}function f(e,n){var o={note:""},i={xPosition:e,yPosition:n},r=t.findContentMediators(o,i),a=r.length>0?r[0]:null;h.workspace.createPanel(a,o,i)}var h=this;h.workspace=null,h.activeItems=[],h.searchQuery="",h.sidebarFocused=!0,h.search=s.debounce(v,300),p()}t.$inject=["panelContentMediatorRegistry","workspaceRepository","$stateParams","$log","$scope","$timeout","$mdSidenav","$mdToast","hotkeys","_","$q","peopleRepo","worksRepo"],angular.module("vwise").controller("WorkspaceController",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d,s){t.register(e),t.register(n),t.register(o),t.register(i),t.register(r),t.register(a),t.register(l),t.register(d),t.register(s)}t.$inject=["panelContentMediatorRegistry","peopleContentMediator","worksContentMediator","editionsContentMediator","volumesContentMediator","googleBooksContentMediator","hathitrustContentMediator","internetArchiveContentMediator","noteContentMediator","passthruContentMediator"],angular.module("vwise").run(t)}(),function(){"use strict";angular.module("vwise").constant("vwise",vwise)}(),function(){"use strict";function t(t){t.configure({preventLoad:!0})}t.$inject=["googleBooksApiProvider"],angular.module("vwise").config(t)}(),function(){"use strict";angular.module("trcWorks",["ngResource"])}(),function(){"use strict";function t(){function t(t,n){function o(t){return e.url+"/"+t+"/references"}function i(){return r("")}function r(t){return x.get({q:t,max:50})}function a(t){return x.get({aid:t,max:50})}function l(t){if(angular.isUndefined(t))throw new TypeError("Invalid ID provided to getWork");var e=x.get({workId:t});return e.$promise.then(y),e}function d(t,e){if(angular.isUndefined(t)||angular.isUndefined(e))throw new TypeError("Invalid IDs provided to getEdition");var n=I.get({workId:t,editionId:e});return n.$promise.then(w),n}function s(t,e,n){if(angular.isUndefined(t)||angular.isUndefined(e)||angular.isUndefined(n))throw new TypeError("Invalid IDs provided to getVolume");var o=C.get({workId:t,editionId:e,volumeId:n});return o.$promise.then(k),o}function c(){var t=new x;return y(t),t.titles.push({}),t.authors.push({}),t}function m(){var t=new I;return w(t)}function u(){var t=new C;return k(t)}function p(){switch(arguments.length){case 1:return v.apply(null,arguments);case 2:return f.apply(null,arguments);case 3:return h.apply(null,arguments)}throw new TypeError("Unexpected arguments to worksRepo#save")}function v(t){if(!(t instanceof x))throw new Error("work was not created by this repo");return t.id?t.$update():t.$save()}function f(t,e){if(!t)throw new Error("no work id provided");if(!(e instanceof I))throw new Error("edition was not created by this repo");return e.id?e.$update({workId:t}):e.$save({workId:t})}function h(t,e,n){if(!t)throw new Error("no work id provided");if(!e)throw new Error("no edition id provided");if(!(n instanceof C))throw new Error("volume was not created by this repo");return n.id?n.$update({workId:t,editionId:e}):n.$save({workId:t,editionId:e})}function g(t){angular.isObject(t)&&t.id&&(t=t.id);var e=x["delete"]({workId:t});return e.$promise}function b(t){return t.titles?t.titles.forEach(function(t){t.type=angular.isString(t.type)?t.type.toLowerCase():t.type}):t.titles=[],t.authors?t.authors.forEach(function(t){t.role=angular.isString(t.role)?t.role.toLowerCase():t.role}):t.authors=[],t.copies||(t.copies=[]),t}function y(t){return b(t),t.editions?t.editions.forEach(w):t.editions=[],t}function w(t){return b(t),t.volumes?t.volumes.forEach(k):t.volumes=[],t}function k(t){return b(t),t}function $(t,e){return angular.isUndefined(e)?e=["short","canonical","bibliographic"]:angular.isArray(e)||(e=[e]),e.reduce(function(e,o){return e||n.find(t,{type:o})},null)}var x=t(e.url+"/:workId",{workId:"@id"},{update:{method:"PUT"}}),I=t(e.url+"/:workId/editions/:editionId",{editionId:"@id"},{update:{method:"PUT"}}),C=t(e.url+"/:workId/editions/:editionId/volumes/:volumeId",{volumeId:"@id"},{update:{method:"PUT"}}),E={};return E.getReferencesEndpoint=o,E.getAll=i,E.search=r,E.searchByAuthor=a,E.get=l,E.getWork=l,E.getEdition=d,E.getVolume=s,E.create=c,E.createWork=c,E.createEdition=m,E.createVolume=u,E.save=p,E.saveWork=v,E.saveEdition=f,E.saveVolume=h,E["delete"]=g,E.getTitle=$,E}t.$inject=["$resource","_"];var e={};return e.url="/api/works",e.$get=t,e}angular.module("trcWorks").provider("worksRepo",t)}(),function(){"use strict";angular.module("trcTasks",["ngResource"])}(),function(){"use strict";function t(){function t(t){function n(){return l.query()}function o(t){return l.get({taskId:t})}function i(t){return d.get({taskId:t})}function r(t,e,n){return n=n||{},s.get({taskId:t,stage:e,start:n.start,max:n.max})}function a(t,e,n){if(e.stage!==n.sourceStage)throw new Error("Transition ("+n.sourceStage+" -> "+n.targetStage+") is not valid for item currently in stage "+e.stage);var o=s.save({taskId:t,itemId:e.itemId},{stage:n.targetStage,comments:null});return o.$promise.then(function(t){angular.extend(e,t)}),o}var l=t(e.url+"/:taskId",{taskId:"@id"}),d=t(e.url+"/:taskId/workflow"),s=t(e.url+"/:taskId/items/:itemId",{itemId:"@itemId"}),c={};return c.getTask=o,c.getWorkflow=i,c.all=n,c.getItems=r,c.transition=a,c}t.$inject=["$resource"];var e={};return e.url="/api/tasks",e.$get=t,e}angular.module("trcTasks").provider("tasksRepo",t)}(),function(){"use strict";angular.module("trcReln",["ngResource"])}(),function(){"use strict";function t(){function t(t,o){function i(t){if(t=t||{},!x||t.force){var e=k.query();x={};var n=e.$promise.then(function(){return e.forEach(function(t){x[t.identifier]=t}),x});Object.defineProperty(x,"$promise",{value:n})}return x}function r(t){var e=i();return e.$promise.then(function(e){return e[t]})}function d(){var t=new $;return g(t)}function m(){var t={};return b(t)}function u(){var t={};return y(t)}function p(t){return $.get({id:t})}function v(t){if(!t)throw new Error("no options provided");angular.isString(t)&&(t={uri:t});var e={};return t.uri&&(e.entity=t.uri),t.typeId&&(e.type=t.typeId),t.direction&&(e.direction=t.direction),t.start&&(e.off=t.start),t.max&&(e.max=t.max),$.query(e)}function f(t){if(!(t instanceof $))throw new Error("Relationship was not created by this repo");return t.id?t.$update():t.$save()}function h(t){var e=$["delete"]({id:t});return e.$promise}function g(t){return t.provenance||(t.provenance=m()),t.relatedEntities||(t.relatedEntities=[]),t.targetEntities||(t.targetEntities=[]),t}function b(t){return t.creatorUris||(t.creatorUris=[]),t}function y(t){return t.entryUris||(t.entryUris=[]),t}function w(n,o,i){var d=n.map(function(n){var r=n.targetEntities.some(function(t){return t.entryUris.some(function(t){return t===o})}),l=r?"relatedEntities":"targetEntities",d=s(n[l],c("entryUris")).map(function(t){return e(t,i)}),m={id:n.id,typeId:n.typeId,reverse:r,description:n.description,entities:d},u=d.map(c("$promise"));
return Object.defineProperty(m,"$promise",{value:t.all(u).then(a(m))}),m}),m={};d.forEach(function(t){var e=t.typeId;m.hasOwnProperty(e)||(m[e]={fwd:[],rev:[]}),m[e][t.reverse?"rev":"fwd"].push(t)});var u=[],p=l(m,function(t,e){return r(e).then(function(e){if(e.isDirected)t.fwd.length>0&&u.push({label:e.title,type:e,reverse:!1,relationships:t.fwd}),t.rev.length>0&&u.push({label:e.reverseTitle,type:e,reverse:!0,relationships:t.rev});else{var n=t.fwd.concat(t.rev);n.length>0&&u.push({label:e.title,type:e,relationships:n})}})});return Object.defineProperty(u,"$promise",{value:t.all(p).then(a(u))}),u}var k=o(n.url+"/types/:id",{id:"@identifier"}),$=o(n.url+"/:id",{id:"@id"},{update:{method:"PUT"}}),x=null,I={};return I.getTypes=i,I.getType=r,I.createRelationship=d,I.createProvenance=m,I.createAnchor=u,I.get=p,I.search=v,I.save=f,I["delete"]=h,I.normalizeRelationships=w,I}t.$inject=["$q","$resource"];var n={};return n.url="/api/relationships",n.$get=t,n}function e(t,e){var r=m.exec(t);return r?r[1]&&r[2]&&r[3]?n(r[1],r[2],r[3],e):r[1]&&r[2]?o(r[1],r[2],e):r[1]?i(r[1],e):null:null}function n(t,e,n,o){var i=o.getEdition(t,e),a=o.getVolume(t,e,n),l={type:"volume",refParams:{workId:t,editionId:e,volumeId:n},entity:a},d=a.$promise.then(function(){var t=o.getTitle(a.titles,["short","canonical","bibliographic"]),e=r(t);return i.$promise.then(function(){return e+". "+i.editionName+". Volume "+a.volumeNumber},function(){return e+". [Unknown edition]. Volume "+a.volumeNumber})}),s=d.then(function(t){return l.label=t,l});return Object.defineProperty(l,"$promise",{value:s}),l}function o(t,e,n){var o=n.getEdition(t,e),i={type:"edition",refParams:{workId:t,editionId:e},entity:o},a=o.$promise.then(function(){var t=n.getTitle(o.titles,["short","canonical","bibliographic"]);return i.label=r(t)+". "+o.editionName,i});return Object.defineProperty(i,"$promise",{value:a}),i}function i(t,e){var n=e.getWork(t),o={type:"work",refParams:{workId:t},entity:n},i=n.$promise.then(function(){var t=e.getTitle(n.titles,["short","canonical","bibliographic"]);return o.label=r(t),o});return Object.defineProperty(o,"$promise",{value:i}),o}function r(t){return t?t.title+(t.subtitle?": "+t.subtitle:""):""}function a(t){return function(){return t}}function l(t,e){return Object.keys(t).filter(function(e){return t.hasOwnProperty(e)}).map(function(n){return e(t[n],n)})}function d(t){return t.reduce(function(t,e){return t.concat(e)},[])}function s(t,e){return d(t.map(e))}function c(t){return function(e){return e[t]}}var m=/^works\/([^\/]+)(?:\/editions\/([^\/]+)(?:\/volumes\/([^\/]+))?)?$/i;angular.module("trcReln").provider("relationshipsRepo",t)}(),function(){"use strict";angular.module("trcRefs",["ngResource","uuid4"])}(),function(){"use strict";angular.module("trcRefs").constant("_",_).constant("CSL",CSL)}(),function(){"use strict";function t(){function t(t,e,n){function o(e){function o(){return a.get()}function i(t){var e=d(t),n=a.save({},e);return n.$promise}function r(){var t=a["delete"]();return t.$promise}var a=n(e),l=t.omit(m,["getRepo"]);return l.get=o,l.save=i,l["delete"]=r,l}function i(){return{citations:{},bibliography:{}}}function r(){return{id:e.generate(),items:[]}}function a(t){return{id:t,type:null,meta:{},creators:[],fields:{}}}function l(t,e){var n=i();return angular.extend(n.citations,t.citations,e.citations),angular.extend(n.bibliography,t.bibliography,e.bibliography),n}function d(e){var n=i();return angular.extend(n.citations,e.citations),n.bibliography=t.chain(e.citations).flatMap("items").map("id").uniq().map(function(t){return{id:t,item:e.bibliography[t]}}).filter("item").keyBy("id").mapValues("item").value(),n}function s(e){return t.chain(e.citations).map(function(n){var o=t.map(n.items,"id"),i=t.reject(o,t.propertyOf(e.bibliography));return[n.id,i]}).filter(function(t){return t[1]&&t[1].length}).value()}function c(t){var e=s(t);return 0===e.length}var m={};return m.createRefCollection=i,m.createCitation=r,m.createBiblioItem=a,m.merge=l,m.compact=d,m.validate=s,m.isValid=c,m.getRepo=o,m}t.$inject=["_","uuid4","$resource"];var e={};return e.$get=t,e}angular.module("trcRefs").provider("refsRepoFactory",t)}(),function(){"use strict";function t(t,e,n,o,i){function r(e,n){if(!e||!angular.isString(e))throw new Error("no style provided");if(!n)throw new Error("no reference provided");var r=d.then(function(t){return o.adapt(t,n)}),a=r.then(function(t){return i.load(e,function(e){return t.bibliography[e]})}),s=t.all({cslReference:r,citeproc:a}),c=s.then(function(t){return l(t.citeproc,t.cslReference)});return c}function a(e,n){var r=d.then(function(t){return o.adaptBiblioItem(t,n)}),a=r.then(function(t){return i.load(e,function(){return t})}),s=r.then(function(t){var e={};return e[t.id]=t,e}),c=t.all({cslBibliography:s,citeproc:a}),m=c.then(function(t){return l(t.citeproc,{citations:[],bibliography:t.cslBibliography})});return m.then(function(t){return t.bibliography.html})}function l(t,e){t.updateItems(n.keys(e.bibliography));var o=n.flatMap(e.citations,function(e){var n=angular.copy(e);return t.appendCitationCluster(n,!0)}),i=t.makeBibliography(),r=i[0],a=i[1].map(function(t){return t.trim()});return{citations:n.mapValues(n.keyBy(o,2),1),bibliography:{meta:{errors:r.bibliography_errors,done:r.done,entryIds:r.entry_ids,entrySpacing:r.entryspacing,hangingIndent:r.hangingindent,lineSpacing:r.linespacing,maxOffset:r.maxoffset,secondFieldAlign:r["second-field-align"]},html:r.bibstart+a.join("")+r.bibend,items:a}}}var d=e.get("assets/typemap/zotero-csl.json").then(function(t){return t.data});return{render:r,renderBiblioItem:a}}t.$inject=["$q","$http","_","refsAdapter","citeproc"],angular.module("trcRefs").factory("refsRenderer",t)}(),function(){"use strict";function t(t){function e(e,o){return{citations:t.mapValues(o.citations,n),bibliography:t.mapValues(o.bibliography,i(e))}}function n(t){return{citationID:t.id,citationItems:t.items.map(function(t){return{id:t.id,locator:t.locator,label:t.locatorType,"suppress-author":t.suppressAuthor}}),properties:{}}}function o(t,e){var n=i(t);return n(e)}function i(t){function e(t){function e(t,e){if(t){var n=o(a,e);n&&("date"===n.type&&(t={raw:t}),l[n.field]=t)}}if(!t)return null;var r=t.type,a=n(r),l={};l.id=t.id,l.type=a.target;var d=i(a,t.creators);return angular.merge(l,d),angular.forEach(t.fields,e),angular.forEach(t.meta,e),l}function n(e){if(!e||!t.itemMappings.hasOwnProperty(e))throw new Error("malformed item or mapping: "+e+" is not defined as a valid "+t.source.format+" type mapping");return t.itemMappings[e]}function o(e,n){var o=e.fields[n];if(o&&o.target){var i=o.target,r=t.target.fields[i];if(!r)throw new Error("malformed mapping: source field "+n+" maps to target field "+i+", but "+i+" is not listed as a valid "+t.target.format+" field");return r}return null}function i(t,e){var n={};return e.forEach(function(e){if(e&&(e.firstName||e.lastName||e.name)){var o=t.creatorTypes[e.role];if(o&&o.target){var i=e.firstName||e.lastName?{given:e.firstName,family:e.lastName}:{literal:e.name},r=o.target;n.hasOwnProperty(r)||(n[r]=[]),n[r].push(i)}}}),n}return e}var r={};return r.adapt=e,r.adaptCitation=n,r.adaptBiblioItem=o,r}t.$inject=["_"],angular.module("trcRefs").factory("refsAdapter",t)}(),function(){"use strict";function t(t){function e(t,e){i[t]=e}function n(t,e){a[t]=e}function o(e,n,o){function s(t,n){function i(t){var e=n(t);if(!e)throw new Error("bibliography item supplier failed to return an item for id {"+t+"}");return e}var r=e.all({style:m(t),locales:p});return r.then(function(t){function e(e){if(!t.locales.hasOwnProperty(e))throw new Error("unknown locale "+e);return t.locales[e]}var n={retrieveLocale:e,retrieveItem:i};return new o.Engine(n,t.style,d.defaultLocale)})}function c(t){if(!i.hasOwnProperty(t))throw new Error("unknown locale "+t);if(!r.hasOwnProperty(t)){var e=i[t];r[t]=n.invoke(e)}return r[t]}function m(t){if(!a.hasOwnProperty(t))throw new Error("unknown style "+t);if(!l.hasOwnProperty(t)){var e=a[t];l[t]=n.invoke(e)}return l[t]}function u(){var n=t.mapValues(i,function(t,e){return c(e)});return e.all(n)}var p=u();return{load:s}}o.$inject=["$q","$injector","CSL"];var i={},r={},a={},l={},d={defaultLocale:"en-US",addLocale:e,addStyle:n,$get:o};return d}t.$inject=["_"],angular.module("trcRefs").provider("citeproc",t)}(),function(){"use strict";angular.module("trcArticles",["ngResource","uuid4","trcRefs"])}(),function(){"use strict";function t(){function t(t,n,o){function i(t){return e.url+"/"+t+"/references"}function r(t,e){return new u({articleType:t,title:e})}function a(){return{id:o.generate(),content:"",mimeType:"text/html"}}function l(t){return u.get({id:t})}function d(t){if(!(t instanceof u))throw new Error("Article was not created by this repo");return t.id?t.$update():t.$save()}function s(t){angular.isObject(t)&&t.id&&(t=t.id);var e=u["delete"]({id:t});return e.$promise}function c(t,e){var o=t.body+n.map(t.footnotes,"content").join("");for(var i in e.citations)e.citations.hasOwnProperty(i)&&o.indexOf(i)<0&&delete e.citations[i];return e}function m(t,e){for(var n in e)e.hasOwnProperty(n)&&t.body.indexOf(n)<0&&delete e[n];return e}var u=t(e.url+"/:id",{id:"@id"},{update:{method:"PUT"}}),p={};return p.getReferencesEndpoint=i,p.create=r,p.createFootnote=a,p.get=l,p.save=d,p["delete"]=s,p.cleanReferences=c,p.cleanFootnotes=m,p}t.$inject=["$resource","_","uuid4"];var e={};return e.url="/api/articles",e.$get=t,e}angular.module("trcArticles").provider("articlesRepo",t)}(),function(){"use strict";angular.module("trcBio",["ngResource"])}(),function(){"use strict";function t(){function t(t,n){function o(t){return e.url+"/"+t+"/references"}function i(){var t=new g;return p(t)}function r(){var t={};return v(t)}function a(){var t={};return f(t)}function l(){var t={};return h(t)}function d(){var t={};return t}function s(t){return g.get({id:t})}function c(t){return g.get({q:t})}function m(t){var e;return e=t.id?g.update({id:t.id},t):g.save(null,t),e.$promise.then(function(e){return t.id=e.id,t})}function u(t){angular.isObject(t)&&t.id&&(t=t.id);var e=g["delete"]({id:t});return e.$promise}function p(t){return t.meta?v(t.meta):t.meta=r(),t.name?f(t.name):t.name=a(),t.altNames?t.altNames.forEach(f):t.altNames=[],t.birth?h(t.birth):t.birth=l(),t.death?h(t.death):t.death=l(),t}function v(t){return t.links||(t.links={}),t}function f(t){return t}function h(t){return t.date||(t.date=d()),t}var g=n(e.url+"/:id",null,{update:{method:"PUT"}}),b={};return b.getReferencesEndpoint=o,b.create=i,b.createName=a,b.createEvent=l,b.get=s,b.search=c,b.save=m,b["delete"]=u,b}t.$inject=["$q","$resource"];var e={};return e.url="/api/people",e.$get=t,e}angular.module("trcBio").provider("peopleRepo",t)}(),function(){"use strict";function t(){function t(t,e){function n(){var n=e.createName();t.person.altNames.push(n)}function o(e){t.person.altNames.splice(e,1)}function i(n){var o=e.createEvent();t.person[n]=o}function r(e){t.person[e]=null}var a=this;a.addName=n,a.removeName=o,a.addEvent=i,a.removeEvent=r}t.$inject=["$scope","peopleRepo"];var e={restrict:"E",templateUrl:"app/trc-bio/person-editor.html",scope:{person:"=ngModel"},controller:t,controllerAs:"personEditor"};return e}angular.module("trcBio").directive("trcPersonEditor",t)}(),function(){"use strict";function t(){function t(){var t=this;t.roles=[{value:"canonical",label:"Canonical Name"},{value:"pseudonym",label:"Pseudonym"},{value:"maiden",label:"Maiden Name"},{value:"designation",label:"Honorary Designation"},{value:"nickname",label:"Nickname"},{value:"phonetic",label:"Phonetic Name"}]}var e={restrict:"E",templateUrl:"app/trc-bio/name-editor.html",scope:{name:"=ngModel"},controller:t,controllerAs:"nameEditor"};return e}angular.module("trcBio").directive("trcNameEditor",t)}(),function(){"use strict";function t(){var t={restrict:"E",templateUrl:"app/trc-bio/event-editor.html",scope:{event:"=ngModel"}};return t}angular.module("trcBio").directive("trcEventEditor",t)}(),function(){"use strict";function t(t,e,n){function o(){r.loading=!0,r.tasks=n.all(),r.tasks.$promise.then(function(){r.loading=!1},function(){r.loading=!1,e.show(e.simple().textContent("Unable to load tasks from server"))})}function i(){t("left").toggle()}var r=this;r.loading=!1,r.openMenu=i,o()}t.$inject=["$mdSidenav","$mdToast","tasksRepo"],angular.module("sdaAdminWeb").controller("TaskController",t)}(),function(){"use strict";function t(t,e,n,o,i){function r(){s.taskId=e.taskId,s.task=o.getTask(s.taskId),s.workflow=o.getWorkflow(s.taskId),s.workflow.$promise.then(function(){var t=[];angular.forEach(s.workflow.stages,function(e){var n=d(e.id);t.push(n)}),i.all(t).then(function(){s.loading=!1})})}function a(e,n){n.stopImmediatePropagation(),t.go("editor.work",{workId:e.entityId})}function l(t,e,n){n.stopImmediatePropagation();var i=o.transition(s.taskId,t,e);i.$promise.then(function(){d(e.sourceStage),d(e.targetStage)})}function d(t){var e=o.getItems(s.taskId,t,{max:9999});return e.$promise.then(function(){s.worklists[t]=e.items.length>0?e:null}),e.$promise}var s=this;s.stageOrder=["pinned","inprogress","review","pending","deferred"],s.loading=!0,s.worklists={},s.task=null,s.focusItem=a,s.transition=l,r()}t.$inject=["$state","$stateParams","$mdSidenav","tasksRepo","$q"],angular.module("sdaAdminWeb").controller("ShowTaskController",t)}(),function(){"use strict";angular.module("slideToggle",[])}(),function(){"use strict";function t(){function t(t,e,n){var o=parseInt(n.slideToggleDuration)||200;t.$watch("active",function(t){t?e.stop().slideDown(o):e.stop().slideUp(o)})}var e={restrict:"A",scope:{active:"=slideToggle"},link:t};return e}angular.module("slideToggle").directive("slideToggle",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d){function s(){var o=i.id,r=t.getReferencesEndpoint(o);h=e.getRepo(r),g.person=t.get(o),g.references=h.get(),g.references.$promise.then(function(){var t=l.values(g.references.citations);0===t.length?(g.citation=h.createCitation(),g.references.citations[g.citation.id]=g.citation):(t.length>1&&n.warn("reference collection contains "+t.length+" citations"),g.citation=t[0])})}function c(e){var n={targetEvent:e,templateUrl:"app/person/person-edit-dialog.html",locals:{person:angular.copy(g.person)},controller:"PersonEditDialogController",controllerAs:"vm"},o=r.show(n);o.then(function(e){angular.extend(g.person,e),t.save(g.person).then(f)})}function m(e,n){var o={targetEvent:n,templateUrl:"app/person/event-edit-dialog.html",locals:{event:angular.copy(g.person[e])},controller:"EventEditDialogController",controllerAs:"vm"},i=r.show(o);i.then(function(n){angular.extend(g.person[e],n),t.save(g.person).then(f)})}function u(e){var n={targetEvent:e,templateUrl:"app/components/summary-edit-dialog/summary-edit-dialog.html",locals:{summary:angular.copy(g.person.summary)},controller:"SummaryEditDialogController",controllerAs:"vm"},o=r.show(n);o.then(function(e){g.person.summary=e,t.save(g.person).then(f)})}function p(t){d.show(g.references,null,t).then(function(){h.save(g.references).then(f)})}function v(e,n){function i(){var t=d+" has been deleted.",e=a.simple().textContent(t).position("bottom right");return o.go("editor"),a.show(e)}function l(){var t=a.simple().textContent("Unable to delete "+d).position("bottom right");return a.show(t)}var d=n.name.label?'"'+n.name.label+'"':"this person",s=r.confirm({targetEvent:e,title:"Confirm Deletion",textContent:"Are you sure you want to delete "+d+"?",ok:"Yes",cancel:"No"}),c=r.show(s);return c.then(function(){return t["delete"](n).then(i,l)})}function f(){var t=a.simple().textContent("Saved").position("bottom right");return a.show(t)}var h=null,g=this;g.loading=!0,g.person=null,g.editBioInfo=c,g.editEvent=m,g.editSummary=u,g.editBibliography=p,g.deletePerson=v,s()}t.$inject=["peopleRepo","refsRepoFactory","$log","$state","$stateParams","$mdDialog","$mdToast","_","citationEditDialog"],angular.module("sdaAdminWeb").controller("ShowPersonController",t)}(),function(){"use strict";function t(t,e,n){function o(){e.hide(l.person)}function i(){e.cancel()}function r(){var e=t.createName();l.person.altNames.push(e)}function a(t){var e=l.person.altNames.indexOf(t);e>=0&&l.person.altNames.splice(e,1)}var l=this;l.person=n,l.nameRoles=[{value:"pseudonym",label:"Pseudonym"},{value:"maiden",label:"Maiden Name"},{value:"designation",label:"Honorary Designation"},{value:"nickname",label:"Nickname"},{value:"phonetic",label:"Phonetic Name"}],l.close=o,l.cancel=i,l.addName=r,l.deleteName=a}t.$inject=["peopleRepo","$mdDialog","person"],angular.module("sdaAdminWeb").controller("PersonEditDialogController",t)}(),function(){"use strict";function t(t,e){function n(){t.hide(i.event)}function o(){t.cancel()}var i=this;i.event=e,i.close=n,i.cancel=o}t.$inject=["$mdDialog","event"],angular.module("sdaAdminWeb").controller("EventEditDialogController",t)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l,d){function s(){o.q&&(f.searchQuery=o.q,m(f.searchQuery))}function c(){i("left").toggle()}function m(n){f.loading=!0,f.peopleResults=e.search(n),f.worksResults=t.search(n),a.all([f.peopleResults.$promise,f.worksResults.$promise]).then(function(){f.loading=!1})}function u(t){var o={targetEvent:t,templateUrl:"app/person/person-edit-dialog.html",locals:{person:e.create()},controller:"PersonEditDialogController",controllerAs:"vm"},i=l.show(o),r=i.then(function(t){return e.save(t)});r.then(v),r.then(function(t){n.go("editor.person",{id:t.id})})}function p(e){var o={targetEvent:e,templateUrl:"app/work/work-edit-dialog.html",locals:{work:t.createWork()},controller:"WorkEditDialogController",controllerAs:"vm"},i=l.show(o),r=i.then(function(e){return t.saveWork(e)});r.then(v),r.then(function(t){n.go("editor.work",{workId:t.id})})}function v(){var t=d.simple().textContent("Saved").position("bottom right");return d.show(t)}var f=this;f.loading=!1,f.searchQuery="",f.openMenu=c,f.createPerson=u,f.createWork=p,f.search=r.debounce(m,300),s()}t.$inject=["worksRepo","peopleRepo","$state","$stateParams","$mdSidenav","_","$q","$mdDialog","$mdToast"],angular.module("sdaAdminWeb").controller("MainController",t)}(),function(){"use strict";angular.module("google.books",[])}(),function(){"use strict";function t(){function t(t){angular.extend(n.options,t)}function e(t){return t.load(n.options)}e.$inject=["googleBooksScriptLoader"];var n={};return n.options={transport:"https",v:0,language:"en",preventLoad:!1},n.configure=t,n.$get=e,n}angular.module("google.books").provider("googleBooksApi",t)}(),function(){"use strict";function t(t,e,n,o){function i(t){return"auto"===t.transport?"//www.google.com/books/api.js?":t.transport+"://www.google.com/books/api.js?"}function r(t){var n=["transport","preventLoad","randomizedFunctionName"],r=o.map(o.omit(t,n),function(t,e){return e+"="+t});if(s){var a=e.getElementById(s);a.parentNode.removeChild(a)}else s="gbooks_load_"+Math.round(1e3*Math.random());r=r.join("&"),angular.element("<script>",{id:s,type:"text/javascript",src:i(t)+r}).appendTo(angular.element("body"))}function a(){return angular.isDefined(t.google)&&angular.isDefined(t.google.books)}function l(e){var o=n.defer();if(a())return o.resolve(t.google.books),o.promise;var i="onGoogleBooksReady"+Math.round(1e3*Math.random());return e.callback=i,t[i]=function(){t[i]=null,o.resolve(t.google.books)},e.preventLoad||r(e),c=e,c.randomizedFunctionName=i,o.promise}function d(){var e=c;a()?t[e.randomizedFunctionName]&&t[e.randomizedFunctionName]():r(e)}var s=void 0,c=void 0;return{load:l,manualLoad:d}}t.$inject=["$window","$document","$q","_"],angular.module("google.books").factory("googleBooksScriptLoader",t)}(),function(){"use strict";function t(t,e){function n(n,o){e.load(),t.then(function(t){var e=new t.DefaultViewer(o.get(0));n.$watch("properties",function(t){e.load(t.id)}),n.$on("resize",function(){e.resize()})})}var o={restrict:"E",link:n,scope:{properties:"="}};return o}t.$inject=["googleBooksApi","googleBooksApiManualLoader"],angular.module("google.books").directive("googleBookReader",t)}(),function(){"use strict";function t(t){function e(){t.manualLoad()}var n={};return n.load=e,n}t.$inject=["googleBooksScriptLoader"],angular.module("google.books").service("googleBooksApiManualLoader",t)}(),function(){"use strict";function t(t){t.debug("runBlock end")}t.$inject=["$log"],angular.module("sdaAdminWeb").run(t)}(),function(){"use strict";function t(t,e){t.state("editor",{url:"/?q",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm"}).state("editor.person",{url:"people/:id",views:{main:{templateUrl:"app/person/person.html",controller:"ShowPersonController",controllerAs:"vm"}}}).state("editor.work",{url:"works/:workId",views:{main:{templateUrl:"app/work/work.html",controller:"ShowWorkController",controllerAs:"vm"}}}).state("editor.edition",{url:"works/:workId/editions/:editionId",views:{main:{templateUrl:"app/work/edition.html",controller:"ShowEditionController",controllerAs:"vm"}}}).state("editor.volume",{url:"works/:workId/editions/:editionId/volumes/:volumeId",views:{main:{templateUrl:"app/work/volume.html",controller:"ShowVolumeController",controllerAs:"vm"}}}).state("article",{url:"/articles",templateUrl:"app/admin/editors/articles/article.html",controller:"ArticleEditorSectionController",controllerAs:"vm"}).state("article.edit",{url:"/:id",templateUrl:"app/admin/editors/articles/article-editor.html",controller:"ArticleEditorController",controllerAs:"vm"}).state("task",{url:"/task",templateUrl:"app/task/task.html",controller:"TaskController",controllerAs:"vm"}).state("task.show",{url:"/:taskId",templateUrl:"app/task/show.html",controller:"ShowTaskController",controllerAs:"vm"}).state("vwise",{url:"/vwise/:workspaceId",templateUrl:"app/vwise/workspace.html",controller:"WorkspaceController",controllerAs:"vm"}).state("zotero",{url:"/zotero",templateUrl:"app/zotero/test/test.html",controller:"ZoteroTestController",controllerAs:"vm"}),e.otherwise("/")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("sdaAdminWeb").config(t)}(),function(){"use strict";angular.module("sdaAdminWeb").constant("_",_).constant("moment",moment)}(),function(){"use strict";function t(t,e,n,o,i,r,a,l){t.debugEnabled(!0),e.definePalette("darkBrown",{50:"#595c59",100:"#4c4f4c",200:"#404240",300:"#333533",400:"#272827",500:"#1a1b1a",600:"#0d0e0d",700:"#010101",800:"#000000",900:"#000000",A100:"#e0f0e0",A200:"#565956",A400:"#7e837e",A700:"#000000",contrastDefaultColor:"light",contrastDarkColors:["A100"]}),e.definePalette("copper",{50:"#d4b190",100:"#cca47e",200:"#c5976b",300:"#be8a59",400:"#b67e47",500:"#a47140",600:"#926439",700:"#7f5832",800:"#6d4b2b",900:"#5b3e23",A100:"#dcc3ab",A200:"#a47140",A400:"#48321c",A700:"#272927",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"]}),e.theme("default").primaryPalette("darkBrown").accentPalette("copper"),n.url="/api/catalog/v1/tasks",o.url="/api/catalog/works",i.url="/api/catalog/people",r.url="/api/catalog/entries/articles",a.url="/api/catalog/relationships",l.url="/api/catalog/categorizations"}t.$inject=["$logProvider","$mdThemingProvider","tasksRepoProvider","worksRepoProvider","peopleRepoProvider","articlesRepoProvider","relationshipsRepoProvider","categorizationServiceProvider"],angular.module("sdaAdminWeb").config(t)}(),function(){"use strict";function t(t){function e(e){function n(t){return t.get("assets/csl/locales/locales-"+e+".xml").then(function(t){return t.data})}n.$inject=["$http"],t.addLocale(e,n)}function n(e){function n(t){return t.get("assets/csl/styles/"+e+".csl").then(function(t){return t.data})}n.$inject=["$http"],t.addStyle(e,n)}e("en-US"),n("modern-language-association")}t.$inject=["citeprocProvider"],angular.module("sdaAdminWeb").config(t)}(),angular.module("sdaAdminWeb").run(["$templateCache",function(t){t.put("app/main/main.html",'<md-content flex layout=column><navbar title="Editorial Tools" sidenav-id=left></navbar><md-content flex layout=row><md-sidenav md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" ui-view=sidebar layout=column><form layout=row flex=none><md-input-container flex><label for=searchQuery>Search</label><md-icon>search</md-icon><input type=search name=searchQuery id=searchQuery ng-model=vm.searchQuery ng-change=vm.search(vm.searchQuery) required></md-input-container></form><md-content flex><div ng-if=vm.loading layout=row layout-align=center><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if="!vm.loading &amp;&amp; vm.peopleResults &amp;&amp; vm.peopleResults.items.length > 0"><md-subheader>People</md-subheader><md-list><md-list-item ng-repeat="person in vm.peopleResults.items" ui-sref="editor.person({id: person.id})"><div class=md-list-item-text><span>{{person.label}}</span></div></md-list-item></md-list></div><div ng-if="!vm.loading &amp;&amp; vm.worksResults &amp;&amp; vm.worksResults.items.length > 0"><md-subheader>Works</md-subheader><md-list><md-list-item ng-repeat="work in vm.worksResults.items" ui-sref="editor.work({workId: work.id})"><div class=md-list-item-text><span>{{work.label}}</span></div></md-list-item></md-list></div></md-content><md-fab-speed-dial md-direction=up class="md-scale md-fab-bottom-right md-fab-straddle"><md-fab-trigger><md-button aria-label=New... class=md-fab><md-icon>add</md-icon></md-button></md-fab-trigger><md-fab-actions><md-button aria-label="New Article" class="md-fab md-mini" ng-click=vm.createArticle($event)><md-tooltip md-direction=left>New Article</md-tooltip><md-icon>description</md-icon></md-button><md-button aria-label="New Person" class="md-fab md-mini" ng-click=vm.createPerson($event)><md-tooltip md-direction=left>New Person</md-tooltip><md-icon>person</md-icon></md-button><md-button aria-label="New Work" class="md-fab md-mini" ng-click=vm.createWork($event)><md-tooltip md-direction=left>New Book</md-tooltip><md-icon>book</md-icon></md-button></md-fab-actions></md-fab-speed-dial></md-sidenav><md-content flex layout=column ui-view=main></md-content></md-content></md-content>'),t.put("app/person/event-edit-dialog.html","<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Event Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><event-editor ng-model=vm.event flex></event-editor></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>"),t.put("app/person/person-edit-dialog.html",'<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Biographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><section class=name layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Canonical Name</h2></div></md-toolbar><div class=name><name-editor ng-model=vm.person.name flex></name-editor></div></section><section class=alt-names layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Alternate Names</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addName()><md-icon>add</md-icon></md-button></div></md-toolbar><div class=name layout=row ng-repeat="name in vm.person.altNames"><md-input-container><label>role</label><md-select ng-model=name.role><md-option ng-repeat="role in vm.nameRoles" value={{role.value}}>{{role.label}}</md-option></md-select></md-input-container><name-editor ng-model=name flex></name-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click=vm.deleteName(name)><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/person/person.html",'<div layout=row layout-padding flex=noshrink><div flex=60><section class="content names"><div class=toolbar layout=row layout-align="start center"><h1 class=content-heading>{{vm.person.name.label}}</h1><span flex></span><md-button class=md-icon-button ng-click=vm.editBioInfo($event)><md-icon>edit</md-icon></md-button></div><div ng-if="vm.person.altNames && vm.person.altNames.length > 0"><p>Other names:</p><ul><li ng-repeat="name in vm.person.altNames">{{name.label}}</li></ul></div></section><section class="content summary"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.person.summary ng-bind-html=vm.person.summary></p></section><section class="content bibliography"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Bibliography</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibliography($event)><md-icon>edit</md-icon></md-button></div><bibliography collection=vm.references></bibliography></section></div><div flex=40><section class="content birth"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Birth</h2><span flex></span><md-button class=md-icon-button ng-click="vm.editEvent(\'birth\', $event)"><md-icon>edit</md-icon></md-button></div><p><span class=description ng-if=vm.person.birth.date.description>{{vm.person.birth.date.description}}</span> <span class=location ng-if=vm.person.birth.location>in {{vm.person.birth.location}}</span></p><p ng-bind-html=vm.person.birth.description ng-if=vm.person.birth.description></p></section><section class="content death"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Death</h2><span flex></span><md-button class=md-icon-button ng-click="vm.editEvent(\'death\', $event)"><md-icon>edit</md-icon></md-button></div><p><span class=description ng-if=vm.person.death.date.description>{{vm.person.death.date.description}}</span> <span class=location ng-if=vm.person.death.location>in {{vm.person.death.location}}</span></p><p ng-bind-html=vm.person.death.description ng-if=vm.person.death.description></p></section></div></div><div layout=row layout-align=end layout-margin><div><md-button aria-label="Delete this person" class="md-warn md-icon-button" ng-click="vm.deletePerson($event, vm.person)"><md-icon>delete</md-icon><md-tooltip md-direction=left>Delete</md-tooltip></md-button></div></div>'),t.put("app/task/show.html",'<md-content flex layout=column><div class=task-info><span class=label>{{vm.task.label}}</span> <span class=description>{{vm.task.description}}</span></div><md-input-container><label>Search</label><md-icon>search</md-icon><input type=search ng-model=filter ng-change=vm.search(filter)></md-input-container><md-content flex><div layout=row layout-align="center center" ng-if=vm.loading><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-repeat="stageId in vm.stageOrder" ng-if=vm.worklists[stageId]><md-subheader>{{vm.workflow.stages[stageId].label}}</md-subheader><md-list><md-list-item ng-repeat="item in vm.worklists[stageId].items | filter : filter | limitTo : 20" ng-mouseover="item.hover = true" ng-mouseout="item.hover = false" ng-click="vm.focusItem(item, $event)"><span ng-bind-html=item.label></span> <span flex></span><md-button class=md-exclude ng-repeat="transition in vm.workflow.stages[stageId].transitions" ng-click="vm.transition(item, transition, $event)" ng-show=item.hover><span>{{transition.label}}</span></md-button></md-list-item></md-list></div></md-content></md-content>'),t.put("app/task/task.html",'<md-content flex layout=column><navbar title="Task Management Dashboard" sidenav-id=left></navbar><md-content flex layout=row><md-sidenav md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" layout=column><div ng-if=vm.loading flex layout=row layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><md-list ng-if=!vm.loading><md-list-item ng-repeat="task in vm.tasks" ui-sref="task.show({ taskId: task.id })">{{ task.label }}</md-list-item></md-list></md-sidenav><md-content flex layout=column ui-view><div layout=row layout-padding layout-margin layout-align="center center"><div class=md-headline>Please select a task from the sidebar.</div></div></md-content></md-content></md-content>'),
t.put("app/trc-bio/event-editor.html",'<div class=form-group><label class=control-label for=event-title>Title</label><input type=text id=event-title name=event-title class="form-control event-title" ng-model=event.title></div><div class=form-group><label class=control-label for=event-description>Description</label><textarea id=event-description name=event-description class="form-control event-description" ng-model=event.description></textarea></div><div class=form-group><label class=control-label for=event-location>Location</label><input type=text id=event-location name=event-location class="form-control event-location" ng-model=event.location></div><div class=form-group><label class=control-label for=event-date>Date</label><input type=text id=event-date name=event-date class="form-control event-date" ng-model=event.date.description><!-- TODO add datepicker --></div>'),t.put("app/trc-bio/name-editor.html",'<div class=form-group class=name-role><label class=control-label for=name-role>Role</label><select id=name-role name=name-role class="form-control name-role" ng-model=name.role><option ng-repeat="role in nameEditor.roles" value={{role.value}}>{{role.label}}</option></select></div><div class=form-group class=name-structure><label class=control-label>Structured Name</label><input type=text class=name-title placeholder=title ng-model=name.title> <input type=text class=name-given placeholder=given ng-model=name.givenName> <input type=text class=name-middle placeholder=middle ng-model=name.middleName> <input type=text class=name-family placeholder=family ng-model=name.familyName> <input type=text class=name-suffix placeholder=suffix ng-model=name.suffix></div><div class=form-group class=name-label><label for=label>Display Label</label><input type=text placeholder=label ng-model=name.label></div>'),t.put("app/trc-bio/person-editor.html",'<div class=form-group><label for=person-name>Primary Name</label><trc-name-editor id=person-name ng-model=person.name></trc-name-editor></div><div class=form-group><label for=person-altnames>Alternate Names</label><div ng-repeat="name in person.altNames"><trc-name-editor id=person-altnames ng-model=name></trc-name-editor><button ng-click=personEditor.removeName($index)>&minus;</button></div><button ng-click=personEditor.addName()>+</button></div><div class=form-group><label for=person-birth>Birth</label><div ng-if=person.birth><trc-event-editor id=person-birth ng-model=person.birth></trc-event-editor><button ng-click="personEditor.removeEvent(\'birth\')">&minus;</button></div><div ng-if=!person.birth><button ng-click="personEditor.addEvent(\'birth\')">+</button></div></div><div class=form-group><label for=person-death>Death</label><div ng-if=person.death><trc-event-editor id=person-death ng-model=person.death></trc-event-editor><button ng-click="personEditor.removeEvent(\'death\')">&minus;</button></div><div ng-if=!person.death><button ng-click="personEditor.addEvent(\'death\')">+</button></div></div><div class=form-group><label class=control-label for=person-summary>Summary</label><textarea id=person-summary name=person-summary class="form-control person-summary" ng-model=person.summary></textarea></div>'),t.put("app/vwise/workspace.html",'<div layout=column flex><md-toolbar><div class=md-toolbar-tools><md-button class="md-accent md-icon-button" ng-click=vm.openMenu() title="toggle menu" hide-gt-sm><md-icon>menu</md-icon></md-button><img class=logo src=assets/images/sda-logo-light.png><h2><span>Visual Workspace</span></h2></div></md-toolbar><div layout=row flex><md-sidenav md-component-id=left class=md-sidenav-left layout=column md-is-locked-open=vm.sidebarFocused><form layout=row flex=none><md-input-container flex><label for=searchQuery>Search</label><md-icon>search</md-icon><input type=search name=searchQuery id=searchQuery ng-model=vm.searchQuery ng-change=vm.search(vm.searchQuery) required md-sidenav-focus></md-input-container></form><md-content flex><div ng-if=vm.loading layout=row layout-align=center><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if="!vm.loading &amp;&amp; vm.peopleResults &amp;&amp; vm.peopleResults.items.length == 0 &amp;&amp; vm.worksResults &amp;&amp; vm.worksResults.items.length == 0" layout=row layout-padding><p>No results for "{{vm.searchQuery}}".</p></div><div ng-if="!vm.loading &amp;&amp; vm.peopleResults &amp;&amp; vm.peopleResults.items.length > 0"><md-subheader>People</md-subheader><md-list><md-list-item ng-repeat="item in vm.peopleResults.items" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text><span>{{item.label}}</span></div></md-list-item></md-list></div><div ng-if="!vm.loading &amp;&amp; vm.worksResults &amp;&amp; vm.worksResults.items.length > 0"><md-subheader>Works</md-subheader><md-list><md-list-item ng-repeat="item in vm.worksResults.items" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text><span>{{item.label}}</span></div></md-list-item></md-list></div></md-content></md-sidenav><vwise-workspace workspace=vm.workspace flex layout=column></vwise-workspace></div></div>'),t.put("app/work/copy-edit-dialog.html","<md-dialog flex=50><md-toolbar><div class=md-toolbar-tools><h3>Digital Copy Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><copy-editor ng-model=vm.copy></copy-editor></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>"),t.put("app/work/edition-edit-dialog.html",'<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><div layout=row><md-input-container flex><label>edition name</label><input type=text ng-model=vm.edition.editionName required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=vm.edition.publicationInfo flex></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat="title in vm.edition.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteTitle(title, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click="vm.addAuthor(\'authors\', $event)"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat="author in vm.edition.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteAuthor(\'authors\', author, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/work/edition.html",'<nav layout=row layout-padding><ol class=breadcrumbs flex><li><a ui-sref="editor.work({workId: vm.work.id})">{{vm.workTitle.title}}{{vm.workTitle.title && vm.workTitle.subtitle ? \': \' : \'\'}}{{vm.workTitle.subtitle}}</a></li><li>{{vm.edition.editionName}}</li></ol></nav><div layout=row layout-padding><div layout=column flex=60><section class="content citation"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if="vm.edition.authors && vm.edition.authors.length > 0"><span class=author ng-repeat="author in vm.edition.authors"><span ng-if=author.authorId><a ui-sref="editor.person({id: author.authorId})">{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \': \' : \'\'}}{{vm.title.subtitle}}. </span><span class=publication ng-if=vm.edition.publicationInfo><span ng-if=vm.edition.publicationInfo.place><span class=place>{{vm.edition.publicationInfo.place}}</span>: </span><span ng-if=vm.edition.publicationInfo.publisher><span class=publisher>{{vm.edition.publicationInfo.publisher}}</span>, </span><span ng-if=vm.edition.publicationInfo.date><time class=date datetime={{vm.edition.publicationInfo.date.calendar}}>{{vm.edition.publicationInfo.date.description}}</time>.</span></span></p></section><section class="content summary"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.edition.summary ng-bind-html=vm.edition.summary></p></section><section class="content volumes"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Volumes</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addVolume($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat="volume in vm.edition.volumes" ui-sref="editor.volume({workId: vm.work.id, editionId: vm.edition.id, volumeId: volume.id})"><span>Volume {{volume.volumeNumber}}</span><md-button class="md-secondary md-icon-button md-warn" ng-click="vm.deleteVolume(volume, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div><div layout=column flex=40><section class="content references"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Relationships</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addRelationship($event)><md-icon>add</md-icon></md-button></div><div ng-repeat="type in vm.relationships"><h3 class=content-heading>{{type.label}}</h3><md-list><md-list-item ng-repeat="relationship in type.relationships" ng-click=vm.openRelationship(relationship)><span ng-repeat="entity in relationship.entities">{{entity.label}}.</span><md-button class="md-secondary md-warn md-icon-button" ng-click="vm.deleteRelationship(relationship, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></div></section><section class="content copies"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat="copy in vm.edition.copies" ng-click="vm.editCopy(copy, $event)"><span>{{copy.title}}</span><md-button class="md-secondary md-icon-button" ng-click=vm.copyToWork(copy) aria-label="copy to parent work"><md-icon>file_upload</md-icon><md-tooltip>Copy to Work</md-tooltip></md-button><md-button class="md-secondary md-icon-button md-warn" ng-click="vm.deleteCopy(copy, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div>'),t.put("app/work/relationship-edit-dialog.html",'<md-dialog flex=50><md-toolbar><div class=md-toolbar-tools><h3>Relationship Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form name=relationship ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content layout=column><md-input-container><label>type</label><md-select name=type ng-model=vm.selectedType ng-change=vm.setType(vm.selectedType) required><md-option ng-repeat="type in vm.types" ng-value=type>{{type.label}}</md-option></md-select><div class=errors ng-messages=relationship.type.$error ng-if=relationship.$dirty><div ng-message=required>Required</div></div></md-input-container><md-autocomplete md-items="work in vm.getResults(vm.searchText)" md-item-text=work.label md-search-text=vm.searchText md-selected-item-change=vm.selectWork(work) placeholder="search works" required><md-item-template><span md-highlight=vm.searchText md-highlight-flags=^i>{{work.label}}</span></md-item-template></md-autocomplete><md-input-container ng-if="vm.targets && vm.targets.length > 1"><label>target</label><md-select name=target ng-model=vm.selectedTarget ng-change=vm.setTarget(vm.selectedTarget) required><md-option ng-repeat="target in vm.targets" ng-value=target>{{target.label}}</md-option></md-select><div class=errors ng-messages=relationship.target.$error ng-if=relationship.$dirty><div ng-message=required>Required</div></div></md-input-container><div class=summary><h2>Summary</h2><div ckeditor ng-model=vm.relationship.description></div></div></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/work/volume-edit-dialog.html",'<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><div layout=row><md-input-container flex><label>volume number</label><input type=text ng-model=vm.volume.volumeNumber required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=vm.volume.publicationInfo></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat="title in vm.volume.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteTitle(title, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click="vm.addAuthor(\'authors\', $event)"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat="author in vm.volume.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteAuthor(\'authors\', author, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/work/volume.html",'<nav layout=row layout-padding><ol class=breadcrumbs flex><li><a ui-sref="editor.work({workId: vm.work.id})">{{vm.workTitle.title}}{{vm.workTitle.title && vm.workTitle.subtitle ? \': \' : \'\'}}{{vm.workTitle.subtitle}}</a></li><li><a ui-sref="editor.edition({workId: vm.work.id, editionId: vm.edition.id})">{{vm.edition.editionName}}</a></li><li>Volume {{vm.volume.volumeNumber}}</li></ol></nav><div layout=row layout-padding><div layout=column flex=60><section class="content citation"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if="vm.volume.authors && vm.volume.authors.length > 0"><span class=author ng-repeat="author in vm.volume.authors"><span ng-if=author.authorId><a ui-sref="editor.person({id: author.authorId})">{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \': \' : \'\'}}{{vm.title.subtitle}}. </span><span class=publication ng-if=vm.volume.publicationInfo><span ng-if=vm.volume.publicationInfo.place><span class=place>{{vm.volume.publicationInfo.place}}</span>: </span><span ng-if=vm.volume.publicationInfo.publisher><span class=publisher>{{vm.volume.publicationInfo.publisher}}</span>, </span><span ng-if=vm.volume.publicationInfo.date><time class=date datetime={{vm.volume.publicationInfo.date.calendar}}>{{vm.volume.publicationInfo.date.description}}</time>.</span></span></p></section><section class="content summary"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.volume.summary ng-bind-html=vm.volume.summary></p></section></div><div layout=column flex=40><section class="content references"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Relationships</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addRelationship($event)><md-icon>add</md-icon></md-button></div><div ng-repeat="type in vm.relationships"><h3 class=content-heading>{{type.label}}</h3><md-list><md-list-item ng-repeat="relationship in type.relationships" ng-click=vm.openRelationship(relationship)><span ng-repeat="entity in relationship.entities">{{entity.label}}.</span><md-button class="md-secondary md-warn md-icon-button" ng-click="vm.deleteRelationship(relationship, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></div></section><section class="content copies"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat="copy in vm.volume.copies" ng-click="vm.editCopy(copy, $event)"><span>{{copy.title}}</span><md-button class="md-secondary md-icon-button" ng-click=vm.copyToEdition(copy) aria-label="copy to parent edition"><md-icon>file_upload</md-icon><md-tooltip>Copy to Edition</md-tooltip></md-button><md-button class="md-secondary md-icon-button md-warn" ng-click="vm.deleteCopy(copy, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div>'),t.put("app/work/work-edit-dialog.html",'<md-dialog flex=80><md-toolbar><div class=md-toolbar-tools><h3>Bibliographic Information Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><div class=md-dialog-content><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addTitle($event)><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat="title in vm.work.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteTitle(title, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click="vm.addAuthor(\'authors\', $event)"><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat="author in vm.work.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="vm.deleteAuthor(\'authors\', author, $event)"><md-icon>delete</md-icon></md-button></md-input-container></div></section></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/work/work.html",'<nav layout=row layout-padding><ol class=breadcrumbs flex><li>{{vm.bcTitle.title}}{{vm.bcTitle && vm.bcTitle.subtitle ? \': \' : \'\'}}{{vm.bcTitle.subtitle}}</li></ol></nav><div layout=row layout-padding flex=noshrink><div layout=column flex=60><section class="content citation"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Bibliographic Information</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibInfo($event)><md-icon>edit</md-icon></md-button></div><p><span class=authors ng-if="vm.work.authors && vm.work.authors.length > 0"><span class=author ng-repeat="author in vm.work.authors"><span ng-if=author.authorId><a ui-sref="editor.person({id: author.authorId})">{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}</a>. </span><span ng-if=!author.authorId>{{author.lastName}}{{author.lastName && author.firstName ? \', \' : \'\'}}{{author.firstName}}. </span></span></span><span class=title ng-if=vm.title>{{vm.title.title}}{{vm.title.title && vm.title.subtitle ? \': \' : \'\'}}{{vm.title.subtitle}}.</span></p></section><section class="content summary"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Summary</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editSummary($event)><md-icon>edit</md-icon></md-button></div><p ng-if=vm.work.summary ng-bind-html=vm.work.summary></p></section><section class="content editions"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Editions</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addEdition($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat="edition in vm.work.editions" ui-sref="editor.edition({workId: vm.work.id, editionId: edition.id})"><span>{{edition.editionName}}</span><md-button class="md-secondary md-icon-button md-warn" ng-click="vm.deleteEdition(edition, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section><section class="content bibliography"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Bibliography</h2><span flex></span><md-button class=md-icon-button ng-click=vm.editBibliography($event)><md-icon>edit</md-icon></md-button></div><bibliography collection=vm.references></bibliography></section></div><div layout=column flex=40><section class="content references"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Relationships</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addRelationship($event)><md-icon>add</md-icon></md-button></div><div ng-repeat="type in vm.relationships"><h3 class=content-heading>{{type.label}}</h3><md-list><md-list-item ng-repeat="relationship in type.relationships" ng-click=vm.openRelationship(relationship)><span ng-repeat="entity in relationship.entities">{{entity.label}}.</span><md-button class="md-secondary md-warn md-icon-button" ng-click="vm.deleteRelationship(relationship, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></div></section><section class="content copies"><div class=toolbar layout=row layout-align="start center"><h2 class=content-heading>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=vm.addCopy($event)><md-icon>add</md-icon></md-button></div><md-list><md-list-item ng-repeat="copy in vm.work.copies" ng-click="vm.editCopy(copy, $event)"><span>{{copy.title}}</span><md-button class="md-secondary md-icon-button md-warn" ng-click="vm.deleteCopy(copy, $event)"><md-icon>delete</md-icon></md-button></md-list-item></md-list></section></div></div><div layout=row layout-align=end layout-margin><div><md-button aria-label="Delete this work" class="md-warn md-icon-button" ng-click="vm.deleteWork($event, vm.work)"><md-icon>delete</md-icon><md-tooltip md-direction=left>Delete</md-tooltip></md-button></div></div>'),t.put("app/zotero/creator-field.html",'<div layout=row layout-margin><md-input-container><label>Role</label><md-select ng-model=$ctrl.creator.creatorType ng-disabled="!$ctrl.roles || $ctrl.roles.length == 0"><md-option ng-value=role.role ng-repeat="role in $ctrl.roles">{{role.label}}</md-option></md-select></md-input-container><md-input-container ng-if=verbatim flex><label>Name</label><input type=text ng-model=$ctrl.creator.name></md-input-container><md-input-container ng-if=!verbatim flex><label>First Name</label><input type=text ng-model=$ctrl.creator.firstName></md-input-container><md-input-container ng-if=!verbatim flex><label>Last Name</label><input type=text ng-model=$ctrl.creator.lastName></md-input-container><div layout=column layout-align="center center"><md-button ng-show=verbatim ng-click="verbatim = false" class=md-icon-button aria-label="First/Last Names"><md-icon>people</md-icon><md-tooltip>First/Last Names</md-tooltip></md-button><md-button ng-hide=verbatim ng-click="verbatim = true" class=md-icon-button aria-label="Single Name"><md-icon>domain</md-icon><md-tooltip>Single Name</md-tooltip></md-button></div></div>'),t.put("app/zotero/editor.html",'<div layout=column flex><div layout=row layout-margin><md-autocomplete md-search-text=$ctrl.itemTypeSearchText md-items="type in $ctrl.types | filter: {label: $ctrl.itemTypeSearchText}" md-item-text=type.label md-selected-item=$ctrl.itemType md-selected-item-change=$ctrl.selectType($ctrl.itemType) md-min-length=0 placeholder="Item Type" required><md-item-template><span md-highlight-text=$ctrl.itemTypeSearchText md-highlight-flags=^i>{{type.label}}</span></md-item-template></md-autocomplete></div><div layout=row ng-repeat="creator in $ctrl.item.creators" layout-align="start center"><zotero-creator-field creator=creator roles=$ctrl.roles flex></zotero-creator-field><md-button ng-click="$ctrl.item.creators.splice($index+1, 0, {})" class=md-icon-button aria-label="New Creator"><md-icon>add</md-icon><md-tooltip>New</md-tooltip></md-button><md-button ng-disabled="$ctrl.item.creators.length <= 1" ng-click="$ctrl.item.creators.splice($index, 1)" class="md-icon-button md-warn" aria-label="Delete Creator"><md-icon>remove</md-icon><md-tooltip>Delete</md-tooltip></md-button></div><div layout=row layout-margin ng-repeat="field in $ctrl.fields"><md-input-container flex><label>{{field.label}}</label><input type=text ng-model=$ctrl.item[field.id]></md-input-container></div><div ng-if=!$ctrl.itemType layout-margin><p>Please select an item type first.</p></div></div>'),t.put("app/components/citation-edit-dialog/citation-edit-dialog.html",'<md-dialog aria-label="Edit Citation" flex=50 layout=column><form ng-cloak><md-toolbar><div class=md-toolbar-tools><h2>Edit Citation</h2><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon aria-label=Cancel>close</md-icon></md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content><citation-editor references=vm.references citation=vm.citation></citation-editor></div></md-dialog-content><md-dialog-actions layout=row><md-button ng-click=vm.cancel()>Cancel</md-button><md-button ng-click=vm.done()>Save</md-button></md-dialog-actions></form></md-dialog>'),t.put("app/components/citation-edit-dialog/citation-editor.html",'<div class=citation-editor-layout layout=column flex><div class=citation-editor-container ng-hide=$ctrl.zoteroItem layout=column flex><div layout=row layout-wrap><div layout=row layout-align="start center" layout-margin class=md-whiteframe-2dp ng-repeat="item in $ctrl.citation.items"><span ng-bind-html=item.label></span><md-button class=md-icon-button aria-label=Edit ng-click=$ctrl.edit(item)><md-icon>edit</md-icon><md-tooltip>Edit Item</md-tooltip></md-button><md-button class="md-icon-button md-warn" aria-label=Remove ng-click="$ctrl.citation.items.splice($index, 1)"><md-icon>remove</md-icon><md-tooltip>Remove Item</md-tooltip></md-button></div></div><div layout=column><md-autocomplete md-autoselect md-floating-label="Referenced Item" md-selected-item=$ctrl.selectedBiblioItem md-selected-item-change=$ctrl.selectBiblioItem($ctrl.selectedBiblioItem) md-search-text=$ctrl.searchText md-items="item in $ctrl.search($ctrl.searchText)" md-item-text="item.label | stripTags" md-delay=200 md-require-match required><md-item-template><span ng-bind-html=item.label></span></md-item-template><md-not-found>No matches found.<md-button ng-click=$ctrl.createZoteroItem($event)>Create</md-button></md-not-found></md-autocomplete><div layout=row><md-input-container><label>Locator Type</label><md-select ng-model=$ctrl.activeCitationItem.locatorType><md-option></md-option><md-option ng-repeat="type in $ctrl.locatorTypes" ng-value=type>{{type}}</md-option></md-select></md-input-container><md-input-container flex><label>Locator</label><input type=text ng-model=$ctrl.activeCitationItem.locator></md-input-container></div><md-checkbox ng-model=$ctrl.activeCitationItem.suppressAuthor>Suppress Author Name in In-Text Citation</md-checkbox></div><div layout=row layout-align=end><md-button class=md-raised ng-click=$ctrl.addCitationItem($ctrl.activeCitationItem)>Save Item</md-button></div></div><div class=zotero-item-editor-container ng-if=$ctrl.zoteroItem layout=row flex><div layout=column><md-button class=md-icon-button ng-click=$ctrl.cancelZoteroItem($event)><md-icon>cancel</md-icon><md-tooltip md-direction=right>Cancel New Item</md-tooltip></md-button><md-button class=md-icon-button ng-click="$ctrl.saveZoteroItem($event, $ctrl.zoteroItem)"><md-icon>check_circle</md-icon><md-tooltip md-direction=right>Save and Cite Item</md-tooltip></md-button></div><zotero-editor item=$ctrl.zoteroItem flex></zotero-editor></div></div>'),t.put("app/components/ckeditor-footnotes/footnote-edit-dialog.html",'<md-bottom-sheet aria-label="Insert Footnote" layout=column><md-toolbar><div class=md-toolbar-tools><h2>Insert Footnote</h2><span flex></span><md-button ng-click=vm.cancel()>Cancel</md-button><md-button ng-click=vm.done()>Save</md-button></div></md-toolbar><div ng-if=vm.references ng-model=vm.footnote.content ckeditor ckeditor-bibliography=vm.references></div><div ng-if=!vm.references ng-model=vm.footnote.content ckeditor></div></md-bottom-sheet>'),t.put("app/components/date-editor/date-editor.html",'<div layout=row><md-input-container flex><label>date</label><input type=text ng-model=date.description></md-input-container><md-input-container flex><label>ISO-8601 date</label><input type=datetime ng-model=date.calendar ng-change="calendarAutoSet = false"></md-input-container></div>'),t.put("app/components/navbar/navbar.html",'<md-toolbar><div class=md-toolbar-tools><md-button ng-if=$ctrl.sidenavId class="md-accent md-icon-button" ng-click=$ctrl.toggleSidenav($ctrl.sidenavId) title="toggle menu" hide-gt-sm><md-icon>menu</md-icon></md-button><img class=logo src=assets/images/sda-logo-light.png><h2><span>{{$ctrl.title}}</span><!-- make this change based on page --></h2><span flex></span><md-button ui-sref=editor>People and Works</md-button><md-button ui-sref=article>Article</md-button><md-button ui-sref=task>Tasks</md-button></div></md-toolbar>'),
t.put("app/components/summary-edit-dialog/summary-edit-dialog.html","<md-dialog flex=50><md-toolbar><div class=md-toolbar-tools><h3>Summary Editor</h3><span flex></span><md-button class=md-icon-button ng-click=vm.cancel()><md-icon>close</md-icon></md-button></div></md-toolbar><form ng-submit=vm.close()><md-dialog-content><!-- material-compliant padding not used since WYSIWYG text editor *is* the UI --><summary-editor ng-model=vm.summary></summary-editor></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel()>Cancel</md-button><md-button class=md-primary type=submit>Done</md-button></md-dialog-actions></form></md-dialog>"),t.put("app/components/summary-editor/summary-editor.html","<div ckeditor ng-model=summary></div>"),t.put("app/zotero/test/test.html","<div layout=column flex><md-content><zotero-editor item=vm.item types=vm.types></zotero-editor></md-content></div>"),t.put("app/admin/editors/articles/article-editor.html",'<form flex layout=column layout-padding><!-- title editor bar --><md-content layout=row><md-input-container flex=60 layout-sm=column layout-align="begin end"><label>Title</label><input type=text ng-model=vm.article.title></md-input-container><section flex=40 layout=row layout-sm=column layout-align="end center" layout-wrap><md-button class=md-raised ng-click=vm.cancel()>Cancel</md-button><md-button class="md-raised md-primary" ng-click=vm.save()>Save</md-button></section></md-content><!-- TODO add space for authors --><!-- TODO add save button and auto-save --><!-- TODO add sidebar for notes, biblio, links, etc --><div id=article_editor flex layout=column><div ng-model=vm.article.body ckeditor=vm.editor.config ckeditor-bibliography=vm.references ckeditor-footnotes=vm.article.footnotes></div><md-tabs flex><md-tab label=Abstract><div ckeditor=vm.abstractEditor.config ng-model=vm.article.abstract></div></md-tab><md-tab label=Bibliography><bibliography collection=vm.references></bibliography></md-tab><md-tab label=Footnotes><div class=footnotes ng-repeat="footnote in vm.article.footnotes" layout=row><div class=footnote ng-bind-html=footnote.content flex></div><md-button class=md-icon-button aria-label="edit footnote" ng-click="vm.editFootnote($event, footnote)"><md-icon>edit</md-icon><md-tooltip>Edit Footnote</md-tooltip></md-button></div></md-tab></md-tabs></div><!-- TODO how to make this fill all available space --></form>'),t.put("app/admin/editors/articles/article.html",'<md-content flex layout=column><navbar title=Articles sidenav-id=left></navbar><md-content flex layout=row><md-sidenav md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" layout=column><md-tabs flex><md-tab><md-tab-label><md-icon>format_list_bulleted</md-icon><md-tooltip md-direction=bottom>Thematic Overviews</md-tooltip></md-tab-label><md-tab-body><tree-categorization-editor scope-id=sda scheme=overviews></tree-categorization-editor></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>book</md-icon><md-tooltip md-direction=bottom>Book Reviews</md-tooltip></md-tab-label><md-tab-body></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>person</md-icon><md-tooltip md-direction=bottom>Biographies</md-tooltip></md-tab-label><md-tab-body></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>school</md-icon><md-tooltip md-direction=bottom>Scholarly Articles</md-tooltip></md-tab-label><md-tab-body></md-tab-body></md-tab></md-tabs></md-sidenav><md-content flex layout=column ui-view></md-content><md-fab-speed-dial md-direction=up class="md-scale md-fab-bottom-right"><md-fab-trigger><md-button aria-label=New... class=md-fab><md-icon>add</md-icon></md-button></md-fab-trigger><md-fab-actions><md-button aria-label="New Article" class="md-fab md-mini" ng-click=vm.createArticle($event)><md-tooltip md-direction=left>New Article</md-tooltip><md-icon>description</md-icon></md-button></md-fab-actions></md-fab-speed-dial></md-content></md-content>'),t.put("app/admin/editors/articles/thematic-overview.html",'<div id=thematic_overviews><script type=text/ng-template id=treeCategoryEntry.html><div class="category-node" layout="row" layout-align="start center">\n     <!--  Display label for the category node-->\n     <span ng-if="node.entryRef == null" class="node-label">{{ node.label }}</span>\n     <a ui-sref="article.edit({id:node.entryRef.id})" ng-if="node.entryRef != null" class="node-label">{{ node.label }}</a>\n\n     <!-- push buttons to edge -->\n     <span flex></span>\n\n     <!-- node action menu -->\n     <md-menu class="action">\n       <!-- activate handle -->\n       <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button">\n         <md-icon>arrow_drop_down</md-icon>\n       </md-button>\n\n       <md-menu-content>\n         <!-- Associate/Remove  -->\n         <md-menu-item>\n           <md-button ng-if="node.entryRef.id == null"\n                      ng-click="vm.handleAssociateEntry($event, node)">\n             <md-icon>add_circle_outline</md-icon>\n             Create Article\n           </md-button>\n           <md-button ng-if="node.entryRef.id != null"\n                      ng-click="vm.handleRemoveEntry($event, node)">\n             <md-icon>remove_circle_outline</md-icon>\n             Remove Article\n           </md-button>\n         </md-menu-item>\n\n         <md-menu-item>\n           <md-button ng-click="vm.handleCreateChild($event, node)">\n             <!-- Will create a child node at the end of this list. User can drag to re-arrange -->\n             <md-icon>create_new_folder</md-icon>\n             Create Sub-Category\n           </md-button>\n         </md-menu-item>\n\n         <md-menu-item>\n           <md-button ng-click="vm.handleDeleteNode($event, node, parent)">\n             <!-- Will delete this node, all children and associated articles. If leaf node,\n             displays delete instead of delete sweep. Prompts user to confirm. -->\n             <md-icon>delete{{ node.children.length == 0 ? \'\' : \'_sweep\' }}</md-icon>\n             Remove Category\n           </md-button>\n         </md-menu-item>\n       </md-menu-content>\n     </md-menu>\n   </div>\n\n   <ol ng-if="node.children.length > 0">\n     <li ng-repeat="node in node.children" ng-include="\'treeCategoryEntry.html\'" ng-init="parent = $parent.$parent.node"></li>\n   </ol></script><ol><li ng-repeat="node in vm.overviews.root.children" ng-include="\'treeCategoryEntry.html\'" ng-init="parent = vm.overviews.root"></li></ol><div layout=row layout-align="center center"><!-- TODO need additional styling --><md-button ng-click="vm.handleCreateChild($event, vm.overviews.root)" class=md-raised aria-label="create category">Create Category</md-button></div></div>'),t.put("app/person/components/event-editor/event-editor.html","<div layout=column><div layout=row><md-input-container flex><label>location</label><input type=text ng-model=event.location></md-input-container><date-editor ng-model=event.date flex></date-editor></div><div layout=row layout-padding><div flex><h2>Description</h2><div flex ckeditor ng-model=event.description></div></div></div></div>"),t.put("app/person/components/name-editor/name-editor.html","<div layout=column><div layout=row><md-input-container flex=10><label>title</label><input type=text ng-model=name.title></md-input-container><md-input-container flex=30><label>given</label><input type=text ng-model=name.givenName></md-input-container><md-input-container flex=20><label>middle</label><input type=text ng-model=name.middleName></md-input-container><md-input-container flex=30><label>family</label><input type=text ng-model=name.familyName></md-input-container><md-input-container flex=10><label>suffix</label><input type=text ng-model=name.suffix></md-input-container></div><md-input-container><label>display label</label><input type=text ng-model=name.label required></md-input-container></div>"),t.put("app/task/components/edition-editor/edition-editor.html",'<div layout=row><md-input-container flex><label>edition name</label><input type=text ng-model=edition.editionName required></md-input-container></div><section class=publication layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Publication Information</h2></div></md-toolbar><publication-info-editor ng-model=edition.publicationInfo flex></publication-info-editor></section><section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=edition.titles.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat="title in edition.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="edition.titles.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=edition.authors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat="author in edition.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="edition.authors.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><h2>Summary</h2><summary-editor ng-model=edition.summary flex></summary-editor></section><section class=volumes><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Volumes</h2><span flex></span><md-button class=md-icon-button ng-click=vm.createVolume()><md-icon>add</md-icon></md-button></div></md-toolbar><md-whiteframe class=volume layout=column layout-margin ng-repeat="volume in vm.volumes" ng-class="{\'md-whiteframe-2dp\': !volume.focused, \'md-whiteframe-8dp\': volume.focused}"><h3 layout=row><div flex layout=row layout-align="start center" ng-click="volume.focused = !volume.focused"><md-icon>{{ edition.focused ? \'expand_less\' : \'expand_more\'}}</md-icon><span>Volume {{volume.model.volumeNumber}}</span> <span flex></span></div><md-button class="md-icon-button md-warn" ng-click=vm.deleteVolume($index)><md-icon>delete</md-icon></md-button></h3><div slide-toggle=volume.focused><volume-editor ng-model=volume.model flex></volume-editor></div></md-whiteframe></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=edition.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat="copy in edition.copies"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class="md-icon-button md-warn" ng-click="edition.copies.splice($index, 1)"><md-icon>delete</md-icon></md-button></div></div></section>'),t.put("app/task/components/volume-editor/volume-editor.html",'<div layout=row><md-input-container flex><label>volume number</label><input type=text ng-model=volume.volumeNumber required></md-input-container></div><section class=publication layout=column><h2>Publication Information</h2><publication-info-editor ng-model=volume.publicationInfo></publication-info-editor></section><section class=titles layout=column><h2 layout=row><span flex>Titles</span><md-button class=md-icon-button ng-click=volume.titles.push({})><md-icon>add</md-icon></md-button></h2><div class=title layout=row ng-repeat="title in volume.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="volume.titles.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><h2 layout=row><span flex>Authors</span><md-button class=md-icon-button ng-click=volume.authors.push({})><md-icon>add</md-icon></md-button></h2><div class=author layout=row ng-repeat="author in volume.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="volume.authors.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><h2>Summary</h2><summary-editor ng-model=volume.summary flex></summary-editor></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=volume.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat="copy in volume.copies"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class="md-icon-button md-warn" ng-click="volume.copies.splice($index, 1)"><md-icon>delete</md-icon></md-button></div></div></section>'),t.put("app/task/components/work-editor/work-editor.html",'<section class=titles layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Titles</h2><span flex></span><md-button class=md-icon-button ng-click=work.titles.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=title layout=row ng-repeat="title in work.titles"><title-editor ng-model=title flex></title-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="work.titles.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=authors layout=column><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Authors</h2><span flex></span><md-button class=md-icon-button ng-click=work.authors.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=author layout=row ng-repeat="author in work.authors"><author-ref-editor ng-model=author flex></author-ref-editor><md-input-container><md-button class="md-icon-button md-warn" ng-click="work.authors.splice($index, 1)"><md-icon>delete</md-icon></md-button></md-input-container></div></section><section class=summary><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Summary</h2></div></md-toolbar><summary-editor ng-model=work.summary flex></summary-editor></section><section class=editions><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Editions</h2><span flex></span><md-button class=md-icon-button ng-click=vm.createEdition()><md-icon>add</md-icon></md-button></div></md-toolbar><md-whiteframe class=edition layout=column layout-margin ng-repeat="edition in vm.editions" ng-class="{ \'md-whiteframe-2dp\': !edition.focused, \'md-whiteframe-8dp\': edition.focused }"><h3 layout=row><div flex layout=row layout-align="start center" ng-click="edition.focused = !edition.focused"><md-icon>{{ edition.focused ? \'expand_less\' : \'expand_more\'}}</md-icon><span>{{edition.model.editionName}}</span> <span flex></span></div><md-button class="md-icon-button md-warn" ng-click=vm.deleteEdition($index)><md-icon>delete</md-icon></md-button></h3><div slide-toggle=edition.focused><edition-editor ng-model=edition.model flex></edition-editor></div></md-whiteframe></section><section class=copies><md-toolbar class=md-hue-3><div class=md-toolbar-tools><h2>Digital Copies</h2><span flex></span><md-button class=md-icon-button ng-click=work.copies.push({})><md-icon>add</md-icon></md-button></div></md-toolbar><div class=copy layout=column ng-repeat="copy in work.copies"><div layout=row><copy-editor ng-model=copy flex></copy-editor><md-button class="md-icon-button md-warn" ng-click="work.copies.splice($index, 1)"><md-icon>delete</md-icon></md-button></div></div></section>'),t.put("app/task/components/work-editor-item/work-editor-item.html",'<div layout=row layout-align="center center" ng-if=!vm.loaded><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div ng-if=vm.loaded><work-editor ng-model=vm.work></work-editor></div>'),t.put("app/vwise/components/panel/panel.html",'<div class=panel ng-class="{ resizing: vm.resizing }" ng-style="{ left: vp.xPosition, top: vp.yPosition, zIndex: vp.zPosition, width: vp.width, height: vp.height }" jqyoui-draggable="{ onDrag: \'vm.movePanel()\', onStop: \'vm.stopMove()\' }" ng-click=vm.activatePanel($event) data-jqyoui-options="{ handle: \'.drag-handle\' }" data-drag=true layout=column><div class="panel-control drag-handle" layout=column layout-align="center center"><md-icon>open_with</md-icon></div><button class="panel-control close" ng-click=vm.closePanel($event) layout=column layout-align="center center"><md-icon>close</md-icon></button><div class="panel-control resize-handle" ng-style="{ left: vp.width, top: vp.height }" jqyoui-draggable="{ onStart: \'vm.startResize()\', onDrag: \'vm.resizePanel()\', onStop:\'vm.stopResize()\'}" data-drag=true layout=column layout-align="center center"><md-icon>crop</md-icon></div><div class="panel-control panel-area panel-area-top" layout=row layout-align="end center"><button ng-repeat="button in vm.actionButtons" ng-click=button.handler($event) title={{button.label}} layout=column layout-align="center center"><md-icon ng-if=button.icon>{{button.icon}}</md-icon><span ng-if=!button.icon>{{button.label}}</span></button></div><div class="panel-control panel-area panel-area-right" layout=column layout-align="start center"><button ng-repeat="button in vm.propertyButtons" ng-click=button.handler($event) title={{button.label}} layout=column layout-align="center center"><md-icon ng-if=button.icon>{{button.icon}}</md-icon><span ng-if=!button.icon>{{button.label}}</span></button></div><div class="panel-control panel-area panel-area-bottom"></div><div class="panel-control panel-area panel-area-left"></div><div class=content flex layout=column></div></div>'),t.put("app/vwise/components/person-panel/person-panel.html",'<div class=panel-person flex layout=column><h1><span class="panel-label name">{{name}}</span></h1><md-tabs flex><md-tab ng-if=person.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=person.summary></div></md-tab-body></md-tab><md-tab ng-if="panel.works &amp;&amp; panel.works.length > 0"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in panel.works" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.label}}</div></md-list-item></md-list></md-tab-body></md-tab><md-tab ng-if="panel.relatedPeople &amp;&amp; panel.relatedPeople.length > 0"><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body><div ng-repeat="group in panel.relatedPeople"><h3>{{group.label}}</h3><md-list><md-list-item ng-repeat="item in group.relationships" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.name.label}}</div></md-list-item></md-list></div></md-tab-body></md-tab></md-tabs></div>'),t.put("app/vwise/components/work-panel/edition-panel.html",'<div class=panel-edition flex layout=column><h1><span class=authors><span class=author ng-repeat="author in edition.authors">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span> <span class=edition-name>{{edition.editionName}}.</span></h1><md-tabs flex><md-tab ng-if=edition.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=edition.summary></div></md-tab-body></md-tab><md-tab ng-if="edition.volumes.length > 0"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in edition.volumes" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>Volume {{item.volumeNumber}} ({{item.publicationInfo.date.description}})</div></md-list-item></md-list></md-tab-body></md-tab><md-tab ng-if="edition.copies.length > 0"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in edition.copies" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>'),t.put("app/vwise/components/work-panel/volume-panel.html",'<div class=panel-volume flex layout=column><h1><span class=authors><span class=author ng-repeat="author in volume.authors">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span> <span class=edition-name>{{edition.editionName}}.</span> <span class=volume-name>Volume {{volume.volumeNumber}}.</span></h1><md-tabs flex><md-tab ng-if=volume.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=volume.summary></div></md-tab-body></md-tab><md-tab ng-if="volume.copies.length > 0"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in volume.copies" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>'),t.put("app/vwise/components/work-panel/work-panel.html",'<div class=panel-work flex layout=column><h1><span class=panel-label><span class=authors><span class=author ng-repeat="author in work.authors">{{author.lastName}}. </span></span><span class=title>{{title.title}}<span ng-if=title.subtitle>: {{title.subtitle}}</span>.</span></span></h1><md-tabs flex><md-tab ng-if=work.summary><md-tab-label><md-icon>subject</md-icon></md-tab-label><md-tab-body><div class=summary ng-bind-html=work.summary></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body><div ng-repeat="group in relationships"><h3>{{group.label}}</h3><md-list><div ng-repeat="relationship in group.relationships"><md-list-item ng-repeat="item in relationship.entities" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text><span class=authors><span class=author ng-repeat="author in item.entity.authors">{{author.lastName}}.</span></span> <span class=title>{{item.title.title}}{{item.title.subtitle ? \': \' : \'\'}}<span ng-if=item.title.subtitle class=subtitle>{{item.title.subtitle}}</span></span></div></md-list-item></div></md-list></div></md-tab-body></md-tab><md-tab ng-if="work.editions.length > 0"><md-tab-label><md-icon>content_copy</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in work.editions" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.editionName}} ({{item.publicationInfo.date.description}})</div></md-list-item></md-list></md-tab-body></md-tab><md-tab ng-if="work.copies.length > 0"><md-tab-label><md-icon>book</md-icon></md-tab-label><md-tab-body><md-list><md-list-item ng-repeat="item in work.copies" jqyoui-draggable={animate:false} data-jqyoui-options="{revert:\'invalid\',helper:\'clone\',appendTo:\'body\'}" data-drag=true><div class=md-list-item-text>{{item.title}}</div></md-list-item></md-list></md-tab-body></md-tab></md-tabs></div>'),t.put("app/vwise/components/workspace/workspace.html",'<div flex jqyoui-droppable="{stack: true, onDrop:\'vm.thingDropped()\'}" data-drop=true class=workspace ng-click=vm.workspaceClicked($event)><vwise-panel ng-repeat="panel in workspace.panels track by panel.id" panel=panel></vwise-panel></div>'),t.put("app/work/components/author-ref-editor/author-ref-editor.html",'<div layout=column><div layout=row><md-autocomplete required md-items="item in vm.authorRoles" md-item-text=role md-min-length=0 md-search-text=ref.role md-selected-item-change="ref.role = item" md-floating-label=role><md-item-template><span md-highlight-text=ref.role>{{item}}</span></md-item-template></md-autocomplete><md-input-container flex><label>first name</label><input type=text ng-model=ref.firstName></md-input-container><md-input-container flex><label>last name</label><input type=text ng-model=ref.lastName></md-input-container></div><div layout=row><md-autocomplete flex md-items="person in vm.getResults(vm.linkAuthorSearchText)" md-item-text=person.label md-search-text=vm.linkAuthorSearchText md-search-text-change=vm.searchPeople(vm.linkAuthorSearchText) md-selected-item-change=vm.setLinkedAuthor(person) md-floating-label="linked author"><span md-highlight-text=vm.linkAuthorSearchText>{{person.label}}</span></md-autocomplete></div></div>'),t.put("app/work/components/copy-editor/copy-editor.html",'<ng-form name=copyForm layout=column flex><md-input-container><label for=title>Title</label><input type=text name=title id=title ng-model=copy.title></md-input-container><div layout=row><md-input-container><label for=type>Type</label><md-select name=type id=type ng-model=copy.type required ng-change="vm.setProperties(copy.type, copyUrl)"><md-option ng-repeat="handler in vm.refHandlers" value={{handler.id}}>{{handler.display}}</md-option></md-select></md-input-container><md-input-container flex><label for=url>URL</label><input type=url name=url id=url ng-model=copyUrl ng-change="vm.setProperties(copy.type, copyUrl)"></md-input-container></div><ul class="properties properties-inline"><li ng-repeat="(key, value) in copy.properties"><span class=label>{{key}}</span> <span class=value>{{value}}</span></li></ul><md-input-container><label for=rights>Description of Rights</label><input type=text name=rights id=rights ng-model=copy.rights></md-input-container><h3>Summary</h3><summary-editor ng-model=copy.summary flex></summary-editor></ng-form>'),t.put("app/work/components/publication-info-editor/publication-info-editor.html","<div layout=row><md-input-container flex><label>publisher</label><input type=text ng-model=pubInfo.publisher></md-input-container><md-input-container flex><label>location</label><input type=text ng-model=pubInfo.place></md-input-container><date-editor ng-model=pubInfo.date flex></date-editor></div>"),t.put("app/work/components/title-editor/title-editor.html","<div layout=row><md-input-container><label>type</label><md-select ng-model=title.type required><md-option value=bibliographic>bibliographic</md-option><md-option value=canonical>canonical</md-option><md-option value=short>short</md-option></md-select></md-input-container><md-input-container flex><label>title</label><input type=text ng-model=title.title required><div ng-switch=title.type><small ng-switch-when=bibliographic>the full title as published on the work</small> <small ng-switch-when=canonical>title by which the work is commonly known in the academic realm</small> <small ng-switch-when=short>shortened title coloquially used by the public</small></div></md-input-container><md-input-container flex><label>subtitle</label><input type=text ng-model=title.subtitle></md-input-container></div>")}]);
//# sourceMappingURL=../maps/scripts/app-ccd86a51f1.js.map
