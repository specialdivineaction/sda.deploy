{"version":3,"sources":["scripts/app.js"],"names":["angular","module","peopleRepoProvider","peopleRepoFactory","$q","$resource","createPerson","person","restResource","adaptPerson","createMeta","meta","adaptMeta","createName","name","adaptName","createEvent","evt","adaptEvent","createDateDescription","dateDescription","findById","id","get","search","query","q","savePerson","response","update","save","$promise","then","personId","deletePerson","altNames","forEach","birth","death","links","date","provider","url","method","repo","create","$inject","$get","trcPersonEditorDirective","PersonEditorController","$scope","peopleRepo","addName","newName","push","removeName","ix","splice","addEvent","key","newEvent","removeEvent","vm","this","directive","restrict","templateUrl","scope","controller","controllerAs","trcNameEditorDirective","NameEditorController","roles","value","label","trcEventEditorDirective","event","graphRepoProvider","graphRepoFactory","getGraph","type","MainController","$http","$mdToast","$location","$stateParams","worksRepo","graphRepo","activate","defaultGraphType","graphType","graphLoading","getGraphData","showSimple","data","graph","$watch","node","loaded","loadNodeData","makeTypeGroup","group","directed","out","title","nodes","reverseTitle","none","ensureTypeGroup","related","hasOwnProperty","works","searchByAuthor","worksP","items","Error","TYPES","uk.ac.ox.bodleian.sda.relationships.influence","uk.ac.ox.bodleian.sda.relationships.provoked","uk.ac.ox.bodleian.sda.relationships.consonance","uk.ac.ox.bodleian.sda.relationships.patternmatch","outEdges","map","edge","relation","target","inEdges","source","all","nodesById","edges","activeNode","worksRepoProvider","worksRepoFactory","findAll","max","authorId","aid","getWork","workId","isUndefined","TypeError","work","adaptWork","getEdition","editionId","edition","editionResource","adaptEdition","getVolume","volumeId","volume","volumeResource","adaptVolume","createWork","titles","authors","createEdition","createVolume","arguments","length","saveWork","apply","saveEdition","saveVolume","$update","$save","deleteWork","dataItem","adaptCommon","entity","toLowerCase","author","role","otherAuthors","copies","editions","volumes","getTitleByTypePreference","types","isArray","reduce","found","i","getAll","getTitle","conceptBrowserDirective","$window","$timeout","linkFunc","el","width","autoWidth","height","autoHeight","layout","rootEl","ConceptBrowser","size","refresh","element","on","oldWidth","oldHeight","preventActivate","$apply","$watchGroup","newValues","oldValues","queueRefresh","graphData","copy","padding","link","runBlock","$log","debug","run","routerConfig","$stateProvider","$urlRouterProvider","state","otherwise","config","constant","d3","moment","$logProvider","$mdThemingProvider","debugEnabled","definePalette","50","100","200","300","400","500","600","700","800","900","A100","A200","A400","A700","contrastDefaultColor","contrastDarkColors","theme","primaryPalette","accentPalette","root","factory","define","amd","exports","EventDispatcher","trigger","eventName","context","eventHandlers","handler","e","console","error","globalHandlers","addGlobalListener","indexOf","addListener","addOnceListener","deregister","API","once","require","dragstart","d","fixed","dragend","mouseover","px","x","py","y","mouseout","accumulate","quad","alpha","charges","cx","cy","charge","leaf","c","n","point","Math","random","k","index","pointCharge","isFunction","o","isNumber","LINK_DISTANCE","LINK_STRENGTH","CHARGE_DISTANCE_2","Infinity","force","cylindrical","wrapDx","dx","abs","repulse","x1","_","x2","dy","dw","dn","theta2","chargeDistance2","dragmove","resume","drag","distances","strengths","dispatch","friction","linkDistance","linkStrength","gravity","tick","end","s","t","l","m","sqrt","weight","geom","quadtree","visit","chargeDistance","theta","start","timer","position","dimension","neighbors","Array","j","candidates","cs","isNaN","w","h","call","stop","behavior","origin","edgePath","getX1","getY1","getX2","getY2","drawLine","selection","attr","y1","y2","fn","rebind","options","setSize","dims","isInitialized","svg","progressScale","range","setData","_nodes","_edges","setActivated","deselectAll","select","initialize","bindNodes","bindEdges","scalePageRank","pow","append","edgeTypes","defineArrowheads","baseGroup","edgeLayer","nodeLayer","progressBar","scale","linear","domain","log","nodeRadiusScale","NODE_MIN_SIZE","NODE_MAX_SIZE","GRAPH_LAYOUT_CTORS","configureGraph","drawEdge","tip","tooltip","TIP_CSS_CLASS","direction","tooltipDirection","offset","tooltipOffset","html","events","showTooltip","hideTooltip","updateEgoGraphs","pagerank","extractPagerank","chargeRange","influenceRange","updatePositions","selectAll","transition","duration","nodeSelect","nodeEnter","enter","focus","blur","ctrlKey","selected","deselect","exit","remove","edgeSelect","style","multiplicity","metadata","focused","activated","deactivate","show","hide","isNodeActivated","isNodeSelected","isNodeFocused","isEdgeActivated","isEdgeSelected","isEdgeFocused","classed","some","cls","min","dir","TIP_POSITION_MARGIN","bottom","top","right","left","radius","left_right","classTypes","arrowTypes","planar","warn","$templateCache","put"],"mappings":"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","file":"scripts/app-77e506adb0.js","sourcesContent":["(function () {\n  'use strict';\n\n  angular\n    .module('trcBio', [\n      'ngResource'\n    ]);\n\n})();\n\n/**\n * Data model representing a person returned by the TRC REST API\n * @typedef Person\n * @type {object}\n * @property {string}           id       - a unique identifier for this person; assigned upon creation\n * @property {EntryMeta}        meta     - metadata about the record and its history in the system\n * @property {PersonName}       name     - primary name used to identify this person\n * @property {PersonName[]}     altNames - other names by which this person is known\n * @property {?HistoricalEvent} birth    - the date and location this person was born; may be null if unknown\n * @property {?HistoricalEvent} death    - the date and location this person was born; may be null if unknown or still alive\n * @property {string}           summary  - an HTML summary of the person and his or her significance\n */\n\n/**\n * Simplified, lightweight representation of a person for use in search results\n * @typedef Person\n * @type {object}\n * @property {string}     id             - a unique identifier for the person\n * @property {EntryMeta}  meta           - metadata about the record and its history in the system\n * @property {PersonName} name           - structured name representation\n * @property {string}     label          - formatted name to display\n * @property {string}     summaryExcerpt - a leading excerpt from the full summary\n */\n\n/**\n * Metadata about a TRC entry\n * @typedef EntryMeta\n * @type {object}\n * @property {string}                      slug         - a short, unique identifier intended to be more human-readable than the id\n * @property {integer}                     version      - a monotonically increasing version number incremented on each change\n * @property {object.<string, SimpleLink>} links        - links to related resources; keyed by link role\n * @property {string}                      lastModified - ISO 8601 timestamp of the last modification date\n */\n\n/**\n * Container for linking to related entities\n * @typedef SimpleLink\n * @type {object}\n * @property {string} uri  - a URI representing the linked item\n * @property {string} type - MIME type of the related linked item\n */\n\n/**\n * Structured form of a person's name\n * @typedef PersonName\n * @type {object}\n * @property {string} role        - clarifies the use of this name\n * @property {string} label       - a simple representation of this name for display purposes\n * @property {?string} title      - title of address\n * @property {?string} givenName  - given or first name\n * @property {?string} middleName - middle name\n * @property {?string} familyName - family or last name\n * @property {?string} suffix     - a suffix (e.g. 'Jr' or 'III')\n */\n\n/**\n * Event with a date/time, location, and descriptive information\n * @typedef HistoricalEvent\n * @type {object}\n * @property {string}          id          - a unique identifier for this event\n * @property {string}          title       - a brief title of the event for display purposes\n * @property {string}          description - a detailed summary of the event\n * @property {string}          location    - the location in which the event took place\n * @property {DateDescription} date        - the date the event took place\n */\n\n/**\n * Container for encapsulating human-readable and machine-readable forms of a date.\n * @typedef DateDescription\n * @type {object}\n * @property {string} calendar    - machine-readable ISO 8601 timestamp\n * @property {string} description - human-readable description of this date\n */\n\n/**\n * Container for search results\n * @typedef PersonSearchResultSet\n * @type {object}\n * @property {SimplePerson[]} items  - search results\n * @property {string}         qs     - query string that gives the current set of search results\n * @property {?string}        qsNext - query string that gives next set of search results or null if this is the last set\n * @property {?string}        qsPrev - query string that gives preceding set of search results or null if this is the first set\n */\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .provider('peopleRepo', peopleRepoProvider);\n\n\n  function peopleRepoProvider() {\n    var provider = {};\n    provider.url = '/api/people';\n    provider.$get = peopleRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function peopleRepoFactory($q, $resource) {\n      var restResource = $resource(provider.url + '/:id', null, {\n        'update': { method: 'PUT' }\n      });\n\n      var repo = {};\n      repo.create = createPerson;\n      repo.createName = createName;\n      repo.createEvent = createEvent;\n      repo.get = findById;\n      repo.search = search;\n      repo.save = savePerson;\n      repo.delete = deletePerson;\n      return repo;\n\n      /**\n       * Creates a new empty person instance.\n       *\n       * @return {Person}\n       */\n      function createPerson() {\n        var person = new restResource();\n        return adaptPerson(person);\n      }\n\n      /**\n       * Creates a new empty entry metadata instance\n       *\n       * @return {EntryMeta}\n       */\n      function createMeta() {\n        var meta = {};\n        return adaptMeta(meta);\n      }\n\n      /**\n       * Creates a new empty name instance\n       *\n       * @return {PersonName}\n       */\n      function createName() {\n        var name = {};\n        return adaptName(name);\n      }\n\n      /**\n       * Creates a new historical event instance\n       *\n       * @return {HistoricalEvent}\n       */\n      function createEvent() {\n        var evt = {};\n        return adaptEvent(evt);\n      }\n\n      /**\n       * Creates a date/description instance\n       *\n       * @return {DateDescription}\n       */\n      function createDateDescription() {\n        var dateDescription = {};\n        return dateDescription;\n      }\n\n      /**\n       * Retrieves a person object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promise is available on Person.$promise.\n       *\n       * @param  {string} id\n       * @return {Person}\n       */\n      function findById(id) {\n        return restResource.get({ id: id });\n      }\n\n      /**\n       * Retrieves a serch result set of people who match the given query.\n       *\n       * @param {string} query\n       * @return {PersonSearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query });\n      }\n\n      /**\n       * Saves a person model to the REST API.\n       *\n       * If no ID is provided on the person model, the API will create save the model as a new\n       * person. Otherwise, the API will attempt to update the existing person model with that ID.\n       *\n       * @param {Person} person\n       * @return {Promise.<Person>} - resolves to the saved person on success\n       */\n      function savePerson(person) {\n        var response;\n        if (person.id) {\n          response = restResource.update({ id: person.id }, person);\n        } else {\n          response = restResource.save(null, person);\n        }\n\n        return response.$promise.then(function (personId) {\n          person.id = personId.id;\n          return person;\n        });\n      }\n\n      /**\n       * Deletes a person on the server via the REST API.\n       *\n       * @param {Person|string} idOrPerson\n       * @return {Promise} - resolves on success\n       */\n      function deletePerson(id) {\n        var response = restResource.delete({ id: id });\n        return response.$promise;\n      }\n\n      /**\n       * Populates a person with aggregate fields\n       *\n       * @param  {Person} person\n       * @return {Person}\n       */\n      function adaptPerson(person) {\n        if (!person.meta) {\n          person.meta = createMeta();\n        } else {\n          adaptMeta(person.meta);\n        }\n\n        if (!person.name) {\n          person.name = createName();\n        } else {\n          adaptName(person.name);\n        }\n\n        if (!person.altNames) {\n          person.altNames = [];\n        } else {\n          person.altNames.forEach(adaptName);\n        }\n\n        if (!person.birth) {\n          person.birth = createEvent();\n        } else {\n          adaptEvent(person.birth);\n        }\n\n        if (!person.death) {\n          person.death = createEvent();\n        } else {\n          adaptEvent(person.death);\n        }\n\n        return person\n      }\n\n      /**\n       * Ensure that entry metadata aggregate fields exist and are formatted correctly.\n       *\n       * @param  {EntryMeta} meta\n       * @return {EntryMeta}\n       */\n      function adaptMeta(meta) {\n        if (!meta.links) {\n          meta.links = {};\n        }\n\n        return meta;\n      }\n\n      /**\n       * Ensure that name aggregate fields exist and are formatted correctly\n       * @param  {PersonName} name\n       * @return {PersonName}\n       */\n      function adaptName(name) {\n        // no aggregate fields yet...\n        return name;\n      }\n\n      /**\n       * Ensure that event aggregate fields exist and are formatted correctly.\n       *\n       * @param  {HistoricalEvent} evt\n       * @return {HistoricalEvent}\n       */\n      function adaptEvent(evt) {\n        if (!evt.date) {\n          evt.date = createDateDescription();\n        }\n\n        return evt;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcPersonEditor', trcPersonEditorDirective);\n\n  /** @ngInject */\n  function trcPersonEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/person-editor.html',\n      scope: {\n        person: '=ngModel'\n      },\n      controller: PersonEditorController,\n      controllerAs: 'personEditor'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function PersonEditorController($scope, peopleRepo) {\n      var vm = this;\n\n      vm.addName = addName;\n      vm.removeName = removeName;\n      vm.addEvent = addEvent;\n      vm.removeEvent = removeEvent;\n\n      /**\n       * Adds a name to the current person model.\n       */\n      function addName() {\n        var newName = peopleRepo.createName();\n        $scope.person.altNames.push(newName);\n      }\n\n      /**\n       * Removes the name at the specified index from the current person model.\n       *\n       * @param {integer} ix\n       */\n      function removeName(ix) {\n        $scope.person.altNames.splice(ix, 1);\n      }\n\n      /**\n       * Adds an event to the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function addEvent(key) {\n        var newEvent = peopleRepo.createEvent();\n        $scope.person[key] = newEvent;\n      }\n\n      /**\n       * Removes the event from the current person model.\n       *\n       * @param {string} key - 'birth' or 'death'\n       */\n      function removeEvent(key) {\n        $scope.person[key] = null;\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcNameEditor', trcNameEditorDirective);\n\n  /** @ngInject */\n  function trcNameEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/name-editor.html',\n      scope: {\n        name: '=ngModel'\n      },\n      controller: NameEditorController,\n      controllerAs: 'nameEditor'\n    };\n\n    return directive;\n\n    function NameEditorController() {\n      var vm = this;\n\n      vm.roles = [\n        { value: 'canonical', label: 'Canonical Name' },\n        { value: 'pseudonym', label: 'Pseudonym' },\n        { value: 'maiden', label: 'Maiden Name' },\n        { value: 'designation', label: 'Honorary Designation' },\n        { value: 'nickname', label: 'Nickname' },\n        { value: 'phonetic', label: 'Phonetic Name' }\n      ];\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBio')\n    .directive('trcEventEditor', trcEventEditorDirective);\n\n  /** @ngInject */\n  function trcEventEditorDirective() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/trc-bio/event-editor.html',\n      scope: {\n        event: '=ngModel'\n      }\n    };\n\n    return directive;\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcGraph', [\n      'ngResource'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcGraph')\n    .provider('graphRepo', graphRepoProvider);\n\n  function graphRepoProvider() {\n    var provider = {};\n    provider.url = '/api/graph';\n    provider.$get = graphRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function graphRepoFactory($resource) {\n      var restResource = $resource(provider.url + '/:type');\n\n      var repo = {};\n      repo.get = getGraph;\n      return repo;\n\n      /**\n       * Retrieves a graph by type identifier\n       *\n       * @param  {string} type\n       * @return {Graph}\n       */\n      function getGraph(type) {\n        return restResource.get({ type: type });\n      }\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser', [\n      'ngAnimate',\n      'ngCookies',\n      'ngSanitize',\n      'ngMessages',\n      'ngAria',\n      'ngResource',\n      'ui.router',\n      'ngMaterial',\n      'trcBiblio',\n      'trcBio',\n      'trcGraph'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController($http, $scope, $q, $mdToast, $location, $stateParams, peopleRepo, worksRepo, graphRepo) {\n    var vm = this;\n\n    vm.graph = null;\n    vm.activeNode = null;\n    vm.person = null;\n    vm.works = null;\n    vm.related = null;\n    vm.loaded = true;\n    vm.graphLoading = true;\n\n    activate();\n\n    function activate() {\n      var defaultGraphType = 'people';\n      var graphType = $stateParams.type || defaultGraphType;\n      vm.graphLoading = false;\n      getGraphData(graphType).catch(function () {\n        $mdToast.showSimple('Unable to load the \"' + graphType + '\"graph type. Falling back to \"' + defaultGraphType + '\".');\n        return getGraphData(defaultGraphType);\n      }).then(function (data) {\n        vm.graphLoading = false;\n        vm.graph = data.graph;\n      }, function () {\n        vm.graphLoading = true;\n        $mdToast.showSimple('Unable to load graph data.');\n      });\n\n      $scope.$watch('main.activeNode', function (node) {\n        if (node) {\n          vm.loaded = false;\n          loadNodeData(node).then(function () {\n            vm.loaded = true;\n          }, function () {\n            $mdToast.showSimple('Unable to load data.');\n          });\n        } else {\n          vm.person = null;\n        }\n      });\n    }\n\n    function loadNodeData(node) {\n      // HACK only works for people; should probably refactor to a directive with parallel one for works,\n      //      but how should we determine which directive to display?\n      vm.person = peopleRepo.get(node.id);\n\n      var works = worksRepo.searchByAuthor(node.id);\n      var worksP = works.$promise.then(function () {\n        if (!works.items) {\n          throw new Error('unable to load items');\n        }\n\n        vm.works = works.items;\n        return vm.works;\n      });\n\n      // HACK types should be loaded from reln repo\n      var TYPES = {\n        'uk.ac.ox.bodleian.sda.relationships.influence': {\n          id: 'uk.ac.ox.bodleian.sda.relationships.influence',\n          title: 'Influenced',\n          reverseTitle: 'Influenced By',\n          directed: true\n        },\n        'uk.ac.ox.bodleian.sda.relationships.provoked': {\n          id: 'uk.ac.ox.bodleian.sda.relationships.provoked',\n          title: 'Provoked',\n          reverseTitle: 'Provoked By',\n          directed: true\n        },\n        'uk.ac.ox.bodleian.sda.relationships.consonance': {\n          id: 'uk.ac.ox.bodleian.sda.relationships.consonance',\n          title: 'Consonance',\n          directed: false\n        },\n        'uk.ac.ox.bodleian.sda.relationships.patternmatch': {\n          id: 'uk.ac.ox.bodleian.sda.relationships.patternmatch',\n          title: 'Possible Pattern Match',\n          directed: false\n        }\n      };\n\n      var related = {};\n\n      function makeTypeGroup(type) {\n        var group = { id: type.id, directed: type.directed };\n\n        if (type.directed) {\n          group.out = { label: type.title, nodes: [] };\n          group.in = { label: type.reverseTitle, nodes: [] };\n        } else {\n          group.none = { label: type.title, nodes: [] };\n        }\n\n        return group;\n      }\n\n      function ensureTypeGroup(type) {\n        if (!related.hasOwnProperty(type.id)) {\n          related[type.id] = makeTypeGroup(type);\n        }\n\n        return related[type.id];\n      }\n\n      node.outEdges.map(function (edge) {\n        var type = TYPES[edge.relation];\n        if (!type) return;\n\n        var group = ensureTypeGroup(type);\n        group[type.directed ? 'out' : 'none'].nodes.push(edge.target);\n      });\n\n      node.inEdges.map(function (edge) {\n        var type = TYPES[edge.relation];\n        if (!type) return;\n\n        var group = ensureTypeGroup(type);\n        group[type.directed ? 'in' : 'none'].nodes.push(edge.source);\n      });\n\n      vm.related = [];\n      for (var key in related) if (related.hasOwnProperty(key)) {\n        vm.related.push(related[key]);\n      }\n\n      return $q.all([vm.person.$promise, worksP]);\n    }\n\n    function getGraphData(type) {\n      var graph = graphRepo.get(type);\n\n      return graph.$promise.then(function () {\n        var nodesById = {};\n\n        // index nodes by ID; prepare structure for dereferencing\n        graph.graph.nodes.forEach(function (node) {\n          node.inEdges = [];\n          node.outEdges = [];\n\n          nodesById[node.id] = node;\n        });\n\n        // dereference edges\n        // edge direction plays an opposite role in the view than it does in the server data:\n        //    suppose A provoked B, C, and D\n        //    we would like to draw arrows from A to B, C, and D (A->B, A->C, A->D)\n        //    but for analytical purposes, the data treats provocation as references from B, C, and D back to A (B->A, C->A, D->A)\n        graph.graph.edges.forEach(function (edge) {\n          var target = nodesById[edge.source];\n          var source = nodesById[edge.target];\n\n          edge.source = source;\n          source.outEdges.push(edge);\n\n          edge.target = target;\n          target.inEdges.push(edge);\n        });\n\n        return graph;\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBiblio', [\n      'ngResource'\n    ]);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('trcBiblio')\n    .provider('worksRepo', worksRepoProvider);\n\n  /**\n   * This functionality is already being implemented as a standalone trc-biblio module. The code is\n   * used here as an interim until the Bower build/dependency workflow has been finalized.\n   *\n   * @return {angular.provider}\n   */\n  function worksRepoProvider() {\n    var provider = {};\n    provider.url = '/api/works';\n    provider.$get = worksRepoFactory;\n    return provider;\n\n    /** @ngInject */\n    function worksRepoFactory($resource) {\n      var restResource = $resource(provider.url + '/:workId', { workId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var editionResource = $resource(provider.url + '/:workId/editions/:editionId', { editionId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var volumeResource = $resource(provider.url + '/:workId/editions/:editionId/volumes/:volumeId', { volumeId: '@id' }, {\n        update: {\n          method: 'PUT'\n        }\n      });\n\n      var repo = {};\n      repo.getAll = findAll;\n      repo.search = search;\n      repo.searchByAuthor = searchByAuthor;\n      repo.get = getWork;\n      repo.getWork = getWork;\n      repo.getEdition = getEdition;\n      repo.getVolume = getVolume;\n      repo.create = createWork;\n      repo.createWork = createWork;\n      repo.createEdition = createEdition;\n      repo.createVolume = createVolume;\n      repo.save = save;\n      repo.saveWork = saveWork;\n      repo.saveEdition = saveEdition;\n      repo.saveVolume = saveVolume;\n      repo.delete = deleteWork;\n      repo.getTitle = getTitleByTypePreference;\n      return repo;\n\n      /**\n       * Retrieves a listing of all works\n       *\n       * @return {WorkProxy[]}\n       */\n      function findAll() {\n        return search('');\n      }\n\n      /**\n       * Search for works by query\n       *\n       * @return {SearchResultSet}\n       */\n      function search(query) {\n        return restResource.get({ q: query, max: 50 });\n      }\n\n      /**\n       * Search for works by author\n       *\n       * @return {SearchResultSet}\n       */\n      function searchByAuthor(authorId) {\n        return restResource.get({ aid: authorId, max: 50 });\n      }\n\n      /**\n       * Retrieves a work object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Work.$promise.\n       *\n       * @param {string} workId\n       * @return {Work}\n       */\n      function getWork(workId) {\n        if (angular.isUndefined(workId)) {\n          throw new TypeError('Invalid ID provided to getWork');\n        }\n\n        var work = restResource.get({ workId: workId });\n\n        work.$promise.then(adaptWork);\n\n        return work;\n      }\n\n      /**\n       * Retrieves an edition object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Edition.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @return {Edition}\n       */\n      function getEdition(workId, editionId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId)) {\n          throw new TypeError('Invalid IDs provided to getEdition');\n        }\n\n        var edition = editionResource.get({ workId: workId, editionId: editionId });\n\n        edition.$promise.then(adaptEdition);\n\n        return edition;\n      }\n\n      /**\n       * Retrieves a volume object by identifier.\n       *\n       * A proxy object will be returned immediately, and its properties will be populated after the\n       * request succeds. If fine-grained asynchronous handling, etc. is required, the request's\n       * promis is available on Volume.$promise.\n       *\n       * @param {string} workId\n       * @param {string} editionId\n       * @param {string} volumeId\n       * @return {Volume}\n       */\n      function getVolume(workId, editionId, volumeId) {\n        if (angular.isUndefined(workId) || angular.isUndefined(editionId) || angular.isUndefined(volumeId)) {\n          throw new TypeError('Invalid IDs provided to getVolume');\n        }\n\n        var volume = volumeResource.get({ workId: workId, editionId: editionId, volumeId: volumeId });\n\n        volume.$promise.then(adaptVolume);\n\n        return volume;\n      }\n\n      /**\n       * Creates a new work instance\n       *\n       * @return {Work}\n       */\n      function createWork() {\n        var work = new restResource();\n        adaptWork(work);\n        work.titles.push({});\n        work.authors.push({});\n        return work;\n      }\n\n      /**\n       * Creates a new edition instance\n       *\n       * @return {Edition}\n       */\n      function createEdition() {\n        var edition = new editionResource();\n        return adaptEdition(edition);\n      }\n\n      /**\n       * Creates a new volume instance\n       *\n       * @return {Volume}\n       */\n      function createVolume() {\n        var volume = new volumeResource();\n        return adaptVolume(volume);\n      }\n\n      /**\n       * Dispatch method for saving works, editions, and volumes\n       *\n       * @deprecated use saveWork, saveEdition, or saveVolume directly\n       * @return {Promise}\n       */\n      function save() {\n        switch (arguments.length) {\n          case 1: return saveWork.apply(null, arguments);\n          case 2: return saveEdition.apply(null, arguments);\n          case 3: return saveVolume.apply(null, arguments);\n        }\n        throw new TypeError('Unexpected arguments to worksRepo#save');\n      }\n\n      /**\n       * Saves a work instance back to the server\n       *\n       * @param {Work} work\n       * @return {Promise.<Work>}\n       */\n      function saveWork(work) {\n        if (!(work instanceof restResource)) {\n          throw new Error('work was not created by this repo');\n        }\n\n        // ngResource automatically updates the model to reflect any server changes (e.g. setting IDs for the work/edtions/volumes/copies).\n        return work.id\n          ? work.$update()\n          : work.$save();\n      }\n\n      /**\n       * Saves an edition instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {Edition} edition\n       * @return {Promise.<Edition>}\n       */\n      function saveEdition(workId, edition) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!(edition instanceof editionResource)) {\n          throw new Error('edition was not created by this repo');\n        }\n\n        return edition.id\n          ? edition.$update({ workId: workId })\n          : edition.$save({ workId: workId });\n      }\n\n      /**\n       * Saves a volume instance back to the server\n       *\n       * @param  {string} workId\n       * @param  {string} editionId\n       * @param  {Volume} volume\n       * @return {Promise.<Volume>}\n       */\n      function saveVolume(workId, editionId, volume) {\n        if (!workId) {\n          throw new Error('no work id provided');\n        }\n\n        if (!editionId) {\n          throw new Error('no edition id provided');\n        }\n\n        if (!(volume instanceof volumeResource)) {\n          throw new Error('volume was not created by this repo');\n        }\n\n        return volume.id\n          ? volume.$update({ workId: workId, editionId: editionId })\n          : volume.$save({ workId: workId, editionId: editionId });\n      }\n\n      /**\n       * Deletes a work instance from the server\n       *\n       * @param  {string} id\n       */\n      function deleteWork(workId) {\n        var dataItem = restResource.delete({ id: workId });\n        return dataItem.$promise;\n      }\n\n      /**\n       * Ensure that aggregate fields common to all work/edition/volume entities exist and are formatted correctly\n       *\n       * @param  {Work|Edition|Volume} entity\n       * @return {Work|Edition|Volume}\n       */\n      function adaptCommon(entity) {\n        if (!entity.titles) {\n          entity.titles = [];\n        } else {\n          entity.titles.forEach(function (title) {\n            title.type = title.type.toLowerCase();\n          });\n        }\n\n        if (!entity.authors) {\n          entity.authors = [];\n        } else {\n          entity.authors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.otherAuthors) {\n          entity.otherAuthors = [];\n        } else {\n          entity.otherAuthors.forEach(function (author) {\n            author.role = author.role.toLowerCase();\n          });\n        }\n\n        if (!entity.copies) {\n          entity.copies = [];\n        }\n\n        return entity;\n      }\n\n      /**\n       * Ensure that work aggregate fields exist and are formatted correctly\n       *\n       * @param  {Work} work\n       * @return {Work}\n       */\n      function adaptWork(work) {\n        adaptCommon(work);\n\n        if (!work.editions) {\n          work.editions = [];\n        } else {\n          work.editions.forEach(adaptEdition);\n        }\n\n        return work;\n      }\n\n      /**\n       * Ensure that edition aggregate fields exist and are formatted correctly\n       *\n       * @param  {Edition} edition\n       * @return {Edition}\n       */\n      function adaptEdition(edition) {\n        adaptCommon(edition);\n\n        if (!edition.volumes) {\n          edition.volumes = [];\n        } else {\n          edition.volumes.forEach(adaptVolume);\n        }\n\n        return edition;\n      }\n\n      /**\n       * Ensure that volume aggregate fields exist and are formatted correctly\n       *\n       * @param  {Volume} volume\n       * @return {Volume}\n       */\n      function adaptVolume(volume) {\n        adaptCommon(volume);\n\n        return volume;\n      }\n\n      /**\n       * Retrieves the first available title of the given type or falsey if no title can be found.\n       * If multiple types are given, returns the title corresponding to the first type for which a title is found.\n       *\n       * @param  {Title[]}         titles\n       * @param  {string|string[]} types\n       * @return {Title}\n       */\n      function getTitleByTypePreference(titles, types) {\n        if (!angular.isArray(types)) {\n          types = [types];\n        }\n\n        return types.reduce(function (found, type) {\n          if (found) {\n            return found;\n          }\n\n          for (var i = 0; i < titles.length; i++) {\n            if (titles[i].type === type) {\n              return titles[i];\n            }\n          }\n\n          return null;\n        }, null);\n      }\n    }\n  }\n\n})();\n\n/*global ConceptBrowser:false*/\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .directive('conceptBrowser', conceptBrowserDirective);\n\n  /** @ngInject */\n  function conceptBrowserDirective($window, $timeout) {\n    var directive = {\n      restrict: 'E',\n      scope: {\n        graph: '=ngModel',\n        width: '=',\n        height: '=',\n        padding: '=',\n        layout: '@',\n        activeNode: '='\n      },\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope, el) {\n      var width = scope.width;\n      var autoWidth = false;\n      var height = scope.height;\n      var autoHeight = false;\n      var layout = scope.layout;\n      var rootEl = el.get(0);\n\n      // HACK: delay initialization until flex elements have a width/height\n      $timeout(function () {\n        if (!width) {\n          width = el.width();\n          autoWidth = true;\n        }\n\n        if (!height) {\n          height = el.height();\n          autoHeight = true;\n        }\n\n        var graph = ConceptBrowser(rootEl, layout)\n          .size([width, height]);\n\n        if (scope.graph) {\n          graph.data(scope.graph.nodes, scope.graph.edges);\n          graph.refresh();\n        }\n\n        angular.element($window).on('resize', function () {\n          if (!autoWidth && !autoHeight) {\n            return;\n          }\n\n          var oldWidth = width;\n          var oldHeight = height;\n\n          if (autoWidth) {\n            width = el.width();\n          }\n\n          if (autoHeight) {\n            height = el.height();\n          }\n\n          if (oldWidth !== width || oldHeight !== height) {\n            graph.size([width, height]);\n            graph.refresh();\n          }\n        });\n\n        // listen for graph events\n\n        // HACK if digest is already in progress, do not try to set active node (probably because it was set from the parent scope)\n        var preventActivate = false;\n        graph.on('activate', function (evt) {\n          if (preventActivate) {\n            return;\n          }\n\n          scope.$apply(function () {\n            scope.activeNode = evt.node;\n          });\n        });\n\n        // listen for data updates\n        scope.$watchGroup(['width', 'height', 'graph', 'activeNode'], function (newValues, oldValues) {\n          var queueRefresh = false;\n\n          if (newValues[0] && newValues[0] !== oldValues[0]) {\n            width = newValues[0];\n            graph.size([width, height]);\n            if (newValues[2]) {\n              queueRefresh = true;\n            }\n          }\n\n          if (newValues[1] && newValues[1] !== oldValues[1]) {\n            height = newValues[1];\n            graph.size([width, height]);\n            if (newValues[2]) {\n              queueRefresh = true;\n            }\n          }\n\n          if (newValues[2] && newValues[2] !== oldValues[2]) {\n            // make a copy of the data so changes within this directive don't get leaked out\n            var graphData = angular.copy(newValues[2]);\n            graph.data(graphData.nodes, graphData.edges);\n            queueRefresh = true;\n          }\n\n          if (newValues[3] && newValues[3] !== oldValues[3]) {\n            preventActivate = true;\n            graph.activate(newValues[3]);\n            preventActivate = false;\n          }\n\n          if (queueRefresh) {\n            graph.refresh();\n          }\n        });\n      });\n    }\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log) {\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/{type}',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global d3:false, moment:false */\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .constant('d3', d3)\n    .constant('moment', moment);\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sda.concept-browser')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, $mdThemingProvider, peopleRepoProvider, worksRepoProvider, graphRepoProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    $mdThemingProvider.definePalette('darkBrown', {\n      '50': '#595c59',\n      '100': '#4c4f4c',\n      '200': '#404240',\n      '300': '#333533',\n      '400': '#272827',\n      '500': '#1a1b1a',\n      '600': '#0d0e0d',\n      '700': '#010101',\n      '800': '#000000',\n      '900': '#000000',\n      'A100': '#e0f0e0',\n      'A200': '#565956',\n      'A400': '#7e837e',\n      'A700': '#000000',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['A100']\n    });\n\n    $mdThemingProvider.definePalette('copper', {\n      '50': '#d4b190',\n      '100': '#cca47e',\n      '200': '#c5976b',\n      '300': '#be8a59',\n      '400': '#b67e47',\n      '500': '#a47140',\n      '600': '#926439',\n      '700': '#7f5832',\n      '800': '#6d4b2b',\n      '900': '#5b3e23',\n      'A100': '#dcc3ab',\n      'A200': '#a47140',\n      'A400': '#48321c',\n      'A700': '#272927',\n\n      contrastDefaultColor: 'light',\n      contrastDarkColors: ['50', '100', '200', 'A100']\n    });\n\n    $mdThemingProvider.theme('default')\n      .primaryPalette('darkBrown')\n      .accentPalette('copper');\n\n    peopleRepoProvider.url = '/api/catalog/people';\n    worksRepoProvider.url = '/api/catalog/works';\n    graphRepoProvider.url = '/api/catalog/graph';\n  }\n\n})();\n\n/*eslint-env amd,browser,node*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory();\n  } else {\n    root.EventDispatcher = factory();\n  }\n})(this, function () {\n  'use strict';\n\n  /**\n   * Creates a new simple event dispatcher object that handles listener registration and event triggering.\n   */\n  function EventDispatcher() {\n    /**\n     * Map of event name to registered event handlers\n     * @type {object.<string,function[]>}\n     */\n    var eventHandlers = {};\n\n    /**\n     * List of registered global event handlers\n     * @type {function[]}\n     */\n    var globalHandlers = [];\n\n    ////////////////////////////////////////////////////////////\n\n    var API = {};\n    API.all = addGlobalListener;\n    API.on = addListener;\n    API.once = addOnceListener;\n    API.trigger = trigger;\n    return API;\n\n    ////////////////////////////////////////////////////////////\n\n    /**\n     * Trigger the named event, passing the given context to all registered event handlers\n     * @param {string} eventName\n     * @param {object} context\n     */\n    function trigger(eventName, context) {\n      if (eventHandlers[eventName]) {\n        eventHandlers[eventName].forEach(function (handler) {\n          try {\n            handler(context);\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n        });\n      }\n\n      globalHandlers.forEach(function (handler) {\n        try {\n          handler(eventName, context);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n      });\n    }\n\n    /**\n     * Attach an event handler that will be triggered for all events\n     * @param {function} handler\n     * @return {function} deregistration function\n     */\n    function addGlobalListener(handler) {\n      globalHandlers.push(handler);\n\n      return function () {\n        var ix = globalHandlers.indexOf(handler);\n        if (ix >= 0) {\n          globalHandlers.splice(ix, 1);\n        }\n      }\n    }\n\n    /**\n     * Attach an event handler to the given event name.\n     * @param {string} eventName\n     * @param {function} handler\n     * @return {function} deregistration function\n     */\n    function addListener(eventName, handler) {\n      if (!eventHandlers[eventName]) {\n        eventHandlers[eventName] = [];\n      }\n\n      eventHandlers[eventName].push(handler);\n\n      return function () {\n        var ix = eventHandlers[eventName].indexOf(handler);\n        if (ix >= 0) {\n          eventHandlers[eventName].splice(ix, 1);\n        }\n      }\n    }\n\n    /**\n     * Attach an event listener to the given event name that will automatically deregister after it has been fired.\n     * @param {string} eventName\n     * @param {function} handler\n     * @return {function} deregistration function\n     */\n    function addOnceListener(eventName, handler) {\n      var deregister = addListener(eventName, function (context) {\n        try {\n          handler(context);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        } finally {\n          deregister();\n        }\n      });\n\n      return deregister;\n    }\n  }\n\n  return EventDispatcher;\n\n});\n\n/*global d3:false*/\n/*eslint-env amd,browser,node*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['d3'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('d3'));\n  } else {\n    factory(d3);\n  }\n})(this, function (d3) {\n  'use strict';\n\n  var LINK_DISTANCE = 20,\n      LINK_STRENGTH = 1,\n      CHARGE_DISTANCE_2 = Infinity;\n\n  /**\n   * force layout based on d3.layout.force(), but with horizontal wrapping\n   *\n   * @return {object}\n   */\n  d3.layout.force.cylindrical = function () {\n    var force = {},\n        event = d3.dispatch(\"start\", \"tick\", \"end\"),\n        size = [1, 1],\n        drag,\n        alpha,\n        friction = 0.9,\n        linkDistance = LINK_DISTANCE,\n        linkStrength = LINK_STRENGTH,\n        charge = -30,\n        chargeDistance2 = CHARGE_DISTANCE_2,\n        gravity = 0.1,\n        theta2 = 0.64,\n        nodes = [],\n        links = [],\n        distances,\n        strengths,\n        charges;\n\n    function wrapDx(dx, width) {\n      if (2 * Math.abs(dx) > width) {\n        // the \"other side\" of the cylinder is closer\n        if (dx < 0) {\n          // quad point is to the left: simulate force as if it were on the right\n          dx += width;\n        } else {\n          // quad point is to the right: simulate force as if it were on the left\n          dx -= width;\n        }\n      }\n\n      return dx;\n    }\n\n    function repulse(node) {\n      return function (quad, x1, _, x2) {\n        if (quad.point !== node) {\n          var width = size[0];\n\n          var dx = wrapDx(quad.cx - node.x, width),\n              dy = quad.cy - node.y,\n              dw = x2 - x1;\n\n\n          var dn = dx * dx + dy * dy;\n          var k = 0;\n\n          /* Barnes-Hut criterion. */\n          if (dw * dw / theta2 < dn) {\n            if (dn < chargeDistance2) {\n              k = quad.charge / dn;\n              node.px -= dx * k;\n              node.py -= dy * k;\n            }\n            return true;\n          }\n\n          if (quad.point && dn && dn < chargeDistance2) {\n            k = quad.pointCharge / dn;\n            node.px -= dx * k;\n            node.py -= dy * k;\n          }\n        }\n        return !quad.charge;\n      };\n    }\n\n    force.tick = function () {\n      // simulated annealing, basically\n      if ((alpha *= 0.99) < 0.005) {\n        event.end({\n          type: \"end\",\n          alpha: alpha = 0\n        });\n        return true;\n      }\n\n      var n = nodes.length,\n        m = links.length,\n        q,\n        i, // current index\n        o, // current object\n        s, // current source\n        t, // current target\n        l, // current distance\n        k, // current force\n        x, // x-distance\n        y; // y-distance\n\n      // gauss-seidel relaxation for links\n      for (i = 0; i < m; ++i) {\n        o = links[i];\n        s = o.source;\n        t = o.target;\n        x = wrapDx(t.x - s.x, size[0]);\n        y = t.y - s.y;\n        l = (x * x + y * y);\n\n        if (l !== 0) {\n          l = alpha * strengths[i] * ((l = Math.sqrt(l)) - distances[i]) / l;\n          x *= l;\n          y *= l;\n\n          t.x -= x * (k = s.weight / (t.weight + s.weight));\n          t.y -= y * k;\n\n          s.x += x * (k = 1 - k);\n          s.y += y * k;\n        }\n      }\n\n      // apply gravity forces\n      k = alpha * gravity;\n      if (k !== 0) {\n        x = size[0] / 2;\n        y = size[1] / 2;\n        i = -1;\n        if (k)\n          while (++i < n) {\n            o = nodes[i];\n            // o.x += (x - o.x) * k;\n            o.y += (y - o.y) * k;\n          }\n      }\n\n      // compute quadtree center of mass and apply charge forces\n      if (charge) {\n        accumulate(q = d3.geom.quadtree(nodes), alpha, charges);\n        i = -1;\n        while (++i < n) {\n          if (!(o = nodes[i]).fixed) {\n            q.visit(repulse(o));\n          }\n        }\n      }\n\n      // position verlet integration\n      i = -1;\n      while (++i < n) {\n        o = nodes[i];\n        if (o.fixed) {\n          o.x = o.px;\n          o.y = o.py;\n        } else {\n          o.x -= (o.px - (o.px = o.x)) * friction;\n          o.y -= (o.py - (o.py = o.y)) * friction;\n        }\n      }\n\n      // update positions if a node gets pushed off the sides of the visualization\n      i = -1;\n      var width = size[0];\n      while (++i < n) {\n        o = nodes[i];\n\n        var dx = o.px - o.x;\n        o.x %= width;\n        // ensure node.x is positive; there's a chance that -width < node.x % width < 0\n        if (o.x < 0) {\n          o.x += width;\n        }\n\n        // ensure that previous x position (used to calculate velocity) is semantically correct after wrapping\n        o.px = o.x + dx;\n\n      }\n\n      event.tick({\n        type: \"tick\",\n        alpha: alpha\n      });\n    };\n\n    force.nodes = function (x) {\n      if (!arguments.length) return nodes;\n      nodes = x;\n      return force;\n    };\n\n    force.links = function (x) {\n      if (!arguments.length) return links;\n      links = x;\n      return force;\n    };\n\n    force.size = function (x) {\n      if (!arguments.length) return size;\n      size = x;\n      return force;\n    };\n\n    force.linkDistance = function (x) {\n      if (!arguments.length) return linkDistance;\n      linkDistance = isFunction(x) ? x : +x;\n      return force;\n    };\n\n    force.linkStrength = function (x) {\n      if (!arguments.length) return linkStrength;\n      linkStrength = isFunction(x) ? x : +x;\n      return force;\n    };\n\n    force.friction = function (x) {\n      if (!arguments.length) return friction;\n      friction = +x;\n      return force;\n    };\n\n    force.charge = function (x) {\n      if (!arguments.length) return charge;\n      charge = isFunction(x) ? x : +x;\n      return force;\n    };\n\n    force.chargeDistance = function (x) {\n      if (!arguments.length) return Math.sqrt(chargeDistance2);\n      chargeDistance2 = x * x;\n      return force;\n    };\n\n    force.gravity = function (x) {\n      if (!arguments.length) return gravity;\n      gravity = +x;\n      return force;\n    };\n\n    force.theta = function (x) {\n      if (!arguments.length) return Math.sqrt(theta2);\n      theta2 = x * x;\n      return force;\n    };\n\n    force.alpha = function (x) {\n      if (!arguments.length) return alpha;\n\n      x = +x;\n      if (alpha) { // if we're already running\n        if (x > 0) alpha = x; // we might keep it hot\n        else alpha = 0; // or, next tick will dispatch \"end\"\n      } else if (x > 0) { // otherwise, fire it up!\n        event.start({\n          type: \"start\",\n          alpha: alpha = x\n        });\n        d3.timer(force.tick);\n      }\n\n      return force;\n    };\n\n    force.start = function () {\n      var i,\n        n = nodes.length,\n        m = links.length,\n        w = size[0],\n        h = size[1],\n        neighbors,\n        o;\n\n      for (i = 0; i < n; ++i) {\n        (o = nodes[i]).index = i;\n        o.weight = 0;\n      }\n\n      for (i = 0; i < m; ++i) {\n        o = links[i];\n        if (isNumber(o.source)) o.source = nodes[o.source];\n        if (isNumber(o.target)) o.target = nodes[o.target];\n        ++o.source.weight;\n        ++o.target.weight;\n      }\n\n      for (i = 0; i < n; ++i) {\n        o = nodes[i];\n        if (isNaN(o.x)) o.x = position(\"x\", w);\n        if (isNaN(o.y)) o.y = position(\"y\", h);\n        if (isNaN(o.px)) o.px = o.x;\n        if (isNaN(o.py)) o.py = o.y;\n      }\n\n      distances = [];\n      if (isFunction(linkDistance))\n        for (i = 0; i < m; ++i) distances[i] = +linkDistance.call(this, links[i], i);\n      else\n        for (i = 0; i < m; ++i) distances[i] = linkDistance;\n\n      strengths = [];\n      if (isFunction(linkStrength))\n        for (i = 0; i < m; ++i) strengths[i] = +linkStrength.call(this, links[i], i);\n      else\n        for (i = 0; i < m; ++i) strengths[i] = linkStrength;\n\n      charges = [];\n      if (isFunction(charge))\n        for (i = 0; i < n; ++i) charges[i] = +charge.call(this, nodes[i], i);\n      else\n        for (i = 0; i < n; ++i) charges[i] = charge;\n\n      // inherit node position from first neighbor with defined position\n      // or if no such neighbors, initialize node position randomly\n      // initialize neighbors lazily to avoid overhead when not needed\n      function position(dimension, size) {\n        if (!neighbors) {\n          neighbors = new Array(n);\n\n          for (j = 0; j < n; ++j)\n            neighbors[j] = [];\n\n          for (j = 0; j < m; ++j) {\n            var o = links[j];\n            neighbors[o.source.index].push(o.target);\n            neighbors[o.target.index].push(o.source);\n          }\n        }\n\n        var candidates = neighbors[i],\n          j = -1,\n          cs = candidates.length,\n          x;\n\n        while (++j < cs)\n          if (!isNaN(x = candidates[j][dimension])) return x;\n\n        return Math.random() * size;\n      }\n\n      return force.resume();\n    };\n\n    force.resume = function () {\n      return force.alpha(0.1);\n    };\n\n    force.stop = function () {\n      return force.alpha(0);\n    };\n\n    // use `node.call(force.drag)` to make nodes draggable\n    force.drag = function () {\n      if (!drag) drag = d3.behavior.drag()\n        .origin(function (o) {\n          return o;\n        })\n        .on(\"dragstart.force\", dragstart)\n        .on(\"drag.force\", dragmove)\n        .on(\"dragend.force\", dragend);\n\n      if (!arguments.length) return drag;\n\n      this.on(\"mouseover.force\", mouseover)\n        .on(\"mouseout.force\", mouseout)\n        .call(drag);\n    };\n\n    function dragmove(d) {\n      d.px = d3.event.x;\n      d.py = d3.event.y;\n      force.resume(); // restart annealing\n    }\n\n    force.edgePath = function () {\n      var width = size[0];\n\n      var getX1 = function (d) { return d[0][0]; }\n      var getY1 = function (d) { return d[0][1]; }\n      var getX2 = function (d) { return d[1][0]; }\n      var getY2 = function (d) { return d[1][1]; }\n\n      var drawLine = function (selection) {\n        selection.attr('d', function (d) {\n          var x1 = getX1(d);\n          var y1 = getY1(d);\n          var x2 = getX2(d);\n          var y2 = getY2(d);\n\n          if (2*Math.abs(x1-x2) < width) {\n            // draw direct from source to target\n            return 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2;\n          } else if (x1 < x2) {\n            // shorter to go around the \"back\" and x1 is on the left\n            return 'M ' + x1 + ' ' + y1 + ' L ' + (x2 - width) + ' ' + y2 + ' ' +\n              'M ' + x2 + ' ' + y2 + ' L ' + (x1 + width) + ' ' + y1;\n          } else {\n            // shorter to go around the \"back\" and x1 is on the right\n            return 'M ' + x1 + ' ' + y1 + ' L ' + (x2 + width) + ' ' + y2 + ' ' +\n              'M ' + x2 + ' ' + y2 + ' L ' + (x1 - width) + ' ' + y1;\n          }\n        });\n      };\n\n      drawLine.x1 = function (fn) { getX1 = fn; return drawLine; }\n      drawLine.y1 = function (fn) { getY1 = fn; return drawLine; }\n      drawLine.x2 = function (fn) { getX2 = fn; return drawLine; }\n      drawLine.y2 = function (fn) { getY2 = fn; return drawLine; }\n\n      return drawLine;\n    };\n\n    return d3.rebind(force, event, \"on\");\n  };\n\n  // The fixed property has three bits:\n  // Bit 1 can be set externally (e.g., d.fixed = true) and show persist.\n  // Bit 2 stores the dragging state, from mousedown to mouseup.\n  // Bit 3 stores the hover state, from mouseover to mouseout.\n  // Dragend is a special case: it also clears the hover state.\n\n  function dragstart(d) {\n    d.fixed |= 2; // set bit 2\n  }\n\n  function dragend(d) {\n    d.fixed &= ~6; // unset bits 2 and 3\n  }\n\n  function mouseover(d) {\n    d.fixed |= 4; // set bit 3\n    d.px = d.x;\n    d.py = d.y; // set velocity to zero\n  }\n\n  function mouseout(d) {\n    d.fixed &= ~4; // unset bit 3\n  }\n\n  function accumulate(quad, alpha, charges) {\n    var cx = 0,\n      cy = 0;\n\n    quad.charge = 0;\n\n    if (!quad.leaf) {\n      var nodes = quad.nodes,\n        n = nodes.length,\n        i = -1,\n        c;\n\n      while (++i < n) {\n        c = nodes[i];\n        if (!c) continue;\n\n        accumulate(c, alpha, charges);\n        quad.charge += c.charge;\n        cx += c.charge * c.cx;\n        cy += c.charge * c.cy;\n      }\n    }\n\n    if (quad.point) {\n      // jitter internal nodes that are coincident\n      if (!quad.leaf) {\n        quad.point.x += Math.random() - 0.5;\n        quad.point.y += Math.random() - 0.5;\n      }\n\n      var k = alpha * charges[quad.point.index];\n\n      quad.charge += quad.pointCharge = k;\n\n      cx += k * quad.point.x;\n      cy += k * quad.point.y;\n    }\n\n    quad.cx = cx / quad.charge;\n    quad.cy = cy / quad.charge;\n  }\n\n  function isFunction(o) {\n    return typeof o === 'function';\n  }\n\n  function isNumber(o) {\n    return typeof o === 'number';\n  }\n\n});\n\n/*eslint-env amd,browser,node*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['d3', 'event-dispatcher', 'd3-force-cylindrical'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    require('d3-force-cylindrical');\n    module.exports = factory(require('d3'), require('event-dispatcher'));\n  } else {\n    root.ConceptBrowser = factory(root.d3, root.EventDispatcher);\n  }\n})(this, function (d3, EventDispatcher) {\n  'use strict';\n\n  /** @type {integer} */\n  var NODE_MIN_SIZE = 4;\n\n  /** @type {integer} */\n  var NODE_MAX_SIZE = 10;\n\n  /** @type {object.<string,functin>} */\n  var GRAPH_LAYOUT_CTORS = {\n    planar: d3.layout.force,\n    cylindrical: d3.layout.force.cylindrical\n  };\n\n  /** @type {string} */\n  var TIP_CSS_CLASS = 'd3-tip';\n\n  /** @type {object.<string,integer>} */\n  var TIP_POSITION_MARGIN = {\n    left: 200,\n    right: 200,\n    top: 100,\n    bottom: 100\n  };\n\n  if (!d3.tip) {\n    // eslint-disable-next-line no-console\n    console.warn('d3.tip is not available; tooltips will not display properly.');\n  }\n\n  /**\n   * SDA Concept Browser Visualization\n   *\n   * @param  {Element} rootEl\n   * @param  {integer} width\n   * @param  {integer} height\n   * @param  {string} [layout=planar] - one of: (planar, cylindrical)\n   */\n  function ConceptBrowser(rootEl, layout, options) {\n    layout = layout || 'planar';\n    options = options || {};\n\n    var events = EventDispatcher();\n\n    if (options.debug) {\n      events.all(function (eventName, context) {\n        // eslint-disable-next-line no-console\n        console.log(eventName, context.node ? context.node.id : context);\n      });\n    }\n\n    /**\n     * visualization width in pixels\n     *\n     * @type {integer}\n     */\n    var width;\n\n    /**\n     * visualization height in pixels\n     *\n     * @type {integer}\n     */\n    var height;\n\n    /**\n     * Nodes in the graph\n     *\n     * @type {Node[]}\n     */\n    var nodes = [];\n\n    /**\n     * Edges connecting nodes in the graph\n     *\n     * @type {Node[]}\n     */\n    var edges = [];\n\n    /**\n     * Collection of nodes that are in the \"focused\" state\n     *\n     * @type {Node[]}\n     */\n    var selected = [];\n\n    /**\n     * The currently focused node (if there is one)\n     *\n     * @type {?Node}\n     */\n    var focused = null;\n\n    /**\n     * The currently activated node (if there is one)\n     *\n     * @type {?Node}\n     */\n    var activated = null;\n\n    /**\n     * @type {d3.selection}\n     */\n    var svg;\n\n    /**\n     * @type {d3.selection}\n     */\n    var nodeLayer;\n\n    /**\n     * @type {d3.selection}\n     */\n    var edgeLayer;\n\n    /**\n     * @type {d3.selection}\n     */\n    var progressBar;\n\n    /**\n     * @type {d3.scale}\n     */\n    var progressScale;\n\n    /**\n     * @type {d3.scale}\n     */\n    var nodeRadiusScale;\n\n    /**\n     * @type {d3.layout.force}\n     */\n    var graph;\n\n    /**\n     * function used in a selection.call() method for drawing edge paths.\n     * by default, it draws a straight line between the edge source and target nodes\n     *\n     * @type {function}\n     */\n    var drawEdge = function (selection) {\n      selection.attr('d', function (edge) {\n        var x1 = edge.source.x;\n        var y1 = edge.source.y;\n        var x2 = edge.target.x;\n        var y2 = edge.target.y;\n\n        return 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2;\n      });\n    }\n\n    /**\n     * @type {?d3.tip}\n     */\n    var tooltip = null;\n\n    /**\n     * @type {boolean}\n     */\n    var isInitialized = false;\n\n    ////////////////////////////////////////////////////////////\n\n    // expose public methods\n    var API = {};\n    API.size = setSize;\n    API.data = setData;\n    API.activate = setActivated;\n    API.refresh = refresh;\n    API.on = events.on;\n    return API;\n\n    ////////////////////////////////////////////////////////////\n\n    /**\n     * Sets graph dimensions. refresh() must be called in order for changes to take effect\n     *\n     * @param {integer[]} dims - dimensions (width, height) of new viewing area\n     */\n    function setSize(dims) {\n      width = dims[0];\n      height = dims[1];\n\n      if (isInitialized) {\n        svg.attr('width', width).attr('height', height);\n        progressScale.range([0, width]);\n        graph.size([width, height]);\n      }\n\n      return API;\n    }\n\n    /**\n     * Sets graph data. refresh() must be called in order for changes to take effect\n     *\n     * @param {Node[]} _nodes\n     * @param {Edge[]} _edges\n     */\n    function setData(_nodes, _edges) {\n      nodes = _nodes;\n      edges = _edges;\n\n      // randomize node positions if not already set\n      nodes.forEach(function (node) {\n        node.x = (node.x || Math.random()) * width;\n        node.y = (node.y || Math.random()) * height;\n      });\n\n      return API;\n    }\n\n    /**\n     * Sets the set of currently active node\n     *\n     * @param {Node} node\n     */\n    function setActivated(node) {\n      if (nodes.indexOf(node) < 0) {\n        throw new Error('node to be activated is not a member of the graph');\n      }\n\n      activate(node);\n\n      // also select nodes\n      deselectAll();\n      select(node);\n    }\n\n    /**\n     * Update node and edge bindings for display and run force-directed graph simulation\n     *\n     * @param {object} data\n     */\n    function refresh() {\n      // ensure visualization is initialized\n      initialize();\n\n      // begin force-directed simulation\n      graph\n        .nodes(nodes)\n        .links(edges)\n        .start();\n\n      bindNodes();\n      bindEdges();\n\n      return API;\n    }\n\n    ////////////////////////////////////////////////////////////\n\n    /**\n     * HACK: hand-crafted scaling function to deal with pagerank range distribution discrepancy\n     *\n     * @param  {number} x PageRank value assumed to be in (0,1)\n     * @return {number} A \"more reasonably\" scaled value in (0,1)\n     */\n    function scalePageRank(x) {\n      return 1 - 1 / Math.pow(1 + x, 700);\n    }\n\n    function initialize() {\n      if (isInitialized) {\n        return;\n      }\n\n      isInitialized = true;\n\n      if (!width || !height) {\n        throw new Error('No width/height set. Use size([width, height]) to set size before initializing');\n      }\n\n      svg = d3.select(rootEl).append('svg')\n        .attr('width', width)\n        .attr('height', height);\n\n      // extract edge types and create arrowhead styles for them\n      var edgeTypes = edges.reduce(function (types, edge) {\n        if (types.indexOf(edge.relation) < 0) {\n          types.push(edge.relation);\n        }\n        return types;\n      }, []);\n\n      defineArrowheads(svg, edgeTypes, ['', 'activated', 'selected', 'focused']);\n\n      var baseGroup = svg.append('g').attr('class', 'concept-browser');\n      edgeLayer = baseGroup.append('g').attr('class', 'edges');\n      nodeLayer = baseGroup.append('g').attr('class', 'nodes');\n\n      progressBar = baseGroup.append('rect').attr('class', 'progress')\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('height', 2);\n\n      progressScale = d3.scale.linear()\n        .domain([Math.log(0.1), Math.log(0.005)])\n        .range([0, width]);\n\n      // HACK: hand-crafted scaling function to deal with pagerank range distribution discrepancy\n      nodeRadiusScale = function (x) {\n        return NODE_MIN_SIZE + (NODE_MAX_SIZE - NODE_MIN_SIZE) * scalePageRank(x);\n      }\n\n      // nodeRadiusScale = d3.scale.pow()\n      //   .exponent(0.2)\n      //   .range([NODE_MIN_SIZE, NODE_MAX_SIZE]);\n\n      graph = GRAPH_LAYOUT_CTORS[layout || 'planar']()\n        .size([width, height])\n        .on('tick', tick);\n      configureGraph(graph);\n\n      if (graph.edgePath) {\n        drawEdge = graph.edgePath()\n          .x1(function (edge) { return edge.source.x; })\n          .y1(function (edge) { return edge.source.y; })\n          .x2(function (edge) { return edge.target.x; })\n          .y2(function (edge) { return edge.target.y; });\n      }\n\n      if (d3.tip) {\n        tooltip = d3.tip()\n            .attr('class', TIP_CSS_CLASS)\n            .direction(tooltipDirection)\n            .offset(tooltipOffset)\n            .html(function (node) { return node.label; });\n\n        events.on('focus', function (evt) { showTooltip(evt.node); });\n        events.on('blur', function (evt) { hideTooltip(evt.node); });\n      }\n\n      events.on('focus', updateEgoGraphs);\n      events.on('blur', updateEgoGraphs);\n      events.on('select', updateEgoGraphs);\n      events.on('deselect', updateEgoGraphs);\n    }\n\n    /**\n     * Sets configuration values on a D3 graph instance\n     *\n     * @param  {d3.svg.graph} graph\n     */\n    function configureGraph(graph) {\n      graph\n        .gravity(0.1)\n        // .linkDistance(50)\n        // .chargeDistance(width * 0.25)\n        .linkDistance(50)\n        .linkStrength(function (edge) {\n          // influential nodes pull their supporters closer\n          var pagerank = extractPagerank(edge.target);\n          return scalePageRank(pagerank)\n          // var targetInfluence = edge.target.stats.in_degree / 10;\n          // return 1 - 1/(1 + targetInfluence);\n        })\n        .charge(function (node) {\n          // HACK experiment with variably-charged nodes\n          var chargeRange = [-50, -300];\n          var influenceRange = [0, 1];\n          var pagerank = extractPagerank(node);\n\n          return chargeRange[0] + (chargeRange[1] - chargeRange[0])/(influenceRange[1] - influenceRange[0]) * (scalePageRank(pagerank) - influenceRange[0]);\n        })\n        .friction(.9);\n        // .theta(0.08);\n    }\n\n    /**\n     * Update node positions with each tick of a graph's physics simulation\n     *\n     * @param {object} evt\n     */\n    function tick(evt) {\n      updatePositions();\n\n      if (evt.alpha > 0.0051) {\n        progressBar.attr('width', progressScale(Math.log(evt.alpha)));\n        // bail early; do not render nodes\n        if (Math.random() < 0.95) return;\n      } else {\n        progressBar.attr('width', 0);\n      }\n\n      nodeLayer.selectAll('.node').transition().duration(500)\n        .attr('transform', function (node) {\n          return 'translate(' + node.x + ',' + node.y + ')';\n        });\n\n      edgeLayer.selectAll('.edge').transition().duration(500)\n        .call(drawEdge);\n    }\n\n    /**\n     * Update node bindings on the visualization\n     *\n     * @param  {Node[]} nodes\n     */\n    function bindNodes() {\n      // var nodeMetricExtent = d3.extent(nodes, function (node) {\n      //   return (node.metadata && node.metadata.pagerank) || 1;\n      // });\n\n      // nodeRadiusScale.domain(nodeMetricExtent);\n\n      var nodeSelect = nodeLayer.selectAll('.node')\n        .data(nodes, function (node) {\n          return node.id;\n        });\n\n      var nodeEnter = nodeSelect.enter().append('g')\n        .attr('class', 'node')\n        .attr('transform', function (node) {\n          return 'translate(' + node.x + ',' + node.y + ')';\n        })\n        .on('mouseover', focus)\n        .on('mouseout', blur)\n        .on('dblclick', activate)\n        .on('click', function (node) {\n          if (d3.event.ctrlKey) {\n            if (selected.indexOf(node) < 0) {\n              select(node);\n            } else {\n              deselect(node);\n            }\n          } else {\n            deselectAll();\n            select(node);\n          }\n        });\n\n      nodeEnter.append('circle')\n        .attr('r', function (node) {\n          var pagerank = extractPagerank(node);\n          return nodeRadiusScale(pagerank);\n        });\n\n      nodeSelect.exit().remove();\n\n      if (tooltip) {\n        nodeLayer.call(tooltip);\n      }\n    }\n\n    /**\n     * Update edge bindings on the visualization\n     *\n     * @param  {Edge[]} edges\n     */\n    function bindEdges() {\n      var edgeSelect = edgeLayer.selectAll('.edge')\n        .data(edges, function (edge) {\n          return edge.source.id + ',' + edge.target.id;\n        });\n\n      edgeSelect.enter().append('path')\n        .attr('class', function (edge) {\n          return 'edge ' + edge.relation;\n        })\n        .attr('marker-end', function (edge) {\n          return 'url(#arrowhead-' + edge.relation + ')';\n        })\n        .style('stroke-width', function (edge) {\n          var multiplicity = (edge.metadata && edge.metadata.multiplicity) || 1;\n          return multiplicity + 'pt';\n        })\n        .call(drawEdge);\n\n      edgeSelect.exit().remove();\n    }\n\n    /**\n     * Focuses the given node\n     *\n     * @param {Node} node\n     */\n    function focus(node) {\n      // ensure that the currently selected node has already been blurred\n      blur();\n\n      focused = node;\n      events.trigger('focus', { node: focused, selection: selected });\n    }\n\n    /**\n     * Blurs the given node or the currently focused node.\n     *\n     * @param {Node} [node]\n     */\n    function blur(node) {\n      node = node || focused;\n\n      if (node) {\n        if (focused === node) {\n          focused = null;\n        } else {\n          throw new Error('tried to blur a node that was not focused');\n        }\n\n        events.trigger('blur', { node: node, selection: selected });\n      }\n    }\n\n    /**\n     * Activates the given node\n     *\n     * @param {Node} node\n     */\n    function activate(node) {\n      // don't do anything if node is already active\n      if (activated === node) {\n        return;\n      }\n\n      // ensure that the active node has been deactivated\n      deactivate()\n\n      activated = node;\n      events.trigger('activate', { node: activated, selection: selected });\n    }\n\n    /**\n     * Deactivates the given node or the currently activated node.\n     *\n     * @param {Node} node\n     */\n    function deactivate(node) {\n      node = node || activated;\n\n      if (node) {\n        if (activated === node) {\n          activated = null;\n        } else {\n          throw new Error('tried to deactivate a node that was not activated');\n        }\n\n        events.trigger('deactivate', { node: node, selection: selected });\n      }\n    }\n\n    /**\n     * Adds the given node to the list of currently selected nodes\n     *\n     * @param {Node} node\n     */\n    function select(node) {\n      if (!node) {\n        throw new Error('no node provided');\n      }\n\n      if (selected.indexOf(node) < 0) {\n        selected.push(node);\n      } else {\n        throw new Error('tried to select a node that is already selected');\n      }\n\n      events.trigger('select', { node: node, selection: selected });\n    }\n\n    /**\n     * Removes the given node from the list of currently selected nodes\n     *\n     * @param {Node} node\n     */\n    function deselect(node) {\n      if (!node) {\n        throw new Error('no node provided to deselect');\n      }\n\n      var ix = selected.indexOf(node);\n      if (ix < 0) {\n        throw new Error('tried to deselect a node that was not selected');\n      } else {\n        selected.splice(ix, 1);\n      }\n\n      events.trigger('deselect', { node: node, selection: selected });\n    }\n\n    /**\n     * Deselects all selected nodes\n     */\n    function deselectAll() {\n      selected.forEach(function (node) {\n        events.trigger('deselect', { node: node, selection: [] });\n      });\n\n      selected = [];\n    }\n\n    /**\n     * Displays a tooltip with a label for the given node.\n     *\n     * @param {Node} node\n     */\n    function showTooltip(node) {\n      if (tooltip) {\n        tooltip.attr('class', TIP_CSS_CLASS)\n          .show(node);\n      }\n    }\n\n    /**\n     * Hides the tooltip for the given node.\n     *\n     * @param {Node} node\n     */\n    function hideTooltip(node) {\n      if (tooltip) {\n        tooltip.attr('class', TIP_CSS_CLASS)\n          .hide(node);\n      }\n    }\n\n    /**\n     * Marks selected nodes and edges as highlighted\n     */\n    function updateEgoGraphs() {\n      /**\n       * Determines whether a node should be marked as activated\n       *\n       * @param  {Node}    node\n       * @return {boolean}\n       */\n       function isNodeActivated(node) {\n         return activated === node;\n       }\n\n      /**\n       * Determines whether a node should be marked as selected\n       *\n       * @param  {Node}    node\n       * @return {boolean}\n       */\n      function isNodeSelected(node) {\n        return selected.indexOf(node) >= 0;\n      }\n\n      /**\n       * Determines whether a node should be marked as focused\n       * @param  {[type]}  node [description]\n       * @return {Boolean}      [description]\n       */\n      function isNodeFocused(node) {\n        return focused === node;\n      }\n\n      /**\n       * Determines whether an edge has a node that should be marked as activated\n       *\n       * @param  {Edge}    edge\n       * @return {boolean}\n       */\n      function isEdgeActivated(edge) {\n        return isNodeActivated(edge.source) || isNodeActivated(edge.target);\n      }\n\n      /**\n       * Determines whether an edge has a node that should be marked as selected\n       *\n       * @param  {Edge}    edge\n       * @return {boolean}\n       */\n      function isEdgeSelected(edge) {\n        return isNodeSelected(edge.source) || isNodeSelected(edge.target);\n      }\n\n      /**\n       * Determines whether an edge has a node that should be marked as focused\n       *\n       * @param  {Edge}    edge\n       * @return {boolean}\n       */\n      function isEdgeFocused(edge) {\n        return isNodeFocused(edge.source) || isNodeFocused(edge.target);\n      }\n\n      nodeLayer.selectAll('.node')\n        .classed('activated', function (node) {\n          return isNodeActivated(node) || node.outEdges.some(isEdgeActivated) || node.inEdges.some(isEdgeActivated);\n        })\n        .classed('selected', function (node) {\n          return isNodeSelected(node) || node.outEdges.some(isEdgeSelected) || node.inEdges.some(isEdgeSelected);\n        })\n        .classed('focused', function (node) {\n          return isNodeFocused(node) || node.outEdges.some(isEdgeFocused) || node.inEdges.some(isEdgeFocused);\n        });\n\n      edgeLayer.selectAll('.edge')\n        .classed('activated', isEdgeActivated)\n        .classed('selected', isEdgeSelected)\n        .classed('focused', isEdgeFocused)\n        .attr('marker-end', function (edge) {\n          var cls = '';\n\n          if (isEdgeActivated(edge)) {\n            cls = '-activated';\n          } else if (isEdgeSelected(edge)) {\n            cls = '-selected'\n          } else if (isEdgeFocused(edge)) {\n            cls = '-focused'\n          }\n\n          return 'url(#arrowhead-' + edge.relation + cls + ')';\n        });\n    }\n\n    /**\n     * Sets positions of each node to within the viewing area, wrapping left and right sides\n     */\n    function updatePositions() {\n      nodes.forEach(function (node) {\n        // constrain x and y positions to within viewing area\n        node.x = Math.max(Math.min(node.x, width), 0);\n        node.y = Math.max(Math.min(node.y, height), 0);\n      });\n    }\n\n    /**\n     * Gets node-relative tooltip positioning information from a node.\n     * Based on how close the node is to the border/sides of the visualization.\n     *\n     * @param {Node} node\n     * @return {string} tooltip direction (one of: n, ne, e, se, s, sw, w, nw)\n     */\n    function tooltipDirection(node) {\n      var dir = '';\n\n      // control top/bottom based on proximity to borders\n      if (node.y > height - TIP_POSITION_MARGIN.bottom) dir += 'n';\n      else if (node.y < TIP_POSITION_MARGIN.top) dir += 's';\n\n      // control side based on proximity to borders\n      if (node.x > width - TIP_POSITION_MARGIN.right) dir += 'w';\n      else if (node.x < TIP_POSITION_MARGIN.left) dir += 'e';\n\n      // fall back to top\n      if (dir === '') dir = 'n';\n\n      return dir;\n    }\n\n     /**\n      * Controls how far to place the tooltip from the point at which the node is located.\n      * Offset coordinates based on how close the node is to the border/sides of the visualization\n      * (i.e. the node's radius)\n      *\n      * @param {Node} node\n      * @return {integer[]} tooltip x/y offset coordinates\n      */\n    function tooltipOffset(node) {\n      var pagerank = extractPagerank(node);\n      var radius = nodeRadiusScale(pagerank);\n      var offset = [0, 0];\n\n      if (node.y > height - TIP_POSITION_MARGIN.bottom) offset[0] -= radius;\n      else if (node.y < TIP_POSITION_MARGIN.top) offset[0] += radius;\n\n      if (node.x > width - TIP_POSITION_MARGIN.left_right) offset[1] -= radius;\n      else if (node.x < TIP_POSITION_MARGIN.left_right) offset[1] += radius;\n\n      if (offset[1] === 0 && offset[0] === 0) offset[0] -= radius;\n\n      return offset;\n    }\n\n    /**\n     * Extracts pagerank metadata from the given node or computes a default pagerank value\n     *\n     * @param {Node} node\n     * @return {float}\n     */\n    function extractPagerank(node) {\n      return (node.metadata && node.metadata.pagerank) ||\n          ((nodes && nodes.length > 0) ? 1 / nodes.length : 1);\n    }\n\n    /**\n     * Sets arrowhead definitions on the SVG defs element\n     *\n     * @param  {object} svg\n     */\n    function defineArrowheads(svg, edgeTypes, classTypes) {\n      var arrowTypes = [];\n      edgeTypes.forEach(function (type) {\n        classTypes.forEach(function (cls) {\n          arrowTypes.push('arrowhead-' + type + (cls ? '-' + cls : ''));\n        });\n      });\n\n      // arrowhead definitions\n      svg.append('defs').selectAll('marker')\n          .data(arrowTypes)\n        .enter().append('marker')\n          .attr('id', function(id) { return id; })\n          .attr('viewBox', '0 -4 10 8')\n          .attr('refX', 25)\n          .attr('refY', 0)\n          .attr('markerWidth', 6)\n          .attr('markerHeight', 6)\n          .attr('orient', 'auto')\n        .append('path')\n          .attr('d', 'M 0,-4 L 10,0 L 0,4');\n    }\n  }\n\n  return ConceptBrowser;\n\n});\n\nangular.module(\"sda.concept-browser\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<md-sidenav md-component-id=right class=md-sidenav-right md-is-open=main.activeNode md-disable-backdrop md-whiteframe=4 layout=column><md-toolbar><div class=md-toolbar-tools><h2>Node Information</h2><span flex></span><md-button class=md-icon-button ng-click=\\\"main.activeNode = null\\\"><md-icon>close</md-icon></md-button></div></md-toolbar><div flex layout=column layout-align=\\\"center center\\\" ng-if=!main.loaded><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class=node-info flex layout=column ng-if=main.loaded><h3 class=name><span class=given>{{main.person.name.givenName}}</span> <span class=family>{{main.person.name.familyName}}</span></h3><md-tabs flex><md-tab><md-tab-label><md-icon>person</md-icon></md-tab-label><md-tab-body><div class=summary ng-if=main.person.summary ng-bind-html=main.person.summary></div><div class=books ng-if=\\\"main.works && main.works.length > 0\\\"><h4>Books ({{main.works.length}})</h4><md-list><md-list-item ng-repeat=\\\"work in main.works\\\" ng-href=../#/library/books/{{work.id}}>{{work.label}}</md-list-item></md-list></div></md-tab-body></md-tab><md-tab><md-tab-label><md-icon>link</md-icon></md-tab-label><md-tab-body><md-list class=relationships ng-if=\\\"main.related && main.related.length > 0\\\"><div ng-repeat=\\\"group in main.related\\\"><div ng-if=group.directed><div ng-if=\\\"group.out.nodes.length > 0\\\"><md-subheader class=md-no-sticky>{{group.out.label}}</md-subheader><md-list-item ng-repeat=\\\"node in group.out.nodes track by node.id\\\" ng-click=\\\"main.activeNode = node\\\">{{node.label}}</md-list-item></div><div ng-if=\\\"group.in.nodes.length > 0\\\"><md-subheader class=md-no-sticky>{{group.in.label}}</md-subheader><md-list-item ng-repeat=\\\"node in group.in.nodes track by node.id\\\" ng-click=\\\"main.activeNode = node\\\">{{node.label}}</md-list-item></div></div><div ng-if=!group.directed><div ng-if=\\\"group.none.nodes.length > 0\\\"><md-subheader class=md-no-sticky>{{group.none.label}}</md-subheader><md-list-item ng-repeat=\\\"node in group.none.nodes track by node.id\\\" ng-click=\\\"main.activeNode = node\\\">{{node.label}}</md-list-item></div></div></div></md-list></md-tab-body></md-tab></md-tabs></div></md-sidenav><md-toolbar><div class=md-toolbar-tools><img class=logo src=assets/images/sda-logo-light.png alt=SDA><h1>Concept Browser</h1><span flex></span></div></md-toolbar><div style=\\\"overflow: hidden\\\" flex layout=column><concept-browser flex ng-if=main.graph ng-model=main.graph active-node=main.activeNode></concept-browser><div ng-if=\\\"!main.graph && vm.graphLoading\\\" flex layout=column layout-align=\\\"center center\\\" layout-padding><md-progress-circular md-mode=indeterminate></md-progress-circular><div class=\\\"text-center md-headline md-secondary\\\">Loading graph data&hellip;<br>This may take a while.</div></div></div>\");\n$templateCache.put(\"app/trc-bio/event-editor.html\",\"<div class=form-group><label class=control-label for=event-title>Title</label><input type=text id=event-title name=event-title class=\\\"form-control event-title\\\" ng-model=event.title></div><div class=form-group><label class=control-label for=event-description>Description</label><textarea id=event-description name=event-description class=\\\"form-control event-description\\\" ng-model=event.description></textarea></div><div class=form-group><label class=control-label for=event-location>Location</label><input type=text id=event-location name=event-location class=\\\"form-control event-location\\\" ng-model=event.location></div><div class=form-group><label class=control-label for=event-date>Date</label><input type=text id=event-date name=event-date class=\\\"form-control event-date\\\" ng-model=event.date.description><!-- TODO add datepicker --></div>\");\n$templateCache.put(\"app/trc-bio/name-editor.html\",\"<div class=form-group class=name-role><label class=control-label for=name-role>Role</label><select id=name-role name=name-role class=\\\"form-control name-role\\\" ng-model=name.role><option ng-repeat=\\\"role in nameEditor.roles\\\" value={{role.value}}>{{role.label}}</option></select></div><div class=form-group class=name-structure><label class=control-label>Structured Name</label><input type=text class=name-title placeholder=title ng-model=name.title> <input type=text class=name-given placeholder=given ng-model=name.givenName> <input type=text class=name-middle placeholder=middle ng-model=name.middleName> <input type=text class=name-family placeholder=family ng-model=name.familyName> <input type=text class=name-suffix placeholder=suffix ng-model=name.suffix></div><div class=form-group class=name-label><label for=label>Display Label</label><input type=text placeholder=label ng-model=name.label></div>\");\n$templateCache.put(\"app/trc-bio/person-editor.html\",\"<div class=form-group><label for=person-name>Primary Name</label><trc-name-editor id=person-name ng-model=person.name></trc-name-editor></div><div class=form-group><label for=person-altnames>Alternate Names</label><div ng-repeat=\\\"name in person.altNames\\\"><trc-name-editor id=person-altnames ng-model=name></trc-name-editor><button ng-click=personEditor.removeName($index)>&minus;</button></div><button ng-click=personEditor.addName()>+</button></div><div class=form-group><label for=person-birth>Birth</label><div ng-if=person.birth><trc-event-editor id=person-birth ng-model=person.birth></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'birth\\')\\\">&minus;</button></div><div ng-if=!person.birth><button ng-click=\\\"personEditor.addEvent(\\'birth\\')\\\">+</button></div></div><div class=form-group><label for=person-death>Death</label><div ng-if=person.death><trc-event-editor id=person-death ng-model=person.death></trc-event-editor><button ng-click=\\\"personEditor.removeEvent(\\'death\\')\\\">&minus;</button></div><div ng-if=!person.death><button ng-click=\\\"personEditor.addEvent(\\'death\\')\\\">+</button></div></div><div class=form-group><label class=control-label for=person-summary>Summary</label><textarea id=person-summary name=person-summary class=\\\"form-control person-summary\\\" ng-model=person.summary></textarea></div>\");}]);"],"sourceRoot":"/source/"}